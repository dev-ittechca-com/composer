{"version":3,"file":"error_report.js","mappings":";;;;;;AAAA;;;;;;;;;;;;;ACAuB;AACkB;AACU;AACS;AACC;;AAE7D;AACA;AACA;AACA;AACA,IAAIK,WAAW,GAAG;EACd;AACJ;AACA;EACIC,aAAa,EAAE,IAAI;EACnB;AACJ;AACA;EACIC,eAAe,EAAE,IAAI;EACrB;AACJ;AACA;EACIC,OAAO,EAAE,CAAC,CAAC;EACX;AACJ;AACA;AACA;AACA;AACA;AACA;EACIC,gBAAgB,EAAE,UAAUC,IAAI,EAAEC,SAAS,EAAE;IACzC,IAAID,IAAI,CAACE,OAAO,KAAK,IAAI,EAAE;MACvBT,yEAAe,CAACO,IAAI,CAACG,KAAK,EAAE,KAAK,CAAC;MAClC;IACJ;IACA,IAAIH,IAAI,CAACI,cAAc,KAAK,KAAK,EAAE;MAC/BT,WAAW,CAACU,qBAAqB,EAAE;IACvC,CAAC,MAAM,IAAIL,IAAI,CAACI,cAAc,KAAK,QAAQ,EAAE;MACzC,IAAIE,UAAU,GAAGX,WAAW,CAACY,aAAa,CAACN,SAAS,CAAC;MACrD,IAAIO,QAAQ,GAAGlB,0CAAQ,CAACgB,UAAU,EAAE;QAChC,mBAAmB,EAAE,IAAI;QACzB,WAAW,EAAE;MACjB,CAAC,CAAC;MACFhB,wCAAM,CAAC,+BAA+B,EAAEkB,QAAQ,EAAE,UAAUR,IAAI,EAAE;QAC9D,IAAIA,IAAI,CAACE,OAAO,KAAK,KAAK,EAAE;UACxB;UACAT,yEAAe,CAACO,IAAI,CAACG,KAAK,EAAE,KAAK,CAAC;QACtC,CAAC,MAAM;UACHV,yEAAe,CAACO,IAAI,CAACW,OAAO,EAAE,KAAK,CAAC;QACxC;MACJ,CAAC,CAAC;IACN;EACJ,CAAC;EACDC,YAAY,EAAE,UAAUX,SAAS,EAAE;IAC/B;IACA,IAAIY,IAAI,CAACC,SAAS,CAACnB,WAAW,CAACC,aAAa,CAAC,KAAKiB,IAAI,CAACC,SAAS,CAACb,SAAS,CAAC,EAAE;MACzE;IACJ;IACA,IAAIA,SAAS,CAACc,IAAI,KAAK,IAAI,IAAI,OAAQd,SAAS,CAACc,IAAK,KAAK,WAAW,EAAE;MACpEd,SAAS,CAACc,IAAI,GAAGpB,WAAW,CAACqB,oBAAoB,CAACf,SAAS,CAAC;IAChE;IACAN,WAAW,CAACC,aAAa,GAAGK,SAAS;IACrC,IAAIN,WAAW,CAACE,eAAe,KAAK,IAAI,EAAE;MACtCP,wCAAM,CAAC,+BAA+B,EAAE;QACpC,cAAc,EAAE,IAAI;QACpB,QAAQ,EAAEE,gEAAgB,CAAC,QAAQ,CAAC;QACpC,cAAc,EAAE,IAAI;QACpB,gBAAgB,EAAE;MACtB,CAAC,EAAE,UAAUQ,IAAI,EAAE;QACfL,WAAW,CAACE,eAAe,GAAGG,IAAI;QAClCL,WAAW,CAACI,gBAAgB,CAACC,IAAI,EAAEC,SAAS,CAAC;MACjD,CAAC,CAAC;IACN,CAAC,MAAM;MACHN,WAAW,CAACI,gBAAgB,CAACJ,WAAW,CAACE,eAAe,EAAEI,SAAS,CAAC;IACxE;EACJ,CAAC;EACD;AACJ;AACA;AACA;AACA;AACA;AACA;EACIiB,gBAAgB,EAAE,UAAUjB,SAAS,EAAE;IACnC,MAAMK,UAAU,GAAGX,WAAW,CAACY,aAAa,CAACN,SAAS,CAAC;IAEvD,MAAMkB,eAAe,GAAG,YAAY;MAChC,MAAMX,QAAQ,GAAGlB,0CAAQ,CAACgB,UAAU,EAAE;QAClC,mBAAmB,EAAE,IAAI;QACzB,aAAa,EAAEhB,mCAAC,CAAC,yBAAyB,CAAC,CAAC8B,GAAG,EAAE;QACjD,aAAa,EAAE9B,mCAAC,CAAC,gCAAgC,CAAC,CAAC,CAAC,CAAC,CAAC+B;MAC1D,CAAC,CAAC;MACF/B,wCAAM,CAAC,+BAA+B,EAAEkB,QAAQ,EAAE,UAAUR,IAAI,EAAE;QAC9D,IAAIA,IAAI,CAACE,OAAO,KAAK,KAAK,EAAE;UACxBT,yEAAe,CAACO,IAAI,CAACG,KAAK,EAAE,KAAK,CAAC;QACtC,CAAC,MAAM;UACHV,yEAAe,CAACO,IAAI,CAACW,OAAO,EAAE,IAAI,CAAC;QACvC;MACJ,CAAC,CAAC;MACFrB,mCAAC,CAAC,mBAAmB,CAAC,CAACgC,KAAK,CAAC,MAAM,CAAC;IACxC,CAAC;IAEDhC,wCAAM,CAAC,+BAA+B,EAAEgB,UAAU,CAAC,CAACiB,IAAI,CAAC,UAAUvB,IAAI,EAAE;MACrE;MACA,IAAIwB,QAAQ,CAACC,cAAc,CAAC,kBAAkB,CAAC,KAAK,IAAI,EAAE;QACtDnC,mCAAC,CAAC,mBAAmB,CAAC,CAACoC,MAAM,EAAE;MACnC;MAEApC,mCAAC,CAAC,MAAM,CAAC,CAACqC,MAAM,CAACrC,mCAAC,CAACU,IAAI,CAAC4B,YAAY,CAAC,CAAC;MACtC,MAAMC,iBAAiB,GAAGvC,mCAAC,CAAC,mBAAmB,CAAC;MAChDuC,iBAAiB,CAACC,EAAE,CAAC,eAAe,EAAE,YAAY;QAC9C;QACAxC,mCAAC,CAAC,0BAA0B,CAAC,CAACyC,GAAG,CAAC,OAAO,EAAEZ,eAAe,CAAC;QAC3D7B,mCAAC,CAAC,0BAA0B,CAAC,CAACwC,EAAE,CAAC,OAAO,EAAEX,eAAe,CAAC;QAC1D7B,mCAAC,CAAC,+BAA+B,CAAC,CAAC0C,IAAI,CAAChC,IAAI,CAACW,OAAO,CAAC;MACzD,CAAC,CAAC;MACFkB,iBAAiB,CAACP,KAAK,CAAC,MAAM,CAAC;IACnC,CAAC,CAAC;EACN,CAAC;EACD;AACJ;AACA;AACA;AACA;EACIjB,qBAAqB,EAAE,YAAY;IAC/B,IAAI4B,GAAG,GAAGC,IAAI,CAACC,MAAM,EAAE,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,SAAS,CAAC,CAAC,EAAE,EAAE,CAAC;IACrD,OAAOJ,GAAG,IAAItC,WAAW,CAACG,OAAO,EAAE;MAC/BmC,GAAG,GAAGC,IAAI,CAACC,MAAM,EAAE,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,SAAS,CAAC,CAAC,EAAE,EAAE,CAAC;IACrD;IACA1C,WAAW,CAACG,OAAO,CAACmC,GAAG,CAAC,GAAG,CAAC;IAE5B,IAAIK,IAAI,GAAGhD,mCAAC,CACR,sEAAsE,GAAG2C,GAAG,GAAG,UAAU,CAC5F,CAACN,MAAM,CACJjC,6EAAW,CAAC,SAAS,CAAC,GAAG6C,MAAM,CAACC,QAAQ,CAACC,gBAAgB,CAC5D;IAED,IAAIC,QAAQ,GAAGpD,mCAAC,CAAC,+BAA+B,CAAC;IACjD,IAAIqD,UAAU,GAAG,wDAAwD,GAAGV,GAAG,GAAG,IAAI;IACtFU,UAAU,IAAIJ,MAAM,CAACC,QAAQ,CAACI,oBAAoB;IAClDD,UAAU,IAAI,WAAW;IAEzB,IAAIE,WAAW,GAAG,+CAA+C,GAAGrD,gEAAgB,CAAC,QAAQ,CAAC;IAC9FmD,UAAU,IAAI,wBAAwB,GAAGE,WAAW,GAAG,IAAI;IAC3DF,UAAU,IAAIjD,6EAAW,CAAC,OAAO,EAAE6C,MAAM,CAACC,QAAQ,CAACM,uBAAuB,CAAC;IAC3EH,UAAU,IAAI,MAAM;IAEpBA,UAAU,IAAI,+BAA+B,GAAGV,GAAG,GAAG,0BAA0B,GAAGA,GAAG,GAAG,IAAI;IAC7FU,UAAU,IAAIjD,6EAAW,CAAC,SAAS,EAAE6C,MAAM,CAACC,QAAQ,CAACO,SAAS,CAAC;IAC/DJ,UAAU,IAAI,MAAM;IAEpBD,QAAQ,CAACV,IAAI,CAACW,UAAU,CAAC;IAEzBL,IAAI,CAACX,MAAM,CAACe,QAAQ,CAAC;IACrB;IACAJ,IAAI,CAACU,QAAQ,CAACxB,QAAQ,CAACyB,IAAI,CAAC;IAC5B3D,mCAAC,CAACkC,QAAQ,CAAC,CAACM,EAAE,CAAC,OAAO,EAAE,qBAAqB,GAAGG,GAAG,EAAEtC,WAAW,CAACuD,kBAAkB,CAAC;IACpF5D,mCAAC,CAACkC,QAAQ,CAAC,CAACM,EAAE,CAAC,OAAO,EAAE,gBAAgB,GAAGG,GAAG,EAAEtC,WAAW,CAACwD,uBAAuB,CAAC;EACxF,CAAC;EACD;AACJ;AACA;AACA;AACA;AACA;EACIA,uBAAuB,EAAE,UAAUC,CAAC,EAAE;IAClC,IAAIA,CAAC,EAAE;MACH;MACAA,CAAC,CAACC,cAAc,EAAE;IACtB;IACA/D,mCAAC,CAAC,sBAAsB,GAAGA,mCAAC,CAAC,IAAI,CAAC,CAACU,IAAI,CAAC,iBAAiB,CAAC,CAAC,CAACsD,OAAO,CAAC,YAAY;MAC5EhE,mCAAC,CAAC,IAAI,CAAC,CAACoC,MAAM,EAAE;IACpB,CAAC,CAAC;EACN,CAAC;EACD;AACJ;AACA;AACA;AACA;AACA;EACIV,oBAAoB,EAAE,UAAUf,SAAS,EAAE;IACvC,IAAIA,SAAS,CAACU,OAAO,KAAK,IAAI,IAAI,OAAQV,SAAS,CAACU,OAAQ,KAAK,WAAW,EAAE;MAC1E,OAAO,EAAE;IACb;IAEA,IAAI4C,GAAG,GAAG,cAAc;IACxB,IAAIC,WAAW,GAAGD,GAAG,CAACE,IAAI,CAACxD,SAAS,CAACU,OAAO,CAAC;IAC7C,IAAI6C,WAAW,IAAIA,WAAW,CAACE,MAAM,KAAK,CAAC,EAAE;MACzC,OAAOF,WAAW,CAAC,CAAC,CAAC;IACzB;IAEA,OAAO,EAAE;EACb,CAAC;EACD;AACJ;AACA;AACA;AACA;EACIN,kBAAkB,EAAE,YAAY;IAC5BvD,WAAW,CAACwD,uBAAuB,EAAE;IACrCxD,WAAW,CAACuB,gBAAgB,CAACvB,WAAW,CAACC,aAAa,CAAC;EAC3D,CAAC;EACD;AACJ;AACA;AACA;AACA;AACA;AACA;EACIW,aAAa,EAAE,UAAUN,SAAS,EAAE;IAChC,IAAIA,SAAS,IAAIA,SAAS,CAAC0D,KAAK,IAAI1D,SAAS,CAAC0D,KAAK,CAACD,MAAM,EAAE;MACxD,KAAK,IAAIE,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG3D,SAAS,CAAC0D,KAAK,CAACD,MAAM,EAAEE,CAAC,EAAE,EAAE;QAC7C,IAAID,KAAK,GAAG1D,SAAS,CAAC0D,KAAK,CAACC,CAAC,CAAC;QAC9B,IAAID,KAAK,CAACE,OAAO,IAAIF,KAAK,CAACE,OAAO,CAACH,MAAM,EAAE;UACvC,KAAK,IAAII,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,KAAK,CAACE,OAAO,CAACH,MAAM,EAAEI,CAAC,EAAE,EAAE;YAC3C,IAAIH,KAAK,CAACE,OAAO,CAACC,CAAC,CAAC,CAACJ,MAAM,GAAG,EAAE,EAAE;cAC9BC,KAAK,CAACE,OAAO,CAACC,CAAC,CAAC,GAAGH,KAAK,CAACE,OAAO,CAACC,CAAC,CAAC,CAACzB,SAAS,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,GAAG,OAAO;YACnE;UACJ;QACJ;MACJ;IACJ;IACA,IAAI/B,UAAU,GAAG;MACb,QAAQ,EAAEd,gEAAgB,CAAC,QAAQ,CAAC;MACpC,cAAc,EAAE,IAAI;MACpB,WAAW,EAAES,SAAS;MACtB,KAAK,EAAEsC,MAAM,CAACwB,QAAQ,CAACC,IAAI;MAC3B,gBAAgB,EAAE;IACtB,CAAC;IACD,IAAIzE,+EAAiC,GAAG,CAAC,EAAE;MACvCe,UAAU,CAAC4D,OAAO,GAAG3E,4EAA8B,CAC/C,UAAU6E,MAAM,EAAE;QACd,OAAOA,MAAM;MACjB,CAAC,CACJ;IACL;IACA,OAAO9D,UAAU;EACrB,CAAC;EACD;AACJ;AACA;AACA;AACA;AACA;AACA;EACI+D,YAAY,EAAE,UAAUC,IAAI,EAAE;IAC1B,IAAI,CAAEA,IAAI,CAACC,OAAO,EAAE;MAChB,IAAIC,OAAO,GAAG,YAAY;QACtB,IAAI;UACA,OAAOF,IAAI,CAACG,KAAK,CAAC,IAAI,EAAEC,SAAS,CAAC;QACtC,CAAC,CAAC,OAAOC,CAAC,EAAE;UACRpC,MAAM,CAACqC,QAAQ,CAACC,MAAM,CAACF,CAAC,CAAC;QAC7B;MACJ,CAAC;MACDH,OAAO,CAACD,OAAO,GAAG,IAAI;MACtB;MACA;MACAC,OAAO,CAACM,IAAI,GAAGR,IAAI,CAACQ,IAAI,GAAGR,IAAI,CAACQ,IAAI,IAAIN,OAAO,CAACM,IAAI,IAAIxF,wCAAM,EAAE;MAChE,OAAOkF,OAAO;IAClB,CAAC,MAAM;MACH,OAAOF,IAAI;IACf;EACJ,CAAC;EACD;AACJ;AACA;AACA;AACA;EACIS,sBAAsB,EAAE,YAAY;IAChC,IAAIC,SAAS,GAAGzF,iEAAmB;IACnCA,iEAAmB,GAAG,UAAU2F,IAAI,EAAEZ,IAAI,EAAE;MACxC,IAAIa,eAAe,GAAGxF,WAAW,CAAC0E,YAAY,CAACC,IAAI,CAAC;MACpDU,SAAS,CAACI,IAAI,CAAC,IAAI,EAAEF,IAAI,EAAEC,eAAe,CAAC;IAC/C,CAAC;EACL,CAAC;EACD;AACJ;AACA;AACA;AACA;EACIE,oBAAoB,EAAE,YAAY;IAC9B,IAAIC,KAAK,GAAGhG,yCAAO;IACnBA,yCAAO,GAAG,YAAY;MAClB,KAAK,IAAIsE,CAAC,GAAG,CAAC,EAAEA,CAAC,IAAI,CAAC,EAAEA,CAAC,EAAE,EAAE;QACzB,IAAI,OAAQc,SAAS,CAACd,CAAC,CAAE,KAAK,UAAU,EAAE;UACtCc,SAAS,CAACd,CAAC,CAAC,GAAGjE,WAAW,CAAC0E,YAAY,CAACK,SAAS,CAACd,CAAC,CAAC,CAAC;UACrD;QACJ;MACJ;MACA,OAAO0B,KAAK,CAACb,KAAK,CAAC,IAAI,EAAEC,SAAS,CAAC;IACvC,CAAC;EACL,CAAC;EACD;AACJ;AACA;AACA;AACA;EACIc,mBAAmB,EAAE,YAAY;IAC7B7F,WAAW,CAACoF,sBAAsB,EAAE;IACpCpF,WAAW,CAAC0F,oBAAoB,EAAE;EACtC;AACJ,CAAC;AAED9F,iEAAmB,CAAC,iBAAiB,EAAE,YAAY;EAC/CgD,MAAM,CAACqC,QAAQ,CAACC,MAAM,CAACY,SAAS,CAAC9F,WAAW,CAACiB,YAAY,CAAC;EAC1DjB,WAAW,CAAC6F,mBAAmB,EAAE;AACrC,CAAC,CAAC","sources":["webpack://phpmyadmin/external var \"jQuery\"","webpack://phpmyadmin/./js/src/error_report.js"],"sourcesContent":["module.exports = jQuery;","import $ from 'jquery';\nimport { AJAX } from './modules/ajax.js';\nimport { CommonParams } from './modules/common.js';\nimport { ajaxShowMessage } from './modules/ajax-message.js';\nimport getImageTag from './modules/functions/getImageTag.js';\n\n/**\n * general function, usually for data manipulation pages\n *\n */\nvar ErrorReport = {\n    /**\n     * @var {object}, stores the last exception info\n     */\n    lastException: null,\n    /**\n     * @var object stores the Error Report Data to prevent unnecessary data fetching\n     */\n    errorReportData: null,\n    /**\n     * @var object maintains unique keys already used\n     */\n    keyDict: {},\n    /**\n     * handles thrown error exceptions based on user preferences\n     *\n     * @param {object} data\n     * @param {any} exception\n     * @return {void}\n     */\n    errorDataHandler: function (data, exception) {\n        if (data.success !== true) {\n            ajaxShowMessage(data.error, false);\n            return;\n        }\n        if (data.report_setting === 'ask') {\n            ErrorReport.showErrorNotification();\n        } else if (data.report_setting === 'always') {\n            var reportData = ErrorReport.getReportData(exception);\n            var postData = $.extend(reportData, {\n                'send_error_report': true,\n                'automatic': true\n            });\n            $.post('index.php?route=/error-report', postData, function (data) {\n                if (data.success === false) {\n                    // in the case of an error, show the error message returned.\n                    ajaxShowMessage(data.error, false);\n                } else {\n                    ajaxShowMessage(data.message, false);\n                }\n            });\n        }\n    },\n    errorHandler: function (exception) {\n        // issue: 14359\n        if (JSON.stringify(ErrorReport.lastException) === JSON.stringify(exception)) {\n            return;\n        }\n        if (exception.name === null || typeof (exception.name) === 'undefined') {\n            exception.name = ErrorReport.extractExceptionName(exception);\n        }\n        ErrorReport.lastException = exception;\n        if (ErrorReport.errorReportData === null) {\n            $.post('index.php?route=/error-report', {\n                'ajax_request': true,\n                'server': CommonParams.get('server'),\n                'get_settings': true,\n                'exception_type': 'js'\n            }, function (data) {\n                ErrorReport.errorReportData = data;\n                ErrorReport.errorDataHandler(data, exception);\n            });\n        } else {\n            ErrorReport.errorDataHandler(ErrorReport.errorReportData, exception);\n        }\n    },\n    /**\n     * Shows the modal dialog previewing the report\n     *\n     * @param exception object error report info\n     *\n     * @return {void}\n     */\n    showReportDialog: function (exception) {\n        const reportData = ErrorReport.getReportData(exception);\n\n        const sendErrorReport = function () {\n            const postData = $.extend(reportData, {\n                'send_error_report': true,\n                'description': $('#errorReportDescription').val(),\n                'always_send': $('#errorReportAlwaysSendCheckbox')[0].checked\n            });\n            $.post('index.php?route=/error-report', postData, function (data) {\n                if (data.success === false) {\n                    ajaxShowMessage(data.error, false);\n                } else {\n                    ajaxShowMessage(data.message, 3000);\n                }\n            });\n            $('#errorReportModal').modal('hide');\n        };\n\n        $.post('index.php?route=/error-report', reportData).done(function (data) {\n            // Delete the modal to refresh it in case the user changed SendErrorReports value\n            if (document.getElementById('errorReportModal') !== null) {\n                $('#errorReportModal').remove();\n            }\n\n            $('body').append($(data.report_modal));\n            const $errorReportModal = $('#errorReportModal');\n            $errorReportModal.on('show.bs.modal', function () {\n                // Prevents multiple onClick events\n                $('#errorReportModalConfirm').off('click', sendErrorReport);\n                $('#errorReportModalConfirm').on('click', sendErrorReport);\n                $('#errorReportModal .modal-body').html(data.message);\n            });\n            $errorReportModal.modal('show');\n        });\n    },\n    /**\n     * Shows the small notification that asks for user permission\n     *\n     * @return {void}\n     */\n    showErrorNotification: function () {\n        var key = Math.random().toString(36).substring(2, 12);\n        while (key in ErrorReport.keyDict) {\n            key = Math.random().toString(36).substring(2, 12);\n        }\n        ErrorReport.keyDict[key] = 1;\n\n        var $div = $(\n            '<div class=\"alert alert-danger\" role=\"alert\" id=\"error_notification_' + key + '\"></div>'\n        ).append(\n            getImageTag('s_error') + window.Messages.strErrorOccurred\n        );\n\n        var $buttons = $('<div class=\"float-end\"></div>');\n        var buttonHtml = '<button class=\"btn btn-primary\" id=\"show_error_report_' + key + '\">';\n        buttonHtml += window.Messages.strShowReportDetails;\n        buttonHtml += '</button>';\n\n        var settingsUrl = 'index.php?route=/preferences/features&server=' + CommonParams.get('server');\n        buttonHtml += '<a class=\"ajax\" href=\"' + settingsUrl + '\">';\n        buttonHtml += getImageTag('s_cog', window.Messages.strChangeReportSettings);\n        buttonHtml += '</a>';\n\n        buttonHtml += '<a href=\"#\" id=\"ignore_error_' + key + '\" data-notification-id=\"' + key + '\">';\n        buttonHtml += getImageTag('b_close', window.Messages.strIgnore);\n        buttonHtml += '</a>';\n\n        $buttons.html(buttonHtml);\n\n        $div.append($buttons);\n        // eslint-disable-next-line compat/compat\n        $div.appendTo(document.body);\n        $(document).on('click', '#show_error_report_' + key, ErrorReport.createReportDialog);\n        $(document).on('click', '#ignore_error_' + key, ErrorReport.removeErrorNotification);\n    },\n    /**\n     * Removes the notification if it was displayed before\n     *\n     * @param {Event} e\n     * @return {void}\n     */\n    removeErrorNotification: function (e) {\n        if (e) {\n            // don't remove the hash fragment by navigating to #\n            e.preventDefault();\n        }\n        $('#error_notification_' + $(this).data('notification-id')).fadeOut(function () {\n            $(this).remove();\n        });\n    },\n    /**\n     * Extracts Exception name from message if it exists\n     *\n     * @param exception\n     * @return {string}\n     */\n    extractExceptionName: function (exception) {\n        if (exception.message === null || typeof (exception.message) === 'undefined') {\n            return '';\n        }\n\n        var reg = /([a-zA-Z]+):/;\n        var regexResult = reg.exec(exception.message);\n        if (regexResult && regexResult.length === 2) {\n            return regexResult[1];\n        }\n\n        return '';\n    },\n    /**\n     * Shows the modal dialog previewing the report\n     *\n     * @return {void}\n     */\n    createReportDialog: function () {\n        ErrorReport.removeErrorNotification();\n        ErrorReport.showReportDialog(ErrorReport.lastException);\n    },\n    /**\n     * Returns the report data to send to the server\n     *\n     * @param exception object exception info\n     *\n     * @return {object}\n     */\n    getReportData: function (exception) {\n        if (exception && exception.stack && exception.stack.length) {\n            for (var i = 0; i < exception.stack.length; i++) {\n                var stack = exception.stack[i];\n                if (stack.context && stack.context.length) {\n                    for (var j = 0; j < stack.context.length; j++) {\n                        if (stack.context[j].length > 80) {\n                            stack.context[j] = stack.context[j].substring(-1, 75) + '//...';\n                        }\n                    }\n                }\n            }\n        }\n        var reportData = {\n            'server': CommonParams.get('server'),\n            'ajax_request': true,\n            'exception': exception,\n            'url': window.location.href,\n            'exception_type': 'js'\n        };\n        if (AJAX.scriptHandler.scripts.length > 0) {\n            reportData.scripts = AJAX.scriptHandler.scripts.map(\n                function (script) {\n                    return script;\n                }\n            );\n        }\n        return reportData;\n    },\n    /**\n     * Wraps given function in error reporting code and returns wrapped function\n     *\n     * @param {Function} func function to be wrapped\n     *\n     * @return {Function}\n     */\n    wrapFunction: function (func) {\n        if (! func.wrapped) {\n            var newFunc = function () {\n                try {\n                    return func.apply(this, arguments);\n                } catch (x) {\n                    window.TraceKit.report(x);\n                }\n            };\n            newFunc.wrapped = true;\n            // Set guid of wrapped function same as original function, so it can be removed\n            // See bug#4146 (problem with jquery draggable and sortable)\n            newFunc.guid = func.guid = func.guid || newFunc.guid || $.guid++;\n            return newFunc;\n        } else {\n            return func;\n        }\n    },\n    /**\n     * Automatically wraps the callback in AJAX.registerOnload\n     *\n     * @return {void}\n     */\n    wrapAjaxOnloadCallback: function () {\n        var oldOnload = AJAX.registerOnload;\n        AJAX.registerOnload = function (file, func) {\n            var wrappedFunction = ErrorReport.wrapFunction(func);\n            oldOnload.call(this, file, wrappedFunction);\n        };\n    },\n    /**\n     * Automatically wraps the callback in $.fn.on\n     *\n     * @return {void}\n     */\n    wrapJqueryOnCallback: function () {\n        var oldOn = $.fn.on;\n        $.fn.on = function () {\n            for (var i = 1; i <= 3; i++) {\n                if (typeof (arguments[i]) === 'function') {\n                    arguments[i] = ErrorReport.wrapFunction(arguments[i]);\n                    break;\n                }\n            }\n            return oldOn.apply(this, arguments);\n        };\n    },\n    /**\n     * Wraps the callback in AJAX.registerOnload automatically\n     *\n     * @return {void}\n     */\n    setUpErrorReporting: function () {\n        ErrorReport.wrapAjaxOnloadCallback();\n        ErrorReport.wrapJqueryOnCallback();\n    }\n};\n\nAJAX.registerOnload('error_report.js', function () {\n    window.TraceKit.report.subscribe(ErrorReport.errorHandler);\n    ErrorReport.setUpErrorReporting();\n});\n"],"names":["$","AJAX","CommonParams","ajaxShowMessage","getImageTag","ErrorReport","lastException","errorReportData","keyDict","errorDataHandler","data","exception","success","error","report_setting","showErrorNotification","reportData","getReportData","postData","extend","post","message","errorHandler","JSON","stringify","name","extractExceptionName","get","showReportDialog","sendErrorReport","val","checked","modal","done","document","getElementById","remove","append","report_modal","$errorReportModal","on","off","html","key","Math","random","toString","substring","$div","window","Messages","strErrorOccurred","$buttons","buttonHtml","strShowReportDetails","settingsUrl","strChangeReportSettings","strIgnore","appendTo","body","createReportDialog","removeErrorNotification","e","preventDefault","fadeOut","reg","regexResult","exec","length","stack","i","context","j","location","href","scriptHandler","scripts","map","script","wrapFunction","func","wrapped","newFunc","apply","arguments","x","TraceKit","report","guid","wrapAjaxOnloadCallback","oldOnload","registerOnload","file","wrappedFunction","call","wrapJqueryOnCallback","oldOn","fn","setUpErrorReporting","subscribe"],"sourceRoot":""}