{"version":3,"file":"error_report.js","mappings":";AACA;AAAsB;;AAEtB;AACA;AACA;AACA;AACA,IAAIA,WAAW,GAAG;AACd;AACJ;AACA;AACIC,EAAAA,aAAa,EAAE,IAJD;;AAKd;AACJ;AACA;AACIC,EAAAA,eAAe,EAAE,IARH;;AASd;AACJ;AACA;AACIC,EAAAA,OAAO,EAAE,EAZK;;AAad;AACJ;AACA;AACA;AACA;AACA;AACA;AACIC,EAAAA,gBAAgB,EAAE,UAAUC,IAAV,EAAgBC,SAAhB,EAA2B;AACzC,QAAID,IAAI,CAACE,OAAL,KAAiB,IAArB,EAA2B;AACvBC,MAAAA,SAAS,CAACC,eAAV,CAA0BJ,IAAI,CAACK,KAA/B,EAAsC,KAAtC;AACA;AACH;;AACD,QAAIL,IAAI,CAACM,cAAL,KAAwB,KAA5B,EAAmC;AAC/BX,MAAAA,WAAW,CAACY,qBAAZ;AACH,KAFD,MAEO,IAAIP,IAAI,CAACM,cAAL,KAAwB,QAA5B,EAAsC;AACzC,UAAIE,UAAU,GAAGb,WAAW,CAACc,aAAZ,CAA0BR,SAA1B,CAAjB;AACA,UAAIS,QAAQ,GAAGC,CAAC,CAACC,MAAF,CAASJ,UAAT,EAAqB;AAChC,6BAAqB,IADW;AAEhC,qBAAa;AAFmB,OAArB,CAAf;AAIAG,MAAAA,CAAC,CAACE,IAAF,CAAO,+BAAP,EAAwCH,QAAxC,EAAkD,UAAUV,IAAV,EAAgB;AAC9D,YAAIA,IAAI,CAACE,OAAL,KAAiB,KAArB,EAA4B;AACxB;AACAC,UAAAA,SAAS,CAACC,eAAV,CAA0BJ,IAAI,CAACK,KAA/B,EAAsC,KAAtC;AACH,SAHD,MAGO;AACHF,UAAAA,SAAS,CAACC,eAAV,CAA0BJ,IAAI,CAACc,OAA/B,EAAwC,KAAxC;AACH;AACJ,OAPD;AAQH;AACJ,GA1Ca;AA2CdC,EAAAA,YAAY,EAAE,UAAUd,SAAV,EAAqB;AAC/B;AACA,QAAIe,IAAI,CAACC,SAAL,CAAetB,WAAW,CAACC,aAA3B,MAA8CoB,IAAI,CAACC,SAAL,CAAehB,SAAf,CAAlD,EAA6E;AACzE;AACH;;AACD,QAAIA,SAAS,CAACiB,IAAV,KAAmB,IAAnB,IAA2B,OAAOjB,SAAS,CAACiB,IAAjB,KAA2B,WAA1D,EAAuE;AACnEjB,MAAAA,SAAS,CAACiB,IAAV,GAAiBvB,WAAW,CAACwB,oBAAZ,CAAiClB,SAAjC,CAAjB;AACH;;AACDN,IAAAA,WAAW,CAACC,aAAZ,GAA4BK,SAA5B;;AACA,QAAIN,WAAW,CAACE,eAAZ,KAAgC,IAApC,EAA0C;AACtCc,MAAAA,CAAC,CAACE,IAAF,CAAO,+BAAP,EAAwC;AACpC,wBAAgB,IADoB;AAEpC,kBAAUO,YAAY,CAACC,GAAb,CAAiB,QAAjB,CAF0B;AAGpC,wBAAgB,IAHoB;AAIpC,0BAAkB;AAJkB,OAAxC,EAKG,UAAUrB,IAAV,EAAgB;AACfL,QAAAA,WAAW,CAACE,eAAZ,GAA8BG,IAA9B;AACAL,QAAAA,WAAW,CAACI,gBAAZ,CAA6BC,IAA7B,EAAmCC,SAAnC;AACH,OARD;AASH,KAVD,MAUO;AACHN,MAAAA,WAAW,CAACI,gBAAZ,CAA6BJ,WAAW,CAACE,eAAzC,EAA0DI,SAA1D;AACH;AACJ,GAjEa;;AAkEd;AACJ;AACA;AACA;AACA;AACA;AACA;AACIqB,EAAAA,gBAAgB,EAAE,UAAUrB,SAAV,EAAqB;AACnC,UAAMO,UAAU,GAAGb,WAAW,CAACc,aAAZ,CAA0BR,SAA1B,CAAnB;;AAEA,UAAMsB,eAAe,GAAG,YAAY;AAChC,YAAMb,QAAQ,GAAGC,CAAC,CAACC,MAAF,CAASJ,UAAT,EAAqB;AAClC,6BAAqB,IADa;AAElC,uBAAeG,CAAC,CAAC,yBAAD,CAAD,CAA6Ba,GAA7B,EAFmB;AAGlC,uBAAeb,CAAC,CAAC,gCAAD,CAAD,CAAoC,CAApC,EAAuCc;AAHpB,OAArB,CAAjB;AAKAd,MAAAA,CAAC,CAACE,IAAF,CAAO,+BAAP,EAAwCH,QAAxC,EAAkD,UAAUV,IAAV,EAAgB;AAC9D,YAAIA,IAAI,CAACE,OAAL,KAAiB,KAArB,EAA4B;AACxBC,UAAAA,SAAS,CAACC,eAAV,CAA0BJ,IAAI,CAACK,KAA/B,EAAsC,KAAtC;AACH,SAFD,MAEO;AACHF,UAAAA,SAAS,CAACC,eAAV,CAA0BJ,IAAI,CAACc,OAA/B,EAAwC,IAAxC;AACH;AACJ,OAND;AAOAH,MAAAA,CAAC,CAAC,mBAAD,CAAD,CAAuBe,KAAvB,CAA6B,MAA7B;AACH,KAdD;;AAgBAf,IAAAA,CAAC,CAACE,IAAF,CAAO,+BAAP,EAAwCL,UAAxC,EAAoDmB,IAApD,CAAyD,UAAU3B,IAAV,EAAgB;AACrE;AACA,UAAI4B,QAAQ,CAACC,cAAT,CAAwB,kBAAxB,MAAgD,IAApD,EAA0D;AACtDlB,QAAAA,CAAC,CAAC,mBAAD,CAAD,CAAuBmB,MAAvB;AACH;;AAEDnB,MAAAA,CAAC,CAAC,MAAD,CAAD,CAAUoB,MAAV,CAAiBpB,CAAC,CAACX,IAAI,CAACgC,YAAN,CAAlB;AACA,YAAMC,iBAAiB,GAAGtB,CAAC,CAAC,mBAAD,CAA3B;AACAsB,MAAAA,iBAAiB,CAACC,EAAlB,CAAqB,eAArB,EAAsC,YAAY;AAC9C;AACAvB,QAAAA,CAAC,CAAC,0BAAD,CAAD,CAA8BwB,GAA9B,CAAkC,OAAlC,EAA2CZ,eAA3C;AACAZ,QAAAA,CAAC,CAAC,0BAAD,CAAD,CAA8BuB,EAA9B,CAAiC,OAAjC,EAA0CX,eAA1C;AACAZ,QAAAA,CAAC,CAAC,+BAAD,CAAD,CAAmCyB,IAAnC,CAAwCpC,IAAI,CAACc,OAA7C;AACH,OALD;AAMAmB,MAAAA,iBAAiB,CAACP,KAAlB,CAAwB,MAAxB;AACH,KAfD;AAgBH,GA5Ga;;AA6Gd;AACJ;AACA;AACA;AACA;AACInB,EAAAA,qBAAqB,EAAE,YAAY;AAC/B,QAAI8B,GAAG,GAAGC,IAAI,CAACC,MAAL,GAAcC,QAAd,CAAuB,EAAvB,EAA2BC,SAA3B,CAAqC,CAArC,EAAwC,EAAxC,CAAV;;AACA,WAAOJ,GAAG,IAAI1C,WAAW,CAACG,OAA1B,EAAmC;AAC/BuC,MAAAA,GAAG,GAAGC,IAAI,CAACC,MAAL,GAAcC,QAAd,CAAuB,EAAvB,EAA2BC,SAA3B,CAAqC,CAArC,EAAwC,EAAxC,CAAN;AACH;;AACD9C,IAAAA,WAAW,CAACG,OAAZ,CAAoBuC,GAApB,IAA2B,CAA3B;AAEA,QAAIK,IAAI,GAAG/B,CAAC,CACR,yEAAyE0B,GAAzE,GAA+E,UADvE,CAAD,CAETN,MAFS,CAGP5B,SAAS,CAACwC,QAAV,CAAmB,SAAnB,IAAgCC,QAAQ,CAACC,gBAHlC,CAAX;AAMA,QAAIC,QAAQ,GAAGnC,CAAC,CAAC,+BAAD,CAAhB;AACA,QAAIoC,UAAU,GAAI,2DAA2DV,GAA3D,GAAiE,IAAnF;AACAU,IAAAA,UAAU,IAAIH,QAAQ,CAACI,oBAAvB;AACAD,IAAAA,UAAU,IAAI,WAAd;AAEA,QAAIE,WAAW,GAAG,kDAAkD7B,YAAY,CAACC,GAAb,CAAiB,QAAjB,CAApE;AACA0B,IAAAA,UAAU,IAAI,2BAA2BE,WAA3B,GAAyC,IAAvD;AACAF,IAAAA,UAAU,IAAI5C,SAAS,CAACwC,QAAV,CAAmB,OAAnB,EAA4BC,QAAQ,CAACM,uBAArC,CAAd;AACAH,IAAAA,UAAU,IAAI,MAAd;AAEAA,IAAAA,UAAU,IAAI,kCAAkCV,GAAlC,GAAwC,0BAAxC,GAAqEA,GAArE,GAA2E,IAAzF;AACAU,IAAAA,UAAU,IAAI5C,SAAS,CAACwC,QAAV,CAAmB,SAAnB,EAA8BC,QAAQ,CAACO,SAAvC,CAAd;AACAJ,IAAAA,UAAU,IAAI,MAAd;AAEAD,IAAAA,QAAQ,CAACV,IAAT,CAAcW,UAAd;AAEAL,IAAAA,IAAI,CAACX,MAAL,CAAYe,QAAZ,EA7B+B,CA8B/B;;AACAJ,IAAAA,IAAI,CAACU,QAAL,CAAcxB,QAAQ,CAACyB,IAAvB;AACA1C,IAAAA,CAAC,CAACiB,QAAD,CAAD,CAAYM,EAAZ,CAAe,OAAf,EAAwB,wBAAwBG,GAAhD,EAAqD1C,WAAW,CAAC2D,kBAAjE;AACA3C,IAAAA,CAAC,CAACiB,QAAD,CAAD,CAAYM,EAAZ,CAAe,OAAf,EAAwB,mBAAmBG,GAA3C,EAAgD1C,WAAW,CAAC4D,uBAA5D;AACH,GApJa;;AAqJd;AACJ;AACA;AACA;AACA;AACA;AACIA,EAAAA,uBAAuB,EAAE,UAAUC,CAAV,EAAa;AAClC,QAAIA,CAAJ,EAAO;AACH;AACAA,MAAAA,CAAC,CAACC,cAAF;AACH;;AACD9C,IAAAA,CAAC,CAAC,yBAAyBA,CAAC,CAAC,IAAD,CAAD,CAAQX,IAAR,CAAa,iBAAb,CAA1B,CAAD,CAA4D0D,OAA5D,CAAoE,YAAY;AAC5E/C,MAAAA,CAAC,CAAC,IAAD,CAAD,CAAQmB,MAAR;AACH,KAFD;AAGH,GAnKa;;AAoKd;AACJ;AACA;AACA;AACA;AACA;AACIX,EAAAA,oBAAoB,EAAE,UAAUlB,SAAV,EAAqB;AACvC,QAAIA,SAAS,CAACa,OAAV,KAAsB,IAAtB,IAA8B,OAAOb,SAAS,CAACa,OAAjB,KAA8B,WAAhE,EAA6E;AACzE,aAAO,EAAP;AACH;;AAED,QAAI6C,GAAG,GAAG,cAAV;AACA,QAAIC,WAAW,GAAGD,GAAG,CAACE,IAAJ,CAAS5D,SAAS,CAACa,OAAnB,CAAlB;;AACA,QAAI8C,WAAW,IAAIA,WAAW,CAACE,MAAZ,KAAuB,CAA1C,EAA6C;AACzC,aAAOF,WAAW,CAAC,CAAD,CAAlB;AACH;;AAED,WAAO,EAAP;AACH,GAtLa;;AAuLd;AACJ;AACA;AACA;AACA;AACIN,EAAAA,kBAAkB,EAAE,YAAY;AAC5B3D,IAAAA,WAAW,CAAC4D,uBAAZ;AACA5D,IAAAA,WAAW,CAAC2B,gBAAZ,CAA6B3B,WAAW,CAACC,aAAzC;AACH,GA/La;;AAgMd;AACJ;AACA;AACA;AACA;AACA;AACA;AACIa,EAAAA,aAAa,EAAE,UAAUR,SAAV,EAAqB;AAChC,QAAIA,SAAS,IAAIA,SAAS,CAAC8D,KAAvB,IAAgC9D,SAAS,CAAC8D,KAAV,CAAgBD,MAApD,EAA4D;AACxD,WAAK,IAAIE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG/D,SAAS,CAAC8D,KAAV,CAAgBD,MAApC,EAA4CE,CAAC,EAA7C,EAAiD;AAC7C,YAAID,KAAK,GAAG9D,SAAS,CAAC8D,KAAV,CAAgBC,CAAhB,CAAZ;;AACA,YAAID,KAAK,CAACE,OAAN,IAAiBF,KAAK,CAACE,OAAN,CAAcH,MAAnC,EAA2C;AACvC,eAAK,IAAII,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,KAAK,CAACE,OAAN,CAAcH,MAAlC,EAA0CI,CAAC,EAA3C,EAA+C;AAC3C,gBAAIH,KAAK,CAACE,OAAN,CAAcC,CAAd,EAAiBJ,MAAjB,GAA2B,EAA/B,EAAmC;AAC/BC,cAAAA,KAAK,CAACE,OAAN,CAAcC,CAAd,IAAmBH,KAAK,CAACE,OAAN,CAAcC,CAAd,EAAiBzB,SAAjB,CAA2B,CAAC,CAA5B,EAA+B,EAA/B,IAAqC,OAAxD;AACH;AACJ;AACJ;AACJ;AACJ;;AACD,QAAIjC,UAAU,GAAG;AACb,gBAAUY,YAAY,CAACC,GAAb,CAAiB,QAAjB,CADG;AAEb,sBAAgB,IAFH;AAGb,mBAAapB,SAHA;AAIb,aAAOkE,MAAM,CAACC,QAAP,CAAgBC,IAJV;AAKb,wBAAkB;AALL,KAAjB;;AAOA,QAAIC,IAAI,CAACC,aAAL,CAAmBC,OAAnB,CAA2BV,MAA3B,GAAoC,CAAxC,EAA2C;AACvCtD,MAAAA,UAAU,CAACgE,OAAX,GAAqBF,IAAI,CAACC,aAAL,CAAmBC,OAAnB,CAA2BC,GAA3B,CACjB,UAAUC,MAAV,EAAkB;AACd,eAAOA,MAAP;AACH,OAHgB,CAArB;AAKH;;AACD,WAAOlE,UAAP;AACH,GAnOa;;AAoOd;AACJ;AACA;AACA;AACA;AACA;AACA;AACImE,EAAAA,YAAY,EAAE,UAAUC,IAAV,EAAgB;AAC1B,QAAI,CAACA,IAAI,CAACC,OAAV,EAAmB;AACf,UAAIC,OAAO,GAAG,YAAY;AACtB,YAAI;AACA,iBAAOF,IAAI,CAACG,KAAL,CAAW,IAAX,EAAiBC,SAAjB,CAAP;AACH,SAFD,CAEE,OAAOC,CAAP,EAAU;AACRC,UAAAA,QAAQ,CAACC,MAAT,CAAgBF,CAAhB;AACH;AACJ,OAND;;AAOAH,MAAAA,OAAO,CAACD,OAAR,GAAkB,IAAlB,CARe,CASf;AACA;;AACAC,MAAAA,OAAO,CAACM,IAAR,GAAeR,IAAI,CAACQ,IAAL,GAAYR,IAAI,CAACQ,IAAL,IAAaN,OAAO,CAACM,IAArB,IAA6BC,MAAM,CAACD,IAAP,EAAxD;AACA,aAAON,OAAP;AACH,KAbD,MAaO;AACH,aAAOF,IAAP;AACH;AACJ,GA5Pa;;AA6Pd;AACJ;AACA;AACA;AACA;AACIU,EAAAA,sBAAsB,EAAE,YAAY;AAChC,QAAIC,SAAS,GAAGjB,IAAI,CAACkB,cAArB;;AACAlB,IAAAA,IAAI,CAACkB,cAAL,GAAsB,UAAUC,IAAV,EAAgBb,IAAhB,EAAsB;AACxC,UAAIc,eAAe,GAAG/F,WAAW,CAACgF,YAAZ,CAAyBC,IAAzB,CAAtB;AACAW,MAAAA,SAAS,CAACI,IAAV,CAAe,IAAf,EAAqBF,IAArB,EAA2BC,eAA3B;AACH,KAHD;AAIH,GAxQa;;AAyQd;AACJ;AACA;AACA;AACA;AACIE,EAAAA,oBAAoB,EAAE,YAAY;AAC9B,QAAIC,KAAK,GAAGlF,CAAC,CAACmF,EAAF,CAAK5D,EAAjB;;AACAvB,IAAAA,CAAC,CAACmF,EAAF,CAAK5D,EAAL,GAAU,YAAY;AAClB,WAAK,IAAI8B,CAAC,GAAG,CAAb,EAAgBA,CAAC,IAAI,CAArB,EAAwBA,CAAC,EAAzB,EAA6B;AACzB,YAAI,OAAOgB,SAAS,CAAChB,CAAD,CAAhB,KAAyB,UAA7B,EAAyC;AACrCgB,UAAAA,SAAS,CAAChB,CAAD,CAAT,GAAerE,WAAW,CAACgF,YAAZ,CAAyBK,SAAS,CAAChB,CAAD,CAAlC,CAAf;AACA;AACH;AACJ;;AACD,aAAO6B,KAAK,CAACd,KAAN,CAAY,IAAZ,EAAkBC,SAAlB,CAAP;AACH,KARD;AASH,GAzRa;;AA0Rd;AACJ;AACA;AACA;AACA;AACIe,EAAAA,mBAAmB,EAAE,YAAY;AAC7BpG,IAAAA,WAAW,CAAC2F,sBAAZ;AACA3F,IAAAA,WAAW,CAACiG,oBAAZ;AACH;AAlSa,CAAlB;AAqSAtB,IAAI,CAACkB,cAAL,CAAoB,iBAApB,EAAuC,YAAY;AAC/CN,EAAAA,QAAQ,CAACC,MAAT,CAAgBa,SAAhB,CAA0BrG,WAAW,CAACoB,YAAtC;AACApB,EAAAA,WAAW,CAACoG,mBAAZ;AACH,CAHD,E","sources":["webpack://phpmyadmin/./js/src/error_report.js"],"sourcesContent":["\n/* global TraceKit */ // js/vendor/tracekit.js\n\n/**\n * general function, usually for data manipulation pages\n *\n */\nvar ErrorReport = {\n    /**\n     * @var {object}, stores the last exception info\n     */\n    lastException: null,\n    /**\n     * @var object stores the Error Report Data to prevent unnecessary data fetching\n     */\n    errorReportData: null,\n    /**\n     * @var object maintains unique keys already used\n     */\n    keyDict: {},\n    /**\n     * handles thrown error exceptions based on user preferences\n     *\n     * @param {object} data\n     * @param {any} exception\n     * @return {void}\n     */\n    errorDataHandler: function (data, exception) {\n        if (data.success !== true) {\n            Functions.ajaxShowMessage(data.error, false);\n            return;\n        }\n        if (data.report_setting === 'ask') {\n            ErrorReport.showErrorNotification();\n        } else if (data.report_setting === 'always') {\n            var reportData = ErrorReport.getReportData(exception);\n            var postData = $.extend(reportData, {\n                'send_error_report': true,\n                'automatic': true\n            });\n            $.post('index.php?route=/error-report', postData, function (data) {\n                if (data.success === false) {\n                    // in the case of an error, show the error message returned.\n                    Functions.ajaxShowMessage(data.error, false);\n                } else {\n                    Functions.ajaxShowMessage(data.message, false);\n                }\n            });\n        }\n    },\n    errorHandler: function (exception) {\n        // issue: 14359\n        if (JSON.stringify(ErrorReport.lastException) === JSON.stringify(exception)) {\n            return;\n        }\n        if (exception.name === null || typeof(exception.name) === 'undefined') {\n            exception.name = ErrorReport.extractExceptionName(exception);\n        }\n        ErrorReport.lastException = exception;\n        if (ErrorReport.errorReportData === null) {\n            $.post('index.php?route=/error-report', {\n                'ajax_request': true,\n                'server': CommonParams.get('server'),\n                'get_settings': true,\n                'exception_type': 'js'\n            }, function (data) {\n                ErrorReport.errorReportData = data;\n                ErrorReport.errorDataHandler(data, exception);\n            });\n        } else {\n            ErrorReport.errorDataHandler(ErrorReport.errorReportData, exception);\n        }\n    },\n    /**\n     * Shows the modal dialog previewing the report\n     *\n     * @param exception object error report info\n     *\n     * @return {void}\n     */\n    showReportDialog: function (exception) {\n        const reportData = ErrorReport.getReportData(exception);\n\n        const sendErrorReport = function () {\n            const postData = $.extend(reportData, {\n                'send_error_report': true,\n                'description': $('#errorReportDescription').val(),\n                'always_send': $('#errorReportAlwaysSendCheckbox')[0].checked\n            });\n            $.post('index.php?route=/error-report', postData, function (data) {\n                if (data.success === false) {\n                    Functions.ajaxShowMessage(data.error, false);\n                } else {\n                    Functions.ajaxShowMessage(data.message, 3000);\n                }\n            });\n            $('#errorReportModal').modal('hide');\n        };\n\n        $.post('index.php?route=/error-report', reportData).done(function (data) {\n            // Delete the modal to refresh it in case the user changed SendErrorReports value\n            if (document.getElementById('errorReportModal') !== null) {\n                $('#errorReportModal').remove();\n            }\n\n            $('body').append($(data.report_modal));\n            const $errorReportModal = $('#errorReportModal');\n            $errorReportModal.on('show.bs.modal', function () {\n                // Prevents multiple onClick events\n                $('#errorReportModalConfirm').off('click', sendErrorReport);\n                $('#errorReportModalConfirm').on('click', sendErrorReport);\n                $('#errorReportModal .modal-body').html(data.message);\n            });\n            $errorReportModal.modal('show');\n        });\n    },\n    /**\n     * Shows the small notification that asks for user permission\n     *\n     * @return {void}\n     */\n    showErrorNotification: function () {\n        var key = Math.random().toString(36).substring(2, 12);\n        while (key in ErrorReport.keyDict) {\n            key = Math.random().toString(36).substring(2, 12);\n        }\n        ErrorReport.keyDict[key] = 1;\n\n        var $div = $(\n            '<div class=\"alert alert-danger\" role=\"alert\" id=\"error_notification_' + key + '\"></div>'\n        ).append(\n            Functions.getImage('s_error') + Messages.strErrorOccurred\n        );\n\n        var $buttons = $('<div class=\"float-end\"></div>');\n        var buttonHtml  = '<button class=\"btn btn-primary\" id=\"show_error_report_' + key + '\">';\n        buttonHtml += Messages.strShowReportDetails;\n        buttonHtml += '</button>';\n\n        var settingsUrl = 'index.php?route=/preferences/features&server=' + CommonParams.get('server');\n        buttonHtml += '<a class=\"ajax\" href=\"' + settingsUrl + '\">';\n        buttonHtml += Functions.getImage('s_cog', Messages.strChangeReportSettings);\n        buttonHtml += '</a>';\n\n        buttonHtml += '<a href=\"#\" id=\"ignore_error_' + key + '\" data-notification-id=\"' + key + '\">';\n        buttonHtml += Functions.getImage('b_close', Messages.strIgnore);\n        buttonHtml += '</a>';\n\n        $buttons.html(buttonHtml);\n\n        $div.append($buttons);\n        // eslint-disable-next-line compat/compat\n        $div.appendTo(document.body);\n        $(document).on('click', '#show_error_report_' + key, ErrorReport.createReportDialog);\n        $(document).on('click', '#ignore_error_' + key, ErrorReport.removeErrorNotification);\n    },\n    /**\n     * Removes the notification if it was displayed before\n     *\n     * @param {Event} e\n     * @return {void}\n     */\n    removeErrorNotification: function (e) {\n        if (e) {\n            // don't remove the hash fragment by navigating to #\n            e.preventDefault();\n        }\n        $('#error_notification_' + $(this).data('notification-id')).fadeOut(function () {\n            $(this).remove();\n        });\n    },\n    /**\n     * Extracts Exception name from message if it exists\n     *\n     * @param exception\n     * @return {string}\n     */\n    extractExceptionName: function (exception) {\n        if (exception.message === null || typeof(exception.message) === 'undefined') {\n            return '';\n        }\n\n        var reg = /([a-zA-Z]+):/;\n        var regexResult = reg.exec(exception.message);\n        if (regexResult && regexResult.length === 2) {\n            return regexResult[1];\n        }\n\n        return '';\n    },\n    /**\n     * Shows the modal dialog previewing the report\n     *\n     * @return {void}\n     */\n    createReportDialog: function () {\n        ErrorReport.removeErrorNotification();\n        ErrorReport.showReportDialog(ErrorReport.lastException);\n    },\n    /**\n     * Returns the report data to send to the server\n     *\n     * @param exception object exception info\n     *\n     * @return {object}\n     */\n    getReportData: function (exception) {\n        if (exception && exception.stack && exception.stack.length) {\n            for (var i = 0; i < exception.stack.length; i++) {\n                var stack = exception.stack[i];\n                if (stack.context && stack.context.length) {\n                    for (var j = 0; j < stack.context.length; j++) {\n                        if (stack.context[j].length >  80) {\n                            stack.context[j] = stack.context[j].substring(-1, 75) + '//...';\n                        }\n                    }\n                }\n            }\n        }\n        var reportData = {\n            'server': CommonParams.get('server'),\n            'ajax_request': true,\n            'exception': exception,\n            'url': window.location.href,\n            'exception_type': 'js'\n        };\n        if (AJAX.scriptHandler.scripts.length > 0) {\n            reportData.scripts = AJAX.scriptHandler.scripts.map(\n                function (script) {\n                    return script;\n                }\n            );\n        }\n        return reportData;\n    },\n    /**\n     * Wraps given function in error reporting code and returns wrapped function\n     *\n     * @param {Function} func function to be wrapped\n     *\n     * @return {Function}\n     */\n    wrapFunction: function (func) {\n        if (!func.wrapped) {\n            var newFunc = function () {\n                try {\n                    return func.apply(this, arguments);\n                } catch (x) {\n                    TraceKit.report(x);\n                }\n            };\n            newFunc.wrapped = true;\n            // Set guid of wrapped function same as original function, so it can be removed\n            // See bug#4146 (problem with jquery draggable and sortable)\n            newFunc.guid = func.guid = func.guid || newFunc.guid || jQuery.guid++;\n            return newFunc;\n        } else {\n            return func;\n        }\n    },\n    /**\n     * Automatically wraps the callback in AJAX.registerOnload\n     *\n     * @return {void}\n     */\n    wrapAjaxOnloadCallback: function () {\n        var oldOnload = AJAX.registerOnload;\n        AJAX.registerOnload = function (file, func) {\n            var wrappedFunction = ErrorReport.wrapFunction(func);\n            oldOnload.call(this, file, wrappedFunction);\n        };\n    },\n    /**\n     * Automatically wraps the callback in $.fn.on\n     *\n     * @return {void}\n     */\n    wrapJqueryOnCallback: function () {\n        var oldOn = $.fn.on;\n        $.fn.on = function () {\n            for (var i = 1; i <= 3; i++) {\n                if (typeof(arguments[i]) === 'function') {\n                    arguments[i] = ErrorReport.wrapFunction(arguments[i]);\n                    break;\n                }\n            }\n            return oldOn.apply(this, arguments);\n        };\n    },\n    /**\n     * Wraps the callback in AJAX.registerOnload automatically\n     *\n     * @return {void}\n     */\n    setUpErrorReporting: function () {\n        ErrorReport.wrapAjaxOnloadCallback();\n        ErrorReport.wrapJqueryOnCallback();\n    }\n};\n\nAJAX.registerOnload('error_report.js', function () {\n    TraceKit.report.subscribe(ErrorReport.errorHandler);\n    ErrorReport.setUpErrorReporting();\n});\n"],"names":["ErrorReport","lastException","errorReportData","keyDict","errorDataHandler","data","exception","success","Functions","ajaxShowMessage","error","report_setting","showErrorNotification","reportData","getReportData","postData","$","extend","post","message","errorHandler","JSON","stringify","name","extractExceptionName","CommonParams","get","showReportDialog","sendErrorReport","val","checked","modal","done","document","getElementById","remove","append","report_modal","$errorReportModal","on","off","html","key","Math","random","toString","substring","$div","getImage","Messages","strErrorOccurred","$buttons","buttonHtml","strShowReportDetails","settingsUrl","strChangeReportSettings","strIgnore","appendTo","body","createReportDialog","removeErrorNotification","e","preventDefault","fadeOut","reg","regexResult","exec","length","stack","i","context","j","window","location","href","AJAX","scriptHandler","scripts","map","script","wrapFunction","func","wrapped","newFunc","apply","arguments","x","TraceKit","report","guid","jQuery","wrapAjaxOnloadCallback","oldOnload","registerOnload","file","wrappedFunction","call","wrapJqueryOnCallback","oldOn","fn","setUpErrorReporting","subscribe"],"sourceRoot":""}