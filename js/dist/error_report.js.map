{"version":3,"file":"error_report.js","mappings":"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","sources":["webpack://phpmyadmin/external var \"jQuery\"","webpack://phpmyadmin/./js/src/error_report.js"],"sourcesContent":["module.exports = jQuery;","import $ from 'jquery';\nimport { AJAX } from './modules/ajax.js';\nimport { CommonParams } from './modules/common.js';\nimport { ajaxShowMessage } from './modules/ajax-message.js';\nimport getImageTag from './modules/functions/getImageTag.js';\n\n/**\n * general function, usually for data manipulation pages\n *\n */\nvar ErrorReport = {\n    /**\n     * @var {object}, stores the last exception info\n     */\n    lastException: null,\n    /**\n     * @var object stores the Error Report Data to prevent unnecessary data fetching\n     */\n    errorReportData: null,\n    /**\n     * @var object maintains unique keys already used\n     */\n    keyDict: {},\n    /**\n     * handles thrown error exceptions based on user preferences\n     *\n     * @param {object} data\n     * @param {any} exception\n     * @return {void}\n     */\n    errorDataHandler: function (data, exception) {\n        if (data.success !== true) {\n            ajaxShowMessage(data.error, false);\n            return;\n        }\n        if (data.report_setting === 'ask') {\n            ErrorReport.showErrorNotification();\n        } else if (data.report_setting === 'always') {\n            var reportData = ErrorReport.getReportData(exception);\n            var postData = $.extend(reportData, {\n                'send_error_report': true,\n                'automatic': true\n            });\n            $.post('index.php?route=/error-report', postData, function (data) {\n                if (data.success === false) {\n                    // in the case of an error, show the error message returned.\n                    ajaxShowMessage(data.error, false);\n                } else {\n                    ajaxShowMessage(data.message, false);\n                }\n            });\n        }\n    },\n    errorHandler: function (exception) {\n        // issue: 14359\n        if (JSON.stringify(ErrorReport.lastException) === JSON.stringify(exception)) {\n            return;\n        }\n        if (exception.name === null || typeof (exception.name) === 'undefined') {\n            exception.name = ErrorReport.extractExceptionName(exception);\n        }\n        ErrorReport.lastException = exception;\n        if (ErrorReport.errorReportData === null) {\n            $.post('index.php?route=/error-report', {\n                'ajax_request': true,\n                'server': CommonParams.get('server'),\n                'get_settings': true,\n                'exception_type': 'js'\n            }, function (data) {\n                ErrorReport.errorReportData = data;\n                ErrorReport.errorDataHandler(data, exception);\n            });\n        } else {\n            ErrorReport.errorDataHandler(ErrorReport.errorReportData, exception);\n        }\n    },\n    /**\n     * Shows the modal dialog previewing the report\n     *\n     * @param exception object error report info\n     *\n     * @return {void}\n     */\n    showReportDialog: function (exception) {\n        const reportData = ErrorReport.getReportData(exception);\n\n        const sendErrorReport = function () {\n            const postData = $.extend(reportData, {\n                'send_error_report': true,\n                'description': $('#errorReportDescription').val(),\n                'always_send': $('#errorReportAlwaysSendCheckbox')[0].checked\n            });\n            $.post('index.php?route=/error-report', postData, function (data) {\n                if (data.success === false) {\n                    ajaxShowMessage(data.error, false);\n                } else {\n                    ajaxShowMessage(data.message, 3000);\n                }\n            });\n            $('#errorReportModal').modal('hide');\n        };\n\n        $.post('index.php?route=/error-report', reportData).done(function (data) {\n            // Delete the modal to refresh it in case the user changed SendErrorReports value\n            if (document.getElementById('errorReportModal') !== null) {\n                $('#errorReportModal').remove();\n            }\n\n            $('body').append($(data.report_modal));\n            const $errorReportModal = $('#errorReportModal');\n            $errorReportModal.on('show.bs.modal', function () {\n                // Prevents multiple onClick events\n                $('#errorReportModalConfirm').off('click', sendErrorReport);\n                $('#errorReportModalConfirm').on('click', sendErrorReport);\n                $('#errorReportModal .modal-body').html(data.message);\n            });\n            $errorReportModal.modal('show');\n        });\n    },\n    /**\n     * Shows the small notification that asks for user permission\n     *\n     * @return {void}\n     */\n    showErrorNotification: function () {\n        var key = Math.random().toString(36).substring(2, 12);\n        while (key in ErrorReport.keyDict) {\n            key = Math.random().toString(36).substring(2, 12);\n        }\n        ErrorReport.keyDict[key] = 1;\n\n        var $div = $(\n            '<div class=\"alert alert-danger\" role=\"alert\" id=\"error_notification_' + key + '\"></div>'\n        ).append(\n            getImageTag('s_error') + window.Messages.strErrorOccurred\n        );\n\n        var $buttons = $('<div class=\"float-end\"></div>');\n        var buttonHtml = '<button class=\"btn btn-primary\" id=\"show_error_report_' + key + '\">';\n        buttonHtml += window.Messages.strShowReportDetails;\n        buttonHtml += '</button>';\n\n        var settingsUrl = 'index.php?route=/preferences/features&server=' + CommonParams.get('server');\n        buttonHtml += '<a class=\"ajax\" href=\"' + settingsUrl + '\">';\n        buttonHtml += getImageTag('s_cog', window.Messages.strChangeReportSettings);\n        buttonHtml += '</a>';\n\n        buttonHtml += '<a href=\"#\" id=\"ignore_error_' + key + '\" data-notification-id=\"' + key + '\">';\n        buttonHtml += getImageTag('b_close', window.Messages.strIgnore);\n        buttonHtml += '</a>';\n\n        $buttons.html(buttonHtml);\n\n        $div.append($buttons);\n        // eslint-disable-next-line compat/compat\n        $div.appendTo(document.body);\n        $(document).on('click', '#show_error_report_' + key, ErrorReport.createReportDialog);\n        $(document).on('click', '#ignore_error_' + key, ErrorReport.removeErrorNotification);\n    },\n    /**\n     * Removes the notification if it was displayed before\n     *\n     * @param {Event} e\n     * @return {void}\n     */\n    removeErrorNotification: function (e) {\n        if (e) {\n            // don't remove the hash fragment by navigating to #\n            e.preventDefault();\n        }\n        $('#error_notification_' + $(this).data('notification-id')).fadeOut(function () {\n            $(this).remove();\n        });\n    },\n    /**\n     * Extracts Exception name from message if it exists\n     *\n     * @param exception\n     * @return {string}\n     */\n    extractExceptionName: function (exception) {\n        if (exception.message === null || typeof (exception.message) === 'undefined') {\n            return '';\n        }\n\n        var reg = /([a-zA-Z]+):/;\n        var regexResult = reg.exec(exception.message);\n        if (regexResult && regexResult.length === 2) {\n            return regexResult[1];\n        }\n\n        return '';\n    },\n    /**\n     * Shows the modal dialog previewing the report\n     *\n     * @return {void}\n     */\n    createReportDialog: function () {\n        ErrorReport.removeErrorNotification();\n        ErrorReport.showReportDialog(ErrorReport.lastException);\n    },\n    /**\n     * Returns the report data to send to the server\n     *\n     * @param exception object exception info\n     *\n     * @return {object}\n     */\n    getReportData: function (exception) {\n        if (exception && exception.stack && exception.stack.length) {\n            for (var i = 0; i < exception.stack.length; i++) {\n                var stack = exception.stack[i];\n                if (stack.context && stack.context.length) {\n                    for (var j = 0; j < stack.context.length; j++) {\n                        if (stack.context[j].length > 80) {\n                            stack.context[j] = stack.context[j].substring(-1, 75) + '//...';\n                        }\n                    }\n                }\n            }\n        }\n        var reportData = {\n            'server': CommonParams.get('server'),\n            'ajax_request': true,\n            'exception': exception,\n            'url': window.location.href,\n            'exception_type': 'js'\n        };\n        if (AJAX.scriptHandler.scripts.length > 0) {\n            reportData.scripts = AJAX.scriptHandler.scripts.map(\n                function (script) {\n                    return script;\n                }\n            );\n        }\n        return reportData;\n    },\n    /**\n     * Wraps given function in error reporting code and returns wrapped function\n     *\n     * @param {Function} func function to be wrapped\n     *\n     * @return {Function}\n     */\n    wrapFunction: function (func) {\n        if (! func.wrapped) {\n            var newFunc = function () {\n                try {\n                    return func.apply(this, arguments);\n                } catch (x) {\n                    window.TraceKit.report(x);\n                }\n            };\n            newFunc.wrapped = true;\n            // Set guid of wrapped function same as original function, so it can be removed\n            // See bug#4146 (problem with jquery draggable and sortable)\n            newFunc.guid = func.guid = func.guid || newFunc.guid || $.guid++;\n            return newFunc;\n        } else {\n            return func;\n        }\n    },\n    /**\n     * Automatically wraps the callback in AJAX.registerOnload\n     *\n     * @return {void}\n     */\n    wrapAjaxOnloadCallback: function () {\n        var oldOnload = AJAX.registerOnload;\n        AJAX.registerOnload = function (file, func) {\n            var wrappedFunction = ErrorReport.wrapFunction(func);\n            oldOnload.call(this, file, wrappedFunction);\n        };\n    },\n    /**\n     * Automatically wraps the callback in $.fn.on\n     *\n     * @return {void}\n     */\n    wrapJqueryOnCallback: function () {\n        var oldOn = $.fn.on;\n        $.fn.on = function () {\n            for (var i = 1; i <= 3; i++) {\n                if (typeof (arguments[i]) === 'function') {\n                    arguments[i] = ErrorReport.wrapFunction(arguments[i]);\n                    break;\n                }\n            }\n            return oldOn.apply(this, arguments);\n        };\n    },\n    /**\n     * Wraps the callback in AJAX.registerOnload automatically\n     *\n     * @return {void}\n     */\n    setUpErrorReporting: function () {\n        ErrorReport.wrapAjaxOnloadCallback();\n        ErrorReport.wrapJqueryOnCallback();\n    }\n};\n\nAJAX.registerOnload('error_report.js', function () {\n    window.TraceKit.report.subscribe(ErrorReport.errorHandler);\n    ErrorReport.setUpErrorReporting();\n});\n"],"names":["$","AJAX","CommonParams","ajaxShowMessage","getImageTag","ErrorReport","lastException","errorReportData","keyDict","errorDataHandler","data","exception","success","error","report_setting","showErrorNotification","reportData","getReportData","postData","extend","post","message","errorHandler","JSON","stringify","name","extractExceptionName","get","showReportDialog","sendErrorReport","val","checked","modal","done","document","getElementById","remove","append","report_modal","$errorReportModal","on","off","html","key","Math","random","toString","substring","$div","window","Messages","strErrorOccurred","$buttons","buttonHtml","strShowReportDetails","settingsUrl","strChangeReportSettings","strIgnore","appendTo","body","createReportDialog","removeErrorNotification","e","preventDefault","fadeOut","reg","regexResult","exec","length","stack","i","context","j","location","href","scriptHandler","scripts","map","script","wrapFunction","func","wrapped","newFunc","apply","arguments","x","TraceKit","report","guid","wrapAjaxOnloadCallback","oldOnload","registerOnload","file","wrappedFunction","call","wrapJqueryOnCallback","oldOn","fn","setUpErrorReporting","subscribe"],"sourceRoot":""}