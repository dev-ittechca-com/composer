{"version":3,"file":"table/gis_visualization.js","mappings":"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","sources":["webpack://phpmyadmin/external var \"jQuery\"","webpack://phpmyadmin/./js/src/table/gis_visualization.js"],"sourcesContent":["module.exports = jQuery;","import $ from 'jquery';\nimport { AJAX } from '../modules/ajax.js';\nimport { escapeHtml } from '../modules/functions/escape.js';\n\n/**\n * @fileoverview    functions used for visualizing GIS data\n *\n * @requires    jquery\n */\n\n/* global drawOpenLayers */ // templates/table/gis_visualization/gis_visualization.twig\n\n// Constants\nvar zoomFactor = 1.5;\nvar defaultX = 0;\nvar defaultY = 0;\nvar defaultScale = 1;\n\n// Variables\nvar x = defaultX;\nvar y = defaultY;\nvar scale = defaultScale;\n\n/** @type {SVGElement|undefined} */\nvar gisSvg;\n/** @type {ol.Map|undefined} */\nvar map;\n\n/**\n * Zooms and pans the visualization.\n */\nfunction zoomAndPan () {\n    var g = gisSvg.getElementById('groupPanel');\n    if (! g) {\n        return;\n    }\n\n    $('#groupPanel', gisSvg).attr('transform', 'translate(' + x + ', ' + y + ') scale(' + scale + ')');\n    $('circle.vector', gisSvg).attr('r', 3 / scale);\n    $('circle.vector', gisSvg).attr('stroke-width', 2 / scale);\n    $('polyline.vector', gisSvg).attr('stroke-width', 2 / scale);\n    $('path.vector', gisSvg).attr('stroke-width', 0.5 / scale);\n}\n\nwindow.zoomAndPan = zoomAndPan;\n\n/**\n * Initially loads either SVG or OSM visualization based on the choice.\n */\nfunction selectVisualization () {\n    if ($('#choice').prop('checked') !== true) {\n        $('#openlayersmap').hide();\n    } else {\n        $('#placeholder').hide();\n    }\n}\n\nwindow.selectVisualization = selectVisualization;\n\n/**\n * Adds necessary styles to the div that contains the openStreetMap.\n */\nfunction styleOSM () {\n    var $placeholder = $('#placeholder');\n    var cssObj = {\n        'border': '1px solid #aaa',\n        'width': $placeholder.width(),\n        'height': $placeholder.height(),\n        'float': 'right'\n    };\n    $('#openlayersmap').css(cssObj);\n}\n\nwindow.styleOSM = styleOSM;\n\n/**\n * Store a reference to the gis svg element.\n */\nfunction storeGisSvgRef () {\n    gisSvg = $('#placeholder').find('svg').get(0);\n}\n\nwindow.storeGisSvgRef = storeGisSvgRef;\n\n/**\n * Adds controls for zooming and panning.\n */\nfunction addZoomPanControllers () {\n    if (! gisSvg) {\n        return;\n    }\n    var themeImagePath = $('#themeImagePath').val();\n    $('#placeholder').append(\n        // pan arrows\n        '<img class=\"button\" id=\"left_arrow\" src=\"' + themeImagePath + 'west-mini.png\">',\n        '<img class=\"button\" id=\"right_arrow\" src=\"' + themeImagePath + 'east-mini.png\">',\n        '<img class=\"button\" id=\"up_arrow\" src=\"' + themeImagePath + 'north-mini.png\">',\n        '<img class=\"button\" id=\"down_arrow\" src=\"' + themeImagePath + 'south-mini.png\">',\n        // zoom controls\n        '<img class=\"button\" id=\"zoom_in\" src=\"' + themeImagePath + 'zoom-plus-mini.png\">',\n        '<img class=\"button\" id=\"zoom_world\" src=\"' + themeImagePath + 'zoom-world-mini.png\">',\n        '<img class=\"button\" id=\"zoom_out\" src=\"' + themeImagePath + 'zoom-minus-mini.png\">'\n    );\n}\n\nwindow.addZoomPanControllers = addZoomPanControllers;\n\n/**\n * Resizes the GIS visualization to fit into the space available.\n */\nfunction resizeGISVisualization () {\n    var $placeholder = $('#placeholder');\n    var oldWidth = $placeholder.width();\n    var visWidth = $('#div_view_options').width() - 48;\n\n    // Assign new value for width\n    $placeholder.width(visWidth);\n    $(gisSvg).attr('width', visWidth);\n\n    // Assign the offset created due to resizing to defaultX and center the svg.\n    defaultX = (visWidth - oldWidth) / 2;\n    x = defaultX;\n    y = defaultY;\n    scale = defaultScale;\n}\n\n/**\n * Initialize the GIS visualization.\n */\nfunction initGISVisualization () {\n    storeGisSvgRef();\n    // Loads either SVG or OSM visualization based on the choice\n    selectVisualization();\n    // Resizes the GIS visualization to fit into the space available\n    resizeGISVisualization();\n\n    if (typeof ol !== 'undefined') {\n        // Adds necessary styles to the div that contains the openStreetMap\n        styleOSM();\n    }\n    // Adds controllers for zooming and panning\n    addZoomPanControllers();\n    zoomAndPan();\n}\n\nfunction drawOpenLayerMap () {\n    $('#placeholder').hide();\n    $('#openlayersmap').show();\n    // Function doesn't work properly if #openlayersmap is hidden\n    if (typeof map !== 'object') {\n        // Draws openStreetMap with openLayers\n        map = drawOpenLayers();\n    }\n}\n\nfunction getRelativeCoords (e) {\n    var position = $('#placeholder').offset();\n    return {\n        x: e.pageX - position.left,\n        y: e.pageY - position.top\n    };\n}\n\n/**\n * @param {WheelEvent} event\n */\nfunction onGisMouseWheel (event) {\n    if (event.deltaY === 0) {\n        return;\n    }\n    event.preventDefault();\n\n    var relCoords = getRelativeCoords(event);\n    var factor = event.deltaY > 0 ? zoomFactor : 1 / zoomFactor;\n    // zoom\n    scale *= factor;\n    // zooming keeping the position under mouse pointer unmoved.\n    x = relCoords.x - (relCoords.x - x) * factor;\n    y = relCoords.y - (relCoords.y - y) * factor;\n    zoomAndPan();\n}\n\n/**\n * Ajax handlers for GIS visualization page\n *\n * Actions Ajaxified here:\n *\n * Zooming in and zooming out on mouse wheel movement.\n * Panning the visualization on dragging.\n * Zooming in on double clicking.\n * Zooming out on clicking the zoom out button.\n * Panning on clicking the arrow buttons.\n * Displaying tooltips for GIS objects.\n */\n\n/**\n * Unbind all event handlers before tearing down a page\n */\nAJAX.registerTeardown('table/gis_visualization.js', function () {\n    $(document).off('click', '#choice');\n    $(document).off('dragstart', 'svg');\n    $(document).off('mouseup', 'svg');\n    $(document).off('drag', 'svg');\n    $(document).off('dblclick', '#placeholder');\n    $(document).off('click', '#zoom_in');\n    $(document).off('click', '#zoom_world');\n    $(document).off('click', '#zoom_out');\n    $(document).off('click', '#left_arrow');\n    $(document).off('click', '#right_arrow');\n    $(document).off('click', '#up_arrow');\n    $(document).off('click', '#down_arrow');\n    $('.vector').off('mousemove').off('mouseout');\n    $('#placeholder').get(0).removeEventListener('wheel', onGisMouseWheel, { passive: false });\n    if (map) {\n        // Removes ol.Map's resize listener from window\n        map.setTarget(null);\n        map = undefined;\n    }\n});\n\nAJAX.registerOnload('table/gis_visualization.js', function () {\n    // If we are in GIS visualization, initialize it\n    if ($('#gis_div').length > 0) {\n        initGISVisualization();\n    }\n\n    if ($('#choice').prop('checked') === true) {\n        drawOpenLayerMap();\n    }\n\n    if (typeof ol === 'undefined') {\n        $('#choice, #labelChoice').hide();\n    }\n\n    $(document).on('click', '#choice', function () {\n        if ($(this).prop('checked') === false) {\n            $('#placeholder').show();\n            $('#openlayersmap').hide();\n        } else {\n            drawOpenLayerMap();\n        }\n    });\n\n    $('#placeholder').get(0).addEventListener('wheel', onGisMouseWheel, { passive: false });\n\n    var dragX = 0;\n    var dragY = 0;\n    $('svg').draggable({\n        helper: function () {\n            return $('<div>');// Give a fake element to be used for dragging display\n        }\n    });\n    $(document).on('dragstart', 'svg', function (event, dd) {\n        $('#placeholder').addClass('placeholderDrag');\n        dragX = Math.round(dd.offset.left);\n        dragY = Math.round(dd.offset.top);\n    });\n\n    $(document).on('mouseup', 'svg', function () {\n        $('#placeholder').removeClass('placeholderDrag');\n    });\n\n    $(document).on('drag', 'svg', function (event, dd) {\n        var newX = Math.round(dd.offset.left);\n        x += newX - dragX;\n        dragX = newX;\n        var newY = Math.round(dd.offset.top);\n        y += newY - dragY;\n        dragY = newY;\n        zoomAndPan();\n    });\n\n    $(document).on('dblclick', '#placeholder', function (event) {\n        if (event.target.classList.contains('button')) {\n            return;\n        }\n        scale *= zoomFactor;\n        // zooming in keeping the position under mouse pointer unmoved.\n        var relCoords = getRelativeCoords(event);\n        x = relCoords.x - (relCoords.x - x) * zoomFactor;\n        y = relCoords.y - (relCoords.y - y) * zoomFactor;\n        zoomAndPan();\n    });\n\n    $(document).on('click', '#zoom_in', function (e) {\n        e.preventDefault();\n        // zoom in\n        scale *= zoomFactor;\n\n        var width = $(gisSvg).attr('width');\n        var height = $(gisSvg).attr('height');\n        // zooming in keeping the center unmoved.\n        x = width / 2 - (width / 2 - x) * zoomFactor;\n        y = height / 2 - (height / 2 - y) * zoomFactor;\n        zoomAndPan();\n    });\n\n    $(document).on('click', '#zoom_world', function (e) {\n        e.preventDefault();\n        scale = 1;\n        x = defaultX;\n        y = defaultY;\n        zoomAndPan();\n    });\n\n    $(document).on('click', '#zoom_out', function (e) {\n        e.preventDefault();\n        // zoom out\n        scale /= zoomFactor;\n\n        var width = $(gisSvg).attr('width');\n        var height = $(gisSvg).attr('height');\n        // zooming out keeping the center unmoved.\n        x = width / 2 - (width / 2 - x) / zoomFactor;\n        y = height / 2 - (height / 2 - y) / zoomFactor;\n        zoomAndPan();\n    });\n\n    $(document).on('click', '#left_arrow', function (e) {\n        e.preventDefault();\n        x += 100;\n        zoomAndPan();\n    });\n\n    $(document).on('click', '#right_arrow', function (e) {\n        e.preventDefault();\n        x -= 100;\n        zoomAndPan();\n    });\n\n    $(document).on('click', '#up_arrow', function (e) {\n        e.preventDefault();\n        y += 100;\n        zoomAndPan();\n    });\n\n    $(document).on('click', '#down_arrow', function (e) {\n        e.preventDefault();\n        y -= 100;\n        zoomAndPan();\n    });\n\n    /**\n     * Detect the mousemove event and show tooltips.\n     */\n    $('.vector').on('mousemove', function (event) {\n        var contents = escapeHtml($(this).attr('name')).trim();\n        $('#tooltip').remove();\n        if (contents !== '') {\n            $('<div id=\"tooltip\">' + contents + '</div>').css({\n                position: 'absolute',\n                top: event.pageY + 10,\n                left: event.pageX + 10,\n                border: '1px solid #fdd',\n                padding: '2px',\n                'background-color': '#fee',\n                opacity: 0.90\n            }).appendTo('body').fadeIn(200);\n        }\n    });\n\n    /**\n     * Detect the mouseout event and hide tooltips.\n     */\n    $('.vector').on('mouseout', function () {\n        $('#tooltip').remove();\n    });\n});\n"],"names":["$","AJAX","escapeHtml","zoomFactor","defaultX","defaultY","defaultScale","x","y","scale","gisSvg","map","zoomAndPan","g","getElementById","attr","window","selectVisualization","prop","hide","styleOSM","$placeholder","cssObj","width","height","css","storeGisSvgRef","find","get","addZoomPanControllers","themeImagePath","val","append","resizeGISVisualization","oldWidth","visWidth","initGISVisualization","ol","drawOpenLayerMap","show","drawOpenLayers","getRelativeCoords","e","position","offset","pageX","left","pageY","top","onGisMouseWheel","event","deltaY","preventDefault","relCoords","factor","registerTeardown","document","off","removeEventListener","passive","setTarget","undefined","registerOnload","length","on","addEventListener","dragX","dragY","draggable","helper","dd","addClass","Math","round","removeClass","newX","newY","target","classList","contains","contents","trim","remove","border","padding","opacity","appendTo","fadeIn"],"sourceRoot":""}