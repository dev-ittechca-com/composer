{"version":3,"file":"table/gis_visualization.js","mappings":"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","sources":["webpack://phpmyadmin/external var \"jQuery\"","webpack://phpmyadmin/./js/src/table/gis_visualization.js"],"sourcesContent":["module.exports = jQuery;","import $ from 'jquery';\nimport { AJAX } from '../modules/ajax.js';\nimport { escapeHtml } from '../modules/functions/escape.js';\n\n/**\n * @fileoverview    functions used for visualizing GIS data\n *\n * @requires    jquery\n */\n\n/* global drawOpenLayers */ // templates/table/gis_visualization/gis_visualization.twig\n\n// Constants\nvar zoomFactor = 1.5;\nvar defaultX = 0;\nvar defaultY = 0;\nvar defaultScale = 1;\n\n// Variables\nvar x = defaultX;\nvar y = defaultY;\nvar scale = defaultScale;\n\n/** @type {SVGElement|undefined} */\nvar gisSvg;\n/** @type {ol.Map|undefined} */\nvar map;\n\n/**\n * Zooms and pans the visualization.\n */\nfunction zoomAndPan () {\n    var g = gisSvg.getElementById('groupPanel');\n    if (! g) {\n        return;\n    }\n\n    $('#groupPanel', gisSvg).attr('transform', 'translate(' + x + ', ' + y + ') scale(' + scale + ')');\n    $('circle.vector', gisSvg).attr('r', 3 / scale);\n    $('circle.vector', gisSvg).attr('stroke-width', 2 / scale);\n    $('polyline.vector', gisSvg).attr('stroke-width', 2 / scale);\n    $('path.vector', gisSvg).attr('stroke-width', 0.5 / scale);\n}\n\nwindow.zoomAndPan = zoomAndPan;\n\n/**\n * Initially loads either SVG or OSM visualization based on the choice.\n */\nfunction selectVisualization () {\n    if ($('#choice').prop('checked') !== true) {\n        $('#openlayersmap').hide();\n    } else {\n        $('#placeholder').hide();\n    }\n}\n\nwindow.selectVisualization = selectVisualization;\n\n/**\n * Adds necessary styles to the div that contains the openStreetMap.\n */\nfunction styleOSM () {\n    var $placeholder = $('#placeholder');\n    var cssObj = {\n        'border': '1px solid #aaa',\n        'width': $placeholder.width(),\n        'height': $placeholder.height(),\n        'float': 'right'\n    };\n    $('#openlayersmap').css(cssObj);\n}\n\nwindow.styleOSM = styleOSM;\n\n/**\n * Store a reference to the gis svg element.\n */\nfunction storeGisSvgRef () {\n    gisSvg = $('#placeholder').find('svg').get(0);\n}\n\nwindow.storeGisSvgRef = storeGisSvgRef;\n\n/**\n * Adds controls for zooming and panning.\n */\nfunction addZoomPanControllers () {\n    if (! gisSvg) {\n        return;\n    }\n    var themeImagePath = $('#themeImagePath').val();\n    $('#placeholder').append(\n        // pan arrows\n        '<img class=\"button\" id=\"left_arrow\" src=\"' + themeImagePath + 'west-mini.png\">',\n        '<img class=\"button\" id=\"right_arrow\" src=\"' + themeImagePath + 'east-mini.png\">',\n        '<img class=\"button\" id=\"up_arrow\" src=\"' + themeImagePath + 'north-mini.png\">',\n        '<img class=\"button\" id=\"down_arrow\" src=\"' + themeImagePath + 'south-mini.png\">',\n        // zoom controls\n        '<img class=\"button\" id=\"zoom_in\" src=\"' + themeImagePath + 'zoom-plus-mini.png\">',\n        '<img class=\"button\" id=\"zoom_world\" src=\"' + themeImagePath + 'zoom-world-mini.png\">',\n        '<img class=\"button\" id=\"zoom_out\" src=\"' + themeImagePath + 'zoom-minus-mini.png\">'\n    );\n}\n\nwindow.addZoomPanControllers = addZoomPanControllers;\n\n/**\n * Resizes the GIS visualization to fit into the space available.\n */\nfunction resizeGISVisualization () {\n    var $placeholder = $('#placeholder');\n    var oldWidth = $placeholder.width();\n    var visWidth = $('#div_view_options').width() - 48;\n\n    // Assign new value for width\n    $placeholder.width(visWidth);\n    $(gisSvg).attr('width', visWidth);\n\n    // Assign the offset created due to resizing to defaultX and center the svg.\n    defaultX = (visWidth - oldWidth) / 2;\n    x = defaultX;\n    y = defaultY;\n    scale = defaultScale;\n}\n\n/**\n * Initialize the GIS visualization.\n */\nfunction initGISVisualization () {\n    storeGisSvgRef();\n    // Loads either SVG or OSM visualization based on the choice\n    selectVisualization();\n    // Resizes the GIS visualization to fit into the space available\n    resizeGISVisualization();\n\n    if (typeof ol !== 'undefined') {\n        // Adds necessary styles to the div that contains the openStreetMap\n        styleOSM();\n    }\n    // Adds controllers for zooming and panning\n    addZoomPanControllers();\n    zoomAndPan();\n}\n\nfunction drawOpenLayerMap () {\n    $('#placeholder').hide();\n    $('#openlayersmap').show();\n    // Function doesn't work properly if #openlayersmap is hidden\n    if (typeof map !== 'object') {\n        // Draws openStreetMap with openLayers\n        map = drawOpenLayers();\n    }\n}\n\nfunction getRelativeCoords (e) {\n    var position = $('#placeholder').offset();\n    return {\n        x: e.pageX - position.left,\n        y: e.pageY - position.top\n    };\n}\n\n/**\n * @param {WheelEvent} event\n */\nfunction onGisMouseWheel (event) {\n    if (event.deltaY === 0) {\n        return;\n    }\n    event.preventDefault();\n\n    var relCoords = getRelativeCoords(event);\n    var factor = event.deltaY > 0 ? zoomFactor : 1 / zoomFactor;\n    // zoom\n    scale *= factor;\n    // zooming keeping the position under mouse pointer unmoved.\n    x = relCoords.x - (relCoords.x - x) * factor;\n    y = relCoords.y - (relCoords.y - y) * factor;\n    zoomAndPan();\n}\n\n/**\n * Ajax handlers for GIS visualization page\n *\n * Actions Ajaxified here:\n *\n * Zooming in and zooming out on mouse wheel movement.\n * Panning the visualization on dragging.\n * Zooming in on double clicking.\n * Zooming out on clicking the zoom out button.\n * Panning on clicking the arrow buttons.\n * Displaying tooltips for GIS objects.\n */\n\n/**\n * Unbind all event handlers before tearing down a page\n */\nAJAX.registerTeardown('table/gis_visualization.js', function () {\n    $(document).off('click', '#choice');\n    $(document).off('dragstart', 'svg');\n    $(document).off('mouseup', 'svg');\n    $(document).off('drag', 'svg');\n    $(document).off('dblclick', '#placeholder');\n    $(document).off('click', '#zoom_in');\n    $(document).off('click', '#zoom_world');\n    $(document).off('click', '#zoom_out');\n    $(document).off('click', '#left_arrow');\n    $(document).off('click', '#right_arrow');\n    $(document).off('click', '#up_arrow');\n    $(document).off('click', '#down_arrow');\n    $('.vector').off('mousemove').off('mouseout');\n    $('#placeholder').get(0).removeEventListener('wheel', onGisMouseWheel, { passive: false });\n    if (map) {\n        // Removes ol.Map's resize listener from window\n        map.setTarget(null);\n        map = undefined;\n    }\n});\n\nAJAX.registerOnload('table/gis_visualization.js', function () {\n    // If we are in GIS visualization, initialize it\n    if ($('#gis_div').length > 0) {\n        initGISVisualization();\n    }\n\n    if ($('#choice').prop('checked') === true) {\n        drawOpenLayerMap();\n    }\n\n    if (typeof ol === 'undefined') {\n        $('#choice, #labelChoice').hide();\n    }\n\n    $(document).on('click', '#choice', function () {\n        if ($(this).prop('checked') === false) {\n            $('#placeholder').show();\n            $('#openlayersmap').hide();\n        } else {\n            drawOpenLayerMap();\n        }\n    });\n\n    $('#placeholder').get(0).addEventListener('wheel', onGisMouseWheel, { passive: false });\n\n    var dragX = 0;\n    var dragY = 0;\n    $('svg').draggable({\n        helper: function () {\n            return $('<div>');// Give a fake element to be used for dragging display\n        }\n    });\n    $(document).on('dragstart', 'svg', function (event, dd) {\n        $('#placeholder').addClass('placeholderDrag');\n        dragX = Math.round(dd.offset.left);\n        dragY = Math.round(dd.offset.top);\n    });\n\n    $(document).on('mouseup', 'svg', function () {\n        $('#placeholder').removeClass('placeholderDrag');\n    });\n\n    $(document).on('drag', 'svg', function (event, dd) {\n        var newX = Math.round(dd.offset.left);\n        x += newX - dragX;\n        dragX = newX;\n        var newY = Math.round(dd.offset.top);\n        y += newY - dragY;\n        dragY = newY;\n        zoomAndPan();\n    });\n\n    $(document).on('dblclick', '#placeholder', function (event) {\n        if (event.target.classList.contains('button')) {\n            return;\n        }\n        scale *= zoomFactor;\n        // zooming in keeping the position under mouse pointer unmoved.\n        var relCoords = getRelativeCoords(event);\n        x = relCoords.x - (relCoords.x - x) * zoomFactor;\n        y = relCoords.y - (relCoords.y - y) * zoomFactor;\n        zoomAndPan();\n    });\n\n    $(document).on('click', '#zoom_in', function (e) {\n        e.preventDefault();\n        // zoom in\n        scale *= zoomFactor;\n\n        var width = $(gisSvg).attr('width');\n        var height = $(gisSvg).attr('height');\n        // zooming in keeping the center unmoved.\n        x = width / 2 - (width / 2 - x) * zoomFactor;\n        y = height / 2 - (height / 2 - y) * zoomFactor;\n        zoomAndPan();\n    });\n\n    $(document).on('click', '#zoom_world', function (e) {\n        e.preventDefault();\n        scale = 1;\n        x = defaultX;\n        y = defaultY;\n        zoomAndPan();\n    });\n\n    $(document).on('click', '#zoom_out', function (e) {\n        e.preventDefault();\n        // zoom out\n        scale /= zoomFactor;\n\n        var width = $(gisSvg).attr('width');\n        var height = $(gisSvg).attr('height');\n        // zooming out keeping the center unmoved.\n        x = width / 2 - (width / 2 - x) / zoomFactor;\n        y = height / 2 - (height / 2 - y) / zoomFactor;\n        zoomAndPan();\n    });\n\n    $(document).on('click', '#left_arrow', function (e) {\n        e.preventDefault();\n        x += 100;\n        zoomAndPan();\n    });\n\n    $(document).on('click', '#right_arrow', function (e) {\n        e.preventDefault();\n        x -= 100;\n        zoomAndPan();\n    });\n\n    $(document).on('click', '#up_arrow', function (e) {\n        e.preventDefault();\n        y += 100;\n        zoomAndPan();\n    });\n\n    $(document).on('click', '#down_arrow', function (e) {\n        e.preventDefault();\n        y -= 100;\n        zoomAndPan();\n    });\n\n    /**\n     * Detect the mousemove event and show tooltips.\n     */\n    $('.vector').on('mousemove', function (event) {\n        var contents = escapeHtml($(this).attr('name')).trim();\n        $('#tooltip').remove();\n        if (contents !== '') {\n            $('<div id=\"tooltip\">' + contents + '</div>').css({\n                position: 'absolute',\n                top: event.pageY + 10,\n                left: event.pageX + 10,\n                border: '1px solid #fdd',\n                padding: '2px',\n                'background-color': '#fee',\n                opacity: 0.90\n            }).appendTo('body').fadeIn(200);\n        }\n    });\n\n    /**\n     * Detect the mouseout event and hide tooltips.\n     */\n    $('.vector').on('mouseout', function () {\n        $('#tooltip').remove();\n    });\n});\n"],"names":["$","AJAX","escapeHtml","zoomFactor","defaultX","defaultY","defaultScale","x","y","scale","gisSvg","map","zoomAndPan","g","getElementById","attr","window","selectVisualization","prop","hide","styleOSM","$placeholder","cssObj","width","height","css","storeGisSvgRef","find","get","addZoomPanControllers","themeImagePath","val","append","resizeGISVisualization","oldWidth","visWidth","initGISVisualization","ol","drawOpenLayerMap","show","drawOpenLayers","getRelativeCoords","e","position","offset","pageX","left","pageY","top","onGisMouseWheel","event","deltaY","preventDefault","relCoords","factor","registerTeardown","document","off","removeEventListener","passive","setTarget","undefined","registerOnload","length","on","addEventListener","dragX","dragY","draggable","helper","dd","addClass","Math","round","removeClass","newX","newY","target","classList","contains","contents","trim","remove","border","padding","opacity","appendTo","fadeIn"],"sourceRoot":""}