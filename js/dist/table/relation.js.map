{"version":3,"file":"table/relation.js","mappings":"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","sources":["webpack://phpmyadmin/./js/src/table/relation.js"],"sourcesContent":["/**\n * for table relation\n */\n\nvar TableRelation = {};\n\nTableRelation.showHideClauses = function ($thisDropdown) {\n    if ($thisDropdown.val() === '') {\n        $thisDropdown.parent().nextAll('span').hide();\n    } else {\n        if ($thisDropdown.is('select[name^=\"destination_foreign_column\"]')) {\n            $thisDropdown.parent().nextAll('span').show();\n        }\n    }\n};\n\n/**\n * Sets dropdown options to values\n * @param $dropdown\n * @param values\n * @param selectedValue\n * @return {void}\n */\nTableRelation.setDropdownValues = function ($dropdown, values, selectedValue) {\n    $dropdown.empty();\n    var optionsAsString = '';\n    // add an empty string to the beginning for empty selection\n    values.unshift('');\n    $.each(values, function () {\n        optionsAsString += '<option value=\\'' + Functions.escapeHtml(this) + '\\'' + (selectedValue === Functions.escapeHtml(this) ? ' selected=\\'selected\\'' : '') + '>' + Functions.escapeHtml(this) + '</option>';\n    });\n    $dropdown.append($(optionsAsString));\n};\n\n/**\n * Retrieves and populates dropdowns to the left based on the selected value\n *\n * @param $dropdown the dropdown whose value got changed\n * @return {void}\n */\nTableRelation.getDropdownValues = function ($dropdown) {\n    var foreignDb = null;\n    var foreignTable = null;\n    var $databaseDd;\n    var $tableDd;\n    var $columnDd;\n    var foreign = '';\n    // if the changed dropdown is for foreign key constraints\n    if ($dropdown.is('select[name^=\"destination_foreign\"]')) {\n        $databaseDd = $dropdown.parent().parent().parent().find('select[name^=\"destination_foreign_db\"]');\n        $tableDd    = $dropdown.parent().parent().parent().find('select[name^=\"destination_foreign_table\"]');\n        $columnDd   = $dropdown.parent().parent().parent().find('select[name^=\"destination_foreign_column\"]');\n        foreign = '_foreign';\n    } else { // internal relations\n        $databaseDd = $dropdown.parent().find('select[name^=\"destination_db\"]');\n        $tableDd    = $dropdown.parent().find('select[name^=\"destination_table\"]');\n        $columnDd   = $dropdown.parent().find('select[name^=\"destination_column\"]');\n    }\n\n    // if the changed dropdown is a database selector\n    if ($dropdown.is('select[name^=\"destination' + foreign + '_db\"]')) {\n        foreignDb = $dropdown.val();\n        // if no database is selected empty table and column dropdowns\n        if (foreignDb === '') {\n            TableRelation.setDropdownValues($tableDd, []);\n            TableRelation.setDropdownValues($columnDd, []);\n            return;\n        }\n    } else { // if a table selector\n        foreignDb = $databaseDd.val();\n        foreignTable = $dropdown.val();\n        // if no table is selected empty the column dropdown\n        if (foreignTable === '') {\n            TableRelation.setDropdownValues($columnDd, []);\n            return;\n        }\n    }\n    var $msgbox = Functions.ajaxShowMessage();\n    var $form = $dropdown.parents('form');\n    var $db = $form.find('input[name=\"db\"]').val();\n    var $table = $form.find('input[name=\"table\"]').val();\n    var argsep = CommonParams.get('arg_separator');\n    var params = 'getDropdownValues=true' + argsep + 'ajax_request=true' +\n        argsep + 'db=' + encodeURIComponent($db) +\n        argsep + 'table=' + encodeURIComponent($table) +\n        argsep + 'foreign=' + (foreign !== '') +\n        argsep + 'foreignDb=' + encodeURIComponent(foreignDb) +\n        (foreignTable !== null ?\n            argsep + 'foreignTable=' + encodeURIComponent(foreignTable) : ''\n        );\n    var $server = $form.find('input[name=\"server\"]');\n    if ($server.length > 0) {\n        params += argsep + 'server=' + $form.find('input[name=\"server\"]').val();\n    }\n    $.ajax({\n        type: 'POST',\n        url: 'index.php?route=/table/relation',\n        data: params,\n        dataType: 'json',\n        success: function (data) {\n            Functions.ajaxRemoveMessage($msgbox);\n            if (typeof data !== 'undefined' && data.success) {\n                // if the changed dropdown is a database selector\n                if (foreignTable === null) {\n                    // set values for table and column dropdowns\n                    TableRelation.setDropdownValues($tableDd, data.tables);\n                    TableRelation.setDropdownValues($columnDd, []);\n                } else { // if a table selector\n                    // set values for the column dropdown\n                    var primary = null;\n                    if (typeof data.primary !== 'undefined'\n                        && 1 === data.primary.length\n                    ) {\n                        primary = data.primary[0];\n                    }\n                    TableRelation.setDropdownValues($columnDd.first(), data.columns, primary);\n                    TableRelation.setDropdownValues($columnDd.slice(1), data.columns);\n                }\n            } else {\n                Functions.ajaxShowMessage(data.error, false);\n            }\n        }\n    });\n};\n\n/**\n * Unbind all event handlers before tearing down a page\n */\nAJAX.registerTeardown('table/relation.js', function () {\n    $('body').off('change',\n        'select[name^=\"destination_db\"], ' +\n        'select[name^=\"destination_table\"], ' +\n        'select[name^=\"destination_foreign_db\"], ' +\n        'select[name^=\"destination_foreign_table\"]'\n    );\n    $('body').off('click', 'a.add_foreign_key_field');\n    $('body').off('click', 'a.add_foreign_key');\n    $('a.drop_foreign_key_anchor.ajax').off('click');\n});\n\nAJAX.registerOnload('table/relation.js', function () {\n    /**\n     * Ajax event handler to fetch table/column dropdown values.\n     */\n    $('body').on('change',\n        'select[name^=\"destination_db\"], ' +\n        'select[name^=\"destination_table\"], ' +\n        'select[name^=\"destination_foreign_db\"], ' +\n        'select[name^=\"destination_foreign_table\"]',\n        function () {\n            TableRelation.getDropdownValues($(this));\n        }\n    );\n\n    /**\n     * Ajax event handler to add a column to a foreign key constraint.\n     */\n    $('body').on('click', 'a.add_foreign_key_field', function (event) {\n        event.preventDefault();\n        event.stopPropagation();\n\n        // Add field.\n        $(this)\n            .prev('span')\n            .clone(true, true)\n            .insertBefore($(this))\n            .find('select')\n            .val('');\n\n        // Add foreign field.\n        var $sourceElem = $('select[name^=\"destination_foreign_column[' +\n            $(this).attr('data-index') + ']\"]').last().parent();\n        $sourceElem\n            .clone(true, true)\n            .insertAfter($sourceElem)\n            .find('select')\n            .val('');\n    });\n\n    /**\n     * Ajax event handler to add a foreign key constraint.\n     */\n    $('body').on('click', 'a.add_foreign_key', function (event) {\n        event.preventDefault();\n        event.stopPropagation();\n\n        var $prevRow = $(this).closest('tr').prev('tr');\n        var $newRow = $prevRow.clone(true, true);\n\n        // Update serial number.\n        var currIndex = $newRow\n            .find('a.add_foreign_key_field')\n            .attr('data-index');\n        var newIndex = parseInt(currIndex) + 1;\n        $newRow.find('a.add_foreign_key_field').attr('data-index', newIndex);\n\n        // Update form parameter names.\n        $newRow.find('select[name^=\"foreign_key_fields_name\"]')\n            .not($newRow.find('select[name^=\"foreign_key_fields_name\"]').first())\n            .find('select[name^=\"destination_foreign_column\"]')\n            .not($newRow.find('select[name^=\"foreign_key_fields_name\"]')\n                .not($newRow.find('select[name^=\"foreign_key_fields_name\"]').first())\n                .find('select[name^=\"destination_foreign_column\"]').first()\n            ).each(function () {\n                $(this).parent().remove();\n            });\n        $newRow.find('input, select').each(function () {\n            $(this).attr('name',\n                $(this).attr('name').replace(/\\d/, newIndex)\n            );\n        });\n        $newRow.find('input[type=\"text\"]').each(function () {\n            $(this).val('');\n        });\n        // Finally add the row.\n        $newRow.insertAfter($prevRow);\n    });\n\n    /**\n     * Ajax Event handler for 'Drop Foreign key'\n     */\n    $('a.drop_foreign_key_anchor.ajax').on('click', function (event) {\n        event.preventDefault();\n        var $anchor = $(this);\n\n        // Object containing reference to the current field's row\n        var $currRow = $anchor.parents('tr');\n\n        var dropQuery = Functions.escapeHtml(\n            $currRow.children('td')\n                .children('.drop_foreign_key_msg')\n                .val()\n        );\n\n        var question = Functions.sprintf(Messages.strDoYouReally, dropQuery);\n\n        $anchor.confirm(question, $anchor.attr('href'), function (url) {\n            var $msg = Functions.ajaxShowMessage(Messages.strDroppingForeignKey, false);\n            var params = Functions.getJsConfirmCommonParam(this, $anchor.getPostData());\n            $.post(url, params, function (data) {\n                if (data.success === true) {\n                    Functions.ajaxRemoveMessage($msg);\n                    CommonActions.refreshMain(false, function () {\n                        // Do nothing\n                    });\n                } else {\n                    Functions.ajaxShowMessage(Messages.strErrorProcessingRequest + ' : ' + data.error, false);\n                }\n            }); // end $.post()\n        });\n    }); // end Drop Foreign key\n\n    var windowWidth = $(window).width();\n    $('.jsresponsive').css('max-width', (windowWidth - 35) + 'px');\n});\n"],"names":["TableRelation","showHideClauses","$thisDropdown","val","parent","nextAll","hide","is","show","setDropdownValues","$dropdown","values","selectedValue","empty","optionsAsString","unshift","$","each","Functions","escapeHtml","append","getDropdownValues","foreignDb","foreignTable","$databaseDd","$tableDd","$columnDd","foreign","find","$msgbox","ajaxShowMessage","$form","parents","$db","$table","argsep","CommonParams","get","params","encodeURIComponent","$server","length","ajax","type","url","data","dataType","success","ajaxRemoveMessage","tables","primary","first","columns","slice","error","AJAX","registerTeardown","off","registerOnload","on","event","preventDefault","stopPropagation","prev","clone","insertBefore","$sourceElem","attr","last","insertAfter","$prevRow","closest","$newRow","currIndex","newIndex","parseInt","not","remove","replace","$anchor","$currRow","dropQuery","children","question","sprintf","Messages","strDoYouReally","confirm","$msg","strDroppingForeignKey","getJsConfirmCommonParam","getPostData","post","CommonActions","refreshMain","strErrorProcessingRequest","windowWidth","window","width","css"],"sourceRoot":""}