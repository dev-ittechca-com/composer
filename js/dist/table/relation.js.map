{"version":3,"file":"table/relation.js","mappings":"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","sources":["webpack://phpmyadmin/external var \"jQuery\"","webpack://phpmyadmin/./js/src/table/relation.js"],"sourcesContent":["module.exports = jQuery;","import $ from 'jquery';\nimport { AJAX } from '../modules/ajax.js';\nimport { CommonParams } from '../modules/common.js';\nimport { ajaxRemoveMessage, ajaxShowMessage } from '../modules/ajax-message.js';\nimport getJsConfirmCommonParam from '../modules/functions/getJsConfirmCommonParam.js';\nimport { escapeHtml } from '../modules/functions/escape.js';\nimport refreshMainContent from '../modules/functions/refreshMainContent.js';\n\n/**\n * for table relation\n */\n\nvar TableRelation = {};\n\nTableRelation.showHideClauses = function ($thisDropdown) {\n    if ($thisDropdown.val() === '') {\n        $thisDropdown.parent().nextAll('span').hide();\n    } else {\n        if ($thisDropdown.is('select[name^=\"destination_foreign_column\"]')) {\n            $thisDropdown.parent().nextAll('span').show();\n        }\n    }\n};\n\n/**\n * Sets dropdown options to values\n * @param $dropdown\n * @param values\n * @param selectedValue\n * @return {void}\n */\nTableRelation.setDropdownValues = function ($dropdown, values, selectedValue) {\n    $dropdown.empty();\n    var optionsAsString = '';\n    // add an empty string to the beginning for empty selection\n    values.unshift('');\n    $.each(values, function () {\n        optionsAsString += '<option value=\\'' + escapeHtml(this) + '\\'' + (selectedValue === escapeHtml(this) ? ' selected=\\'selected\\'' : '') + '>' + escapeHtml(this) + '</option>';\n    });\n    $dropdown.append($(optionsAsString));\n};\n\n/**\n * Retrieves and populates dropdowns to the left based on the selected value\n *\n * @param $dropdown the dropdown whose value got changed\n * @return {void}\n */\nTableRelation.getDropdownValues = function ($dropdown) {\n    var foreignDb = null;\n    var foreignTable = null;\n    var $databaseDd;\n    var $tableDd;\n    var $columnDd;\n    var foreign = '';\n    // if the changed dropdown is for foreign key constraints\n    if ($dropdown.is('select[name^=\"destination_foreign\"]')) {\n        $databaseDd = $dropdown.parent().parent().parent().find('select[name^=\"destination_foreign_db\"]');\n        $tableDd = $dropdown.parent().parent().parent().find('select[name^=\"destination_foreign_table\"]');\n        $columnDd = $dropdown.parent().parent().parent().find('select[name^=\"destination_foreign_column\"]');\n        foreign = '_foreign';\n    } else { // internal relations\n        $databaseDd = $dropdown.parent().find('select[name^=\"destination_db\"]');\n        $tableDd = $dropdown.parent().find('select[name^=\"destination_table\"]');\n        $columnDd = $dropdown.parent().find('select[name^=\"destination_column\"]');\n    }\n\n    // if the changed dropdown is a database selector\n    if ($dropdown.is('select[name^=\"destination' + foreign + '_db\"]')) {\n        foreignDb = $dropdown.val();\n        // if no database is selected empty table and column dropdowns\n        if (foreignDb === '') {\n            TableRelation.setDropdownValues($tableDd, []);\n            TableRelation.setDropdownValues($columnDd, []);\n            return;\n        }\n    } else { // if a table selector\n        foreignDb = $databaseDd.val();\n        foreignTable = $dropdown.val();\n        // if no table is selected empty the column dropdown\n        if (foreignTable === '') {\n            TableRelation.setDropdownValues($columnDd, []);\n            return;\n        }\n    }\n    var $msgbox = ajaxShowMessage();\n    var $form = $dropdown.parents('form');\n    var $db = $form.find('input[name=\"db\"]').val();\n    var $table = $form.find('input[name=\"table\"]').val();\n    var argsep = CommonParams.get('arg_separator');\n    var params = 'getDropdownValues=true' + argsep + 'ajax_request=true' +\n        argsep + 'db=' + encodeURIComponent($db) +\n        argsep + 'table=' + encodeURIComponent($table) +\n        argsep + 'foreign=' + (foreign !== '') +\n        argsep + 'foreignDb=' + encodeURIComponent(foreignDb) +\n        (foreignTable !== null ?\n            argsep + 'foreignTable=' + encodeURIComponent(foreignTable) : ''\n        );\n    var $server = $form.find('input[name=\"server\"]');\n    if ($server.length > 0) {\n        params += argsep + 'server=' + $form.find('input[name=\"server\"]').val();\n    }\n    $.ajax({\n        type: 'POST',\n        url: 'index.php?route=/table/relation',\n        data: params,\n        dataType: 'json',\n        success: function (data) {\n            ajaxRemoveMessage($msgbox);\n            if (typeof data !== 'undefined' && data.success) {\n                // if the changed dropdown is a database selector\n                if (foreignTable === null) {\n                    // set values for table and column dropdowns\n                    TableRelation.setDropdownValues($tableDd, data.tables);\n                    TableRelation.setDropdownValues($columnDd, []);\n                } else { // if a table selector\n                    // set values for the column dropdown\n                    var primary = null;\n                    if (typeof data.primary !== 'undefined'\n                        && 1 === data.primary.length\n                    ) {\n                        primary = data.primary[0];\n                    }\n                    TableRelation.setDropdownValues($columnDd.first(), data.columns, primary);\n                    TableRelation.setDropdownValues($columnDd.slice(1), data.columns);\n                }\n            } else {\n                ajaxShowMessage(data.error, false);\n            }\n        }\n    });\n};\n\n/**\n * Unbind all event handlers before tearing down a page\n */\nAJAX.registerTeardown('table/relation.js', function () {\n    $('body').off('change',\n        'select[name^=\"destination_db\"], ' +\n        'select[name^=\"destination_table\"], ' +\n        'select[name^=\"destination_foreign_db\"], ' +\n        'select[name^=\"destination_foreign_table\"]'\n    );\n    $('body').off('click', 'a.add_foreign_key_field');\n    $('body').off('click', 'a.add_foreign_key');\n    $('a.drop_foreign_key_anchor.ajax').off('click');\n});\n\nAJAX.registerOnload('table/relation.js', function () {\n    /**\n     * Ajax event handler to fetch table/column dropdown values.\n     */\n    $('body').on('change',\n        'select[name^=\"destination_db\"], ' +\n        'select[name^=\"destination_table\"], ' +\n        'select[name^=\"destination_foreign_db\"], ' +\n        'select[name^=\"destination_foreign_table\"]',\n        function () {\n            TableRelation.getDropdownValues($(this));\n        }\n    );\n\n    /**\n     * Ajax event handler to add a column to a foreign key constraint.\n     */\n    $('body').on('click', 'a.add_foreign_key_field', function (event) {\n        event.preventDefault();\n        event.stopPropagation();\n\n        // Add field.\n        $(this)\n            .prev('span')\n            .clone(true, true)\n            .insertBefore($(this))\n            .find('select')\n            .val('');\n\n        // Add foreign field.\n        var $sourceElem = $('select[name^=\"destination_foreign_column[' +\n            $(this).attr('data-index') + ']\"]').last().parent();\n        $sourceElem\n            .clone(true, true)\n            .insertAfter($sourceElem)\n            .find('select')\n            .val('');\n    });\n\n    /**\n     * Ajax event handler to add a foreign key constraint.\n     */\n    $('body').on('click', 'a.add_foreign_key', function (event) {\n        event.preventDefault();\n        event.stopPropagation();\n\n        var $prevRow = $(this).closest('tr').prev('tr');\n        var $newRow = $prevRow.clone(true, true);\n\n        // Update serial number.\n        var currIndex = $newRow\n            .find('a.add_foreign_key_field')\n            .attr('data-index');\n        var newIndex = parseInt(currIndex) + 1;\n        $newRow.find('a.add_foreign_key_field').attr('data-index', newIndex);\n\n        // Update form parameter names.\n        $newRow.find('select[name^=\"foreign_key_fields_name\"]')\n            .not($newRow.find('select[name^=\"foreign_key_fields_name\"]').first())\n            .find('select[name^=\"destination_foreign_column\"]')\n            .not($newRow.find('select[name^=\"foreign_key_fields_name\"]')\n                .not($newRow.find('select[name^=\"foreign_key_fields_name\"]').first())\n                .find('select[name^=\"destination_foreign_column\"]').first()\n            ).each(function () {\n                $(this).parent().remove();\n            });\n        $newRow.find('input, select').each(function () {\n            $(this).attr('name',\n                $(this).attr('name').replace(/\\d/, newIndex)\n            );\n        });\n        $newRow.find('input[type=\"text\"]').each(function () {\n            $(this).val('');\n        });\n        // Finally add the row.\n        $newRow.insertAfter($prevRow);\n    });\n\n    /**\n     * Ajax Event handler for 'Drop Foreign key'\n     */\n    $('a.drop_foreign_key_anchor.ajax').on('click', function (event) {\n        event.preventDefault();\n        var $anchor = $(this);\n\n        // Object containing reference to the current field's row\n        var $currRow = $anchor.parents('tr');\n\n        var dropQuery = escapeHtml(\n            $currRow.children('td')\n                .children('.drop_foreign_key_msg')\n                .val()\n        );\n\n        var question = window.sprintf(window.Messages.strDoYouReally, dropQuery);\n\n        $anchor.confirm(question, $anchor.attr('href'), function (url) {\n            var $msg = ajaxShowMessage(window.Messages.strDroppingForeignKey, false);\n            var params = getJsConfirmCommonParam(this, $anchor.getPostData());\n            $.post(url, params, function (data) {\n                if (data.success === true) {\n                    ajaxRemoveMessage($msg);\n                    refreshMainContent(false);\n                    AJAX.callback = () => {\n                        // Do nothing\n                    };\n                } else {\n                    ajaxShowMessage(window.Messages.strErrorProcessingRequest + ' : ' + data.error, false);\n                }\n            }); // end $.post()\n        });\n    }); // end Drop Foreign key\n\n    var windowWidth = $(window).width();\n    $('.jsresponsive').css('max-width', (windowWidth - 35) + 'px');\n});\n"],"names":["$","AJAX","CommonParams","ajaxRemoveMessage","ajaxShowMessage","getJsConfirmCommonParam","escapeHtml","refreshMainContent","TableRelation","showHideClauses","$thisDropdown","val","parent","nextAll","hide","is","show","setDropdownValues","$dropdown","values","selectedValue","empty","optionsAsString","unshift","each","append","getDropdownValues","foreignDb","foreignTable","$databaseDd","$tableDd","$columnDd","foreign","find","$msgbox","$form","parents","$db","$table","argsep","get","params","encodeURIComponent","$server","length","ajax","type","url","data","dataType","success","tables","primary","first","columns","slice","error","registerTeardown","off","registerOnload","on","event","preventDefault","stopPropagation","prev","clone","insertBefore","$sourceElem","attr","last","insertAfter","$prevRow","closest","$newRow","currIndex","newIndex","parseInt","not","remove","replace","$anchor","$currRow","dropQuery","children","question","window","sprintf","Messages","strDoYouReally","confirm","$msg","strDroppingForeignKey","getPostData","post","callback","strErrorProcessingRequest","windowWidth","width","css"],"sourceRoot":""}