{"version":3,"file":"table/relation.js","mappings":"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","sources":["webpack://phpmyadmin/external var \"jQuery\"","webpack://phpmyadmin/./js/src/table/relation.js"],"sourcesContent":["module.exports = jQuery;","import $ from 'jquery';\nimport { AJAX } from '../modules/ajax.js';\nimport { CommonParams } from '../modules/common.js';\nimport { ajaxRemoveMessage, ajaxShowMessage } from '../modules/ajax-message.js';\nimport getJsConfirmCommonParam from '../modules/functions/getJsConfirmCommonParam.js';\nimport { escapeHtml } from '../modules/functions/escape.js';\nimport refreshMainContent from '../modules/functions/refreshMainContent.js';\n\n/**\n * for table relation\n */\n\nvar TableRelation = {};\n\nTableRelation.showHideClauses = function ($thisDropdown) {\n    if ($thisDropdown.val() === '') {\n        $thisDropdown.parent().nextAll('span').hide();\n    } else {\n        if ($thisDropdown.is('select[name^=\"destination_foreign_column\"]')) {\n            $thisDropdown.parent().nextAll('span').show();\n        }\n    }\n};\n\n/**\n * Sets dropdown options to values\n * @param $dropdown\n * @param values\n * @param selectedValue\n * @return {void}\n */\nTableRelation.setDropdownValues = function ($dropdown, values, selectedValue) {\n    $dropdown.empty();\n    var optionsAsString = '';\n    // add an empty string to the beginning for empty selection\n    values.unshift('');\n    $.each(values, function () {\n        optionsAsString += '<option value=\\'' + escapeHtml(this) + '\\'' + (selectedValue === escapeHtml(this) ? ' selected=\\'selected\\'' : '') + '>' + escapeHtml(this) + '</option>';\n    });\n    $dropdown.append($(optionsAsString));\n};\n\n/**\n * Retrieves and populates dropdowns to the left based on the selected value\n *\n * @param $dropdown the dropdown whose value got changed\n * @return {void}\n */\nTableRelation.getDropdownValues = function ($dropdown) {\n    var foreignDb = null;\n    var foreignTable = null;\n    var $databaseDd;\n    var $tableDd;\n    var $columnDd;\n    var foreign = '';\n    // if the changed dropdown is for foreign key constraints\n    if ($dropdown.is('select[name^=\"destination_foreign\"]')) {\n        $databaseDd = $dropdown.parent().parent().parent().find('select[name^=\"destination_foreign_db\"]');\n        $tableDd = $dropdown.parent().parent().parent().find('select[name^=\"destination_foreign_table\"]');\n        $columnDd = $dropdown.parent().parent().parent().find('select[name^=\"destination_foreign_column\"]');\n        foreign = '_foreign';\n    } else { // internal relations\n        $databaseDd = $dropdown.parent().find('select[name^=\"destination_db\"]');\n        $tableDd = $dropdown.parent().find('select[name^=\"destination_table\"]');\n        $columnDd = $dropdown.parent().find('select[name^=\"destination_column\"]');\n    }\n\n    // if the changed dropdown is a database selector\n    if ($dropdown.is('select[name^=\"destination' + foreign + '_db\"]')) {\n        foreignDb = $dropdown.val();\n        // if no database is selected empty table and column dropdowns\n        if (foreignDb === '') {\n            TableRelation.setDropdownValues($tableDd, []);\n            TableRelation.setDropdownValues($columnDd, []);\n            return;\n        }\n    } else { // if a table selector\n        foreignDb = $databaseDd.val();\n        foreignTable = $dropdown.val();\n        // if no table is selected empty the column dropdown\n        if (foreignTable === '') {\n            TableRelation.setDropdownValues($columnDd, []);\n            return;\n        }\n    }\n    var $msgbox = ajaxShowMessage();\n    var $form = $dropdown.parents('form');\n    var $db = $form.find('input[name=\"db\"]').val();\n    var $table = $form.find('input[name=\"table\"]').val();\n    var argsep = CommonParams.get('arg_separator');\n    var params = 'getDropdownValues=true' + argsep + 'ajax_request=true' +\n        argsep + 'db=' + encodeURIComponent($db) +\n        argsep + 'table=' + encodeURIComponent($table) +\n        argsep + 'foreign=' + (foreign !== '') +\n        argsep + 'foreignDb=' + encodeURIComponent(foreignDb) +\n        (foreignTable !== null ?\n            argsep + 'foreignTable=' + encodeURIComponent(foreignTable) : ''\n        );\n    var $server = $form.find('input[name=\"server\"]');\n    if ($server.length > 0) {\n        params += argsep + 'server=' + $form.find('input[name=\"server\"]').val();\n    }\n    $.ajax({\n        type: 'POST',\n        url: 'index.php?route=/table/relation',\n        data: params,\n        dataType: 'json',\n        success: function (data) {\n            ajaxRemoveMessage($msgbox);\n            if (typeof data !== 'undefined' && data.success) {\n                // if the changed dropdown is a database selector\n                if (foreignTable === null) {\n                    // set values for table and column dropdowns\n                    TableRelation.setDropdownValues($tableDd, data.tables);\n                    TableRelation.setDropdownValues($columnDd, []);\n                } else { // if a table selector\n                    // set values for the column dropdown\n                    var primary = null;\n                    if (typeof data.primary !== 'undefined'\n                        && 1 === data.primary.length\n                    ) {\n                        primary = data.primary[0];\n                    }\n                    TableRelation.setDropdownValues($columnDd.first(), data.columns, primary);\n                    TableRelation.setDropdownValues($columnDd.slice(1), data.columns);\n                }\n            } else {\n                ajaxShowMessage(data.error, false);\n            }\n        }\n    });\n};\n\n/**\n * Unbind all event handlers before tearing down a page\n */\nAJAX.registerTeardown('table/relation.js', function () {\n    $('body').off('change',\n        'select[name^=\"destination_db\"], ' +\n        'select[name^=\"destination_table\"], ' +\n        'select[name^=\"destination_foreign_db\"], ' +\n        'select[name^=\"destination_foreign_table\"]'\n    );\n    $('body').off('click', 'a.add_foreign_key_field');\n    $('body').off('click', 'a.add_foreign_key');\n    $('a.drop_foreign_key_anchor.ajax').off('click');\n});\n\nAJAX.registerOnload('table/relation.js', function () {\n    /**\n     * Ajax event handler to fetch table/column dropdown values.\n     */\n    $('body').on('change',\n        'select[name^=\"destination_db\"], ' +\n        'select[name^=\"destination_table\"], ' +\n        'select[name^=\"destination_foreign_db\"], ' +\n        'select[name^=\"destination_foreign_table\"]',\n        function () {\n            TableRelation.getDropdownValues($(this));\n        }\n    );\n\n    /**\n     * Ajax event handler to add a column to a foreign key constraint.\n     */\n    $('body').on('click', 'a.add_foreign_key_field', function (event) {\n        event.preventDefault();\n        event.stopPropagation();\n\n        // Add field.\n        $(this)\n            .prev('span')\n            .clone(true, true)\n            .insertBefore($(this))\n            .find('select')\n            .val('');\n\n        // Add foreign field.\n        var $sourceElem = $('select[name^=\"destination_foreign_column[' +\n            $(this).attr('data-index') + ']\"]').last().parent();\n        $sourceElem\n            .clone(true, true)\n            .insertAfter($sourceElem)\n            .find('select')\n            .val('');\n    });\n\n    /**\n     * Ajax event handler to add a foreign key constraint.\n     */\n    $('body').on('click', 'a.add_foreign_key', function (event) {\n        event.preventDefault();\n        event.stopPropagation();\n\n        var $prevRow = $(this).closest('tr').prev('tr');\n        var $newRow = $prevRow.clone(true, true);\n\n        // Update serial number.\n        var currIndex = $newRow\n            .find('a.add_foreign_key_field')\n            .attr('data-index');\n        var newIndex = parseInt(currIndex) + 1;\n        $newRow.find('a.add_foreign_key_field').attr('data-index', newIndex);\n\n        // Update form parameter names.\n        $newRow.find('select[name^=\"foreign_key_fields_name\"]')\n            .not($newRow.find('select[name^=\"foreign_key_fields_name\"]').first())\n            .find('select[name^=\"destination_foreign_column\"]')\n            .not($newRow.find('select[name^=\"foreign_key_fields_name\"]')\n                .not($newRow.find('select[name^=\"foreign_key_fields_name\"]').first())\n                .find('select[name^=\"destination_foreign_column\"]').first()\n            ).each(function () {\n                $(this).parent().remove();\n            });\n        $newRow.find('input, select').each(function () {\n            $(this).attr('name',\n                $(this).attr('name').replace(/\\d/, newIndex)\n            );\n        });\n        $newRow.find('input[type=\"text\"]').each(function () {\n            $(this).val('');\n        });\n        // Finally add the row.\n        $newRow.insertAfter($prevRow);\n    });\n\n    /**\n     * Ajax Event handler for 'Drop Foreign key'\n     */\n    $('a.drop_foreign_key_anchor.ajax').on('click', function (event) {\n        event.preventDefault();\n        var $anchor = $(this);\n\n        // Object containing reference to the current field's row\n        var $currRow = $anchor.parents('tr');\n\n        var dropQuery = escapeHtml(\n            $currRow.children('td')\n                .children('.drop_foreign_key_msg')\n                .val()\n        );\n\n        var question = window.sprintf(window.Messages.strDoYouReally, dropQuery);\n\n        $anchor.confirm(question, $anchor.attr('href'), function (url) {\n            var $msg = ajaxShowMessage(window.Messages.strDroppingForeignKey, false);\n            var params = getJsConfirmCommonParam(this, $anchor.getPostData());\n            $.post(url, params, function (data) {\n                if (data.success === true) {\n                    ajaxRemoveMessage($msg);\n                    refreshMainContent(false);\n                    AJAX.callback = () => {\n                        // Do nothing\n                    };\n                } else {\n                    ajaxShowMessage(window.Messages.strErrorProcessingRequest + ' : ' + data.error, false);\n                }\n            }); // end $.post()\n        });\n    }); // end Drop Foreign key\n\n    var windowWidth = $(window).width();\n    $('.jsresponsive').css('max-width', (windowWidth - 35) + 'px');\n});\n"],"names":["$","AJAX","CommonParams","ajaxRemoveMessage","ajaxShowMessage","getJsConfirmCommonParam","escapeHtml","refreshMainContent","TableRelation","showHideClauses","$thisDropdown","val","parent","nextAll","hide","is","show","setDropdownValues","$dropdown","values","selectedValue","empty","optionsAsString","unshift","each","append","getDropdownValues","foreignDb","foreignTable","$databaseDd","$tableDd","$columnDd","foreign","find","$msgbox","$form","parents","$db","$table","argsep","get","params","encodeURIComponent","$server","length","ajax","type","url","data","dataType","success","tables","primary","first","columns","slice","error","registerTeardown","off","registerOnload","on","event","preventDefault","stopPropagation","prev","clone","insertBefore","$sourceElem","attr","last","insertAfter","$prevRow","closest","$newRow","currIndex","newIndex","parseInt","not","remove","replace","$anchor","$currRow","dropQuery","children","question","window","sprintf","Messages","strDoYouReally","confirm","$msg","strDroppingForeignKey","getPostData","post","callback","strErrorProcessingRequest","windowWidth","width","css"],"sourceRoot":""}