{"version":3,"file":"database/multi_table_query.js","mappings":"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","sources":["webpack://phpmyadmin/./js/src/database/multi_table_query.js"],"sourcesContent":["/**\n * @fileoverview    function used in QBE for DB\n * @name            Database Operations\n *\n * @requires    jQuery\n * @requires    jQueryUI\n * @requires    js/functions.js\n * @requires    js/database/query_generator.js\n *\n */\n\n/* global generateFromBlock, generateWhereBlock */ // js/database/query_generator.js\n\n/**\n * js file for handling AJAX and other events in /database/multi-table-query\n */\n\n/**\n * Unbind all event handlers before tearing down a page\n */\nAJAX.registerTeardown('database/multi_table_query.js', function () {\n    $('.tableNameSelect').each(function () {\n        $(this).off('change');\n    });\n    $('#update_query_button').off('click');\n    $('#add_column_button').off('click');\n});\n\nAJAX.registerOnload('database/multi_table_query.js', function () {\n    var editor = Functions.getSqlEditor($('#MultiSqlquery'), {}, 'both');\n    $('.CodeMirror-line').css('text-align', 'left');\n    editor.setSize(-1, 50);\n\n    var columnCount = 3;\n    addNewColumnCallbacks();\n\n    $('#update_query_button').on('click', function () {\n        var columns = [];\n        var tableAliases = {};\n        $('.tableNameSelect').each(function () {\n            var $show = $(this).siblings('.show_col').first();\n            if ($(this).val() !== '' && $show.prop('checked')) {\n                var tableAlias = $(this).siblings('.table_alias').first().val();\n                var columnAlias = $(this).siblings('.col_alias').first().val();\n\n                if (tableAlias !== '') {\n                    columns.push([tableAlias, $(this).siblings('.columnNameSelect').first().val()]);\n                } else {\n                    columns.push([$(this).val(), $(this).siblings('.columnNameSelect').first().val()]);\n                }\n\n                columns[columns.length - 1].push(columnAlias);\n\n                if ($(this).val() in tableAliases) {\n                    if (!(tableAliases[$(this).val()].includes(tableAlias))) {\n                        tableAliases[$(this).val()].push(tableAlias);\n                    }\n                } else {\n                    tableAliases[$(this).val()] = [tableAlias];\n                }\n            }\n        });\n        if (Object.keys(tableAliases).length === 0) {\n            Functions.ajaxShowMessage('Nothing selected', false, 'error');\n            return;\n        }\n\n        var foreignKeys;\n        $.ajax({\n            type: 'GET',\n            async: false,\n            url: 'index.php?route=/database/multi-table-query/tables',\n            data: {\n                'server': sessionStorage.server,\n                'db': $('#db_name').val(),\n                'tables': Object.keys(tableAliases),\n                'ajax_request': '1',\n                'token': CommonParams.get('token')\n            },\n            success: function (response) {\n                foreignKeys = response.foreignKeyConstrains;\n            }\n        });\n\n        var query = 'SELECT ' + '`' + Functions.escapeBacktick(columns[0][0]) + '`.';\n        if (columns[0][1] === '*') {\n            query += '*';\n        } else {\n            query += '`' + Functions.escapeBacktick(columns[0][1]) + '`';\n        }\n        if (columns[0][2] !== '') {\n            query += ' AS `' + Functions.escapeBacktick(columns[0][2]) + '`';\n        }\n        for (var i = 1; i < columns.length; i++) {\n            query += ', `' + Functions.escapeBacktick(columns[i][0]) + '`.';\n            if (columns[i][1] === '*') {\n                query += '*';\n            } else {\n                query += '`' + Functions.escapeBacktick(columns[i][1]) + '`';\n            }\n            if (columns[i][2] !== '') {\n                query += ' AS `' + Functions.escapeBacktick(columns[i][2]) + '`';\n            }\n        }\n        query += '\\nFROM ';\n\n        query += generateFromBlock(tableAliases, foreignKeys);\n\n        var $criteriaColCount = $('.criteria_col:checked').length;\n        if ($criteriaColCount > 0) {\n            query += '\\nWHERE ';\n            query += generateWhereBlock();\n        }\n\n        query += ';';\n        editor.getDoc().setValue(query);\n    });\n\n    $('#submit_query').on('click', function () {\n        var query = editor.getDoc().getValue();\n        // Verifying that the query is not empty\n        if (query === '') {\n            Functions.ajaxShowMessage(Messages.strEmptyQuery, false, 'error');\n            return;\n        }\n        var data = {\n            'db': $('#db_name').val(),\n            'sql_query': query,\n            'ajax_request': '1',\n            'server': CommonParams.get('server'),\n            'token': CommonParams.get('token')\n        };\n        $.ajax({\n            type: 'POST',\n            url: 'index.php?route=/database/multi-table-query/query',\n            data: data,\n            success: function (data) {\n                var $resultsDom = $(data.message);\n                $resultsDom.find('.ajax:not(.pageselector)').each(function () {\n                    $(this).on('click', function (event) {\n                        event.preventDefault();\n                    });\n                });\n                $resultsDom.find('.autosubmit, .pageselector, .showAllRows, .filter_rows').each(function () {\n                    $(this).on('change click select focus', function (event) {\n                        event.preventDefault();\n                    });\n                });\n                $('#sql_results').html($resultsDom);\n                $('#slide-handle').trigger('click');// Collapse search criteria area\n            }\n        });\n    });\n\n    $('#add_column_button').on('click', function () {\n        columnCount++;\n        var $newColumnDom = $($('#new_column_layout').html()).clone();\n        $newColumnDom.find('.jsCriteriaButton').first().attr('data-bs-target', '#criteriaOptionsExtra' + columnCount.toString());\n        $newColumnDom.find('.jsCriteriaButton').first().attr('aria-controls', 'criteriaOptionsExtra' + columnCount.toString());\n        $newColumnDom.find('.jsCriteriaOptions').first().attr('id', 'criteriaOptionsExtra' + columnCount.toString());\n        $('#add_column_button').parent().before($newColumnDom);\n        addNewColumnCallbacks();\n    });\n\n    function addNewColumnCallbacks () {\n        $('.tableNameSelect').each(function () {\n            $(this).on('change', function () {\n                var $sibs = $(this).siblings('.columnNameSelect');\n                if ($sibs.length === 0) {\n                    $sibs = $(this).parent().parent().find('.columnNameSelect');\n                }\n                $sibs.first().html($('#' + $(this).find(':selected').data('hash')).html());\n            });\n        });\n\n        $('.jsRemoveColumn').each(function () {\n            $(this).on('click', function () {\n                $(this).parent().remove();\n            });\n        });\n\n        $('.jsCriteriaButton').each(function () {\n            $(this).on('click', function (event, from) {\n                if (from === null) {\n                    var $checkbox = $(this).siblings('.criteria_col').first();\n                    $checkbox.prop('checked', !$checkbox.prop('checked'));\n                }\n                var $criteriaColCount = $('.criteria_col:checked').length;\n                if ($criteriaColCount > 1) {\n                    $(this).siblings('.jsCriteriaOptions').first().find('.logical_operator').first().css('display','table-row');\n                }\n            });\n        });\n\n        $('.criteria_col').each(function () {\n            $(this).on('change', function () {\n                var $anchor = $(this).siblings('.jsCriteriaButton').first();\n                $anchor.trigger('click', ['Trigger']);\n            });\n        });\n\n        $('.criteria_rhs').each(function () {\n            $(this).on('change', function () {\n                var $rhsCol = $(this).parent().parent().siblings('.rhs_table').first();\n                var $rhsText = $(this).parent().parent().siblings('.rhs_text').first();\n                if ($(this).val() === 'text') {\n                    $rhsCol.css('display', 'none');\n                    $rhsText.css('display', 'table-row');\n                } else if ($(this).val() === 'anotherColumn') {\n                    $rhsText.css('display', 'none');\n                    $rhsCol.css('display', 'table-row');\n                } else {\n                    $rhsText.css('display', 'none');\n                    $rhsCol.css('display', 'none');\n                }\n            });\n        });\n    }\n});\n"],"names":["AJAX","registerTeardown","$","each","off","registerOnload","editor","Functions","getSqlEditor","css","setSize","columnCount","addNewColumnCallbacks","on","columns","tableAliases","$show","siblings","first","val","prop","tableAlias","columnAlias","push","length","includes","Object","keys","ajaxShowMessage","foreignKeys","ajax","type","async","url","data","sessionStorage","server","CommonParams","get","success","response","foreignKeyConstrains","query","escapeBacktick","i","generateFromBlock","$criteriaColCount","generateWhereBlock","getDoc","setValue","getValue","Messages","strEmptyQuery","$resultsDom","message","find","event","preventDefault","html","trigger","$newColumnDom","clone","attr","toString","parent","before","$sibs","remove","from","$checkbox","$anchor","$rhsCol","$rhsText"],"sourceRoot":""}