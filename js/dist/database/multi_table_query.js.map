{"version":3,"file":"database/multi_table_query.js","mappings":";;;;;;AAAA;;;;;;;;;;;;;;ACAuB;AACmB;AACU;AACA;AACS;AACG;;AAEhE;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACAC,mEAAqB,CAAC,+BAA+B,EAAE,YAAY;EAC/DD,mCAAC,CAAC,kBAAkB,CAAC,CAACO,IAAI,CAAC,YAAY;IACnCP,mCAAC,CAAC,IAAI,CAAC,CAACQ,GAAG,CAAC,QAAQ,CAAC;EACzB,CAAC,CAAC;EACFR,mCAAC,CAAC,sBAAsB,CAAC,CAACQ,GAAG,CAAC,OAAO,CAAC;EACtCR,mCAAC,CAAC,oBAAoB,CAAC,CAACQ,GAAG,CAAC,OAAO,CAAC;AACxC,CAAC,CAAC;AAEFP,iEAAmB,CAAC,+BAA+B,EAAE,YAAY;EAC7D,IAAIS,MAAM,GAAGR,yEAAsB,CAACF,mCAAC,CAAC,gBAAgB,CAAC,EAAE,CAAC,CAAC,EAAE,MAAM,CAAC;EACpEA,mCAAC,CAAC,kBAAkB,CAAC,CAACY,GAAG,CAAC,YAAY,EAAE,MAAM,CAAC;EAC/CF,MAAM,CAACG,OAAO,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;EAEtB,IAAIC,WAAW,GAAG,CAAC;EACnBC,qBAAqB,EAAE;EAEvBf,mCAAC,CAAC,sBAAsB,CAAC,CAACgB,EAAE,CAAC,OAAO,EAAE,YAAY;IAC9C,IAAIC,OAAO,GAAG,EAAE;IAChB,IAAIC,YAAY,GAAG,CAAC,CAAC;IACrBlB,mCAAC,CAAC,kBAAkB,CAAC,CAACO,IAAI,CAAC,YAAY;MACnC,IAAIY,KAAK,GAAGnB,mCAAC,CAAC,IAAI,CAAC,CAACoB,QAAQ,CAAC,WAAW,CAAC,CAACC,KAAK,EAAE;MACjD,IAAIrB,mCAAC,CAAC,IAAI,CAAC,CAACsB,GAAG,EAAE,KAAK,EAAE,IAAIH,KAAK,CAACI,IAAI,CAAC,SAAS,CAAC,EAAE;QAC/C,IAAIC,UAAU,GAAGxB,mCAAC,CAAC,IAAI,CAAC,CAACoB,QAAQ,CAAC,cAAc,CAAC,CAACC,KAAK,EAAE,CAACC,GAAG,EAAE;QAC/D,IAAIG,WAAW,GAAGzB,mCAAC,CAAC,IAAI,CAAC,CAACoB,QAAQ,CAAC,YAAY,CAAC,CAACC,KAAK,EAAE,CAACC,GAAG,EAAE;QAE9D,IAAIE,UAAU,KAAK,EAAE,EAAE;UACnBP,OAAO,CAACS,IAAI,CAAC,CAACF,UAAU,EAAExB,mCAAC,CAAC,IAAI,CAAC,CAACoB,QAAQ,CAAC,mBAAmB,CAAC,CAACC,KAAK,EAAE,CAACC,GAAG,EAAE,CAAC,CAAC;QACnF,CAAC,MAAM;UACHL,OAAO,CAACS,IAAI,CAAC,CAAC1B,mCAAC,CAAC,IAAI,CAAC,CAACsB,GAAG,EAAE,EAAEtB,mCAAC,CAAC,IAAI,CAAC,CAACoB,QAAQ,CAAC,mBAAmB,CAAC,CAACC,KAAK,EAAE,CAACC,GAAG,EAAE,CAAC,CAAC;QACtF;QAEAL,OAAO,CAACA,OAAO,CAACU,MAAM,GAAG,CAAC,CAAC,CAACD,IAAI,CAACD,WAAW,CAAC;QAE7C,IAAIzB,mCAAC,CAAC,IAAI,CAAC,CAACsB,GAAG,EAAE,IAAIJ,YAAY,EAAE;UAC/B,IAAI,CAAGA,YAAY,CAAClB,mCAAC,CAAC,IAAI,CAAC,CAACsB,GAAG,EAAE,CAAC,CAACM,QAAQ,CAACJ,UAAU,CAAE,EAAE;YACtDN,YAAY,CAAClB,mCAAC,CAAC,IAAI,CAAC,CAACsB,GAAG,EAAE,CAAC,CAACI,IAAI,CAACF,UAAU,CAAC;UAChD;QACJ,CAAC,MAAM;UACHN,YAAY,CAAClB,mCAAC,CAAC,IAAI,CAAC,CAACsB,GAAG,EAAE,CAAC,GAAG,CAACE,UAAU,CAAC;QAC9C;MACJ;IACJ,CAAC,CAAC;IACF,IAAIK,MAAM,CAACC,IAAI,CAACZ,YAAY,CAAC,CAACS,MAAM,KAAK,CAAC,EAAE;MACxCvB,yEAAe,CAAC,kBAAkB,EAAE,KAAK,EAAE,OAAO,CAAC;MACnD;IACJ;IAEA,IAAI2B,WAAW;IACf/B,wCAAM,CAAC;MACHiC,IAAI,EAAE,KAAK;MACXC,KAAK,EAAE,KAAK;MACZC,GAAG,EAAE,oDAAoD;MACzDC,IAAI,EAAE;QACF,QAAQ,EAAEC,cAAc,CAACC,MAAM;QAC/B,IAAI,EAAEtC,mCAAC,CAAC,UAAU,CAAC,CAACsB,GAAG,EAAE;QACzB,QAAQ,EAAEO,MAAM,CAACC,IAAI,CAACZ,YAAY,CAAC;QACnC,cAAc,EAAE,GAAG;QACnB,OAAO,EAAEf,gEAAgB,CAAC,OAAO;MACrC,CAAC;MACDqC,OAAO,EAAE,UAAUC,QAAQ,EAAE;QACzBV,WAAW,GAAGU,QAAQ,CAACC,oBAAoB;MAC/C;IACJ,CAAC,CAAC;IAEF,IAAIC,KAAK,GAAG,SAAS,GAAG,GAAG,GAAGtC,4EAAc,CAACY,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI;IAClE,IAAIA,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE;MACvB0B,KAAK,IAAI,GAAG;IAChB,CAAC,MAAM;MACHA,KAAK,IAAI,GAAG,GAAGtC,4EAAc,CAACY,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG;IACtD;IACA,IAAIA,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE,EAAE;MACtB0B,KAAK,IAAI,OAAO,GAAGtC,4EAAc,CAACY,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG;IAC1D;IACA,KAAK,IAAI2B,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG3B,OAAO,CAACU,MAAM,EAAEiB,CAAC,EAAE,EAAE;MACrCD,KAAK,IAAI,KAAK,GAAGtC,4EAAc,CAACY,OAAO,CAAC2B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI;MACrD,IAAI3B,OAAO,CAAC2B,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE;QACvBD,KAAK,IAAI,GAAG;MAChB,CAAC,MAAM;QACHA,KAAK,IAAI,GAAG,GAAGtC,4EAAc,CAACY,OAAO,CAAC2B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG;MACtD;MACA,IAAI3B,OAAO,CAAC2B,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE,EAAE;QACtBD,KAAK,IAAI,OAAO,GAAGtC,4EAAc,CAACY,OAAO,CAAC2B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG;MAC1D;IACJ;IACAD,KAAK,IAAI,SAAS;IAElBA,KAAK,IAAIE,MAAM,CAACC,iBAAiB,CAAC5B,YAAY,EAAEa,WAAW,CAAC;IAE5D,IAAIgB,iBAAiB,GAAG/C,mCAAC,CAAC,uBAAuB,CAAC,CAAC2B,MAAM;IACzD,IAAIoB,iBAAiB,GAAG,CAAC,EAAE;MACvBJ,KAAK,IAAI,UAAU;MACnBA,KAAK,IAAIE,MAAM,CAACG,kBAAkB,EAAE;IACxC;IAEAL,KAAK,IAAI,GAAG;IACZjC,MAAM,CAACuC,MAAM,EAAE,CAACC,QAAQ,CAACP,KAAK,CAAC;EACnC,CAAC,CAAC;EAEF3C,mCAAC,CAAC,eAAe,CAAC,CAACgB,EAAE,CAAC,OAAO,EAAE,YAAY;IACvC,IAAI2B,KAAK,GAAGjC,MAAM,CAACuC,MAAM,EAAE,CAACE,QAAQ,EAAE;IACtC;IACA,IAAIR,KAAK,KAAK,EAAE,EAAE;MACdvC,yEAAe,CAACyC,MAAM,CAACO,QAAQ,CAACC,aAAa,EAAE,KAAK,EAAE,OAAO,CAAC;MAC9D;IACJ;IACA,IAAIjB,IAAI,GAAG;MACP,IAAI,EAAEpC,mCAAC,CAAC,UAAU,CAAC,CAACsB,GAAG,EAAE;MACzB,WAAW,EAAEqB,KAAK;MAClB,cAAc,EAAE,GAAG;MACnB,QAAQ,EAAExC,gEAAgB,CAAC,QAAQ,CAAC;MACpC,OAAO,EAAEA,gEAAgB,CAAC,OAAO;IACrC,CAAC;IACDH,wCAAM,CAAC;MACHiC,IAAI,EAAE,MAAM;MACZE,GAAG,EAAE,mDAAmD;MACxDC,IAAI,EAAEA,IAAI;MACVI,OAAO,EAAE,UAAUJ,IAAI,EAAE;QACrB,IAAIkB,WAAW,GAAGtD,mCAAC,CAACoC,IAAI,CAACmB,OAAO,CAAC;QACjCD,WAAW,CAACE,IAAI,CAAC,0BAA0B,CAAC,CAACjD,IAAI,CAAC,YAAY;UAC1DP,mCAAC,CAAC,IAAI,CAAC,CAACgB,EAAE,CAAC,OAAO,EAAE,UAAUyC,KAAK,EAAE;YACjCA,KAAK,CAACC,cAAc,EAAE;UAC1B,CAAC,CAAC;QACN,CAAC,CAAC;QACFJ,WAAW,CAACE,IAAI,CAAC,wDAAwD,CAAC,CAACjD,IAAI,CAAC,YAAY;UACxFP,mCAAC,CAAC,IAAI,CAAC,CAACgB,EAAE,CAAC,2BAA2B,EAAE,UAAUyC,KAAK,EAAE;YACrDA,KAAK,CAACC,cAAc,EAAE;UAC1B,CAAC,CAAC;QACN,CAAC,CAAC;QACF1D,mCAAC,CAAC,cAAc,CAAC,CAAC2D,IAAI,CAACL,WAAW,CAAC;QACnCtD,mCAAC,CAAC,eAAe,CAAC,CAAC4D,OAAO,CAAC,OAAO,CAAC,CAAC;MACxC;IACJ,CAAC,CAAC;EACN,CAAC,CAAC;;EAEF5D,mCAAC,CAAC,oBAAoB,CAAC,CAACgB,EAAE,CAAC,OAAO,EAAE,YAAY;IAC5CF,WAAW,EAAE;IACb,IAAI+C,aAAa,GAAG7D,mCAAC,CAACA,mCAAC,CAAC,oBAAoB,CAAC,CAAC2D,IAAI,EAAE,CAAC,CAACG,KAAK,EAAE;IAC7DD,aAAa,CAACL,IAAI,CAAC,mBAAmB,CAAC,CAACnC,KAAK,EAAE,CAAC0C,IAAI,CAAC,gBAAgB,EAAE,uBAAuB,GAAGjD,WAAW,CAACkD,QAAQ,EAAE,CAAC;IACxHH,aAAa,CAACL,IAAI,CAAC,mBAAmB,CAAC,CAACnC,KAAK,EAAE,CAAC0C,IAAI,CAAC,eAAe,EAAE,sBAAsB,GAAGjD,WAAW,CAACkD,QAAQ,EAAE,CAAC;IACtHH,aAAa,CAACL,IAAI,CAAC,oBAAoB,CAAC,CAACnC,KAAK,EAAE,CAAC0C,IAAI,CAAC,IAAI,EAAE,sBAAsB,GAAGjD,WAAW,CAACkD,QAAQ,EAAE,CAAC;IAC5GhE,mCAAC,CAAC,oBAAoB,CAAC,CAACiE,MAAM,EAAE,CAACC,MAAM,CAACL,aAAa,CAAC;IACtD9C,qBAAqB,EAAE;EAC3B,CAAC,CAAC;EAEF,SAASA,qBAAqB,GAAI;IAC9Bf,mCAAC,CAAC,kBAAkB,CAAC,CAACO,IAAI,CAAC,YAAY;MACnCP,mCAAC,CAAC,IAAI,CAAC,CAACgB,EAAE,CAAC,QAAQ,EAAE,YAAY;QAC7B,IAAImD,KAAK,GAAGnE,mCAAC,CAAC,IAAI,CAAC,CAACoB,QAAQ,CAAC,mBAAmB,CAAC;QACjD,IAAI+C,KAAK,CAACxC,MAAM,KAAK,CAAC,EAAE;UACpBwC,KAAK,GAAGnE,mCAAC,CAAC,IAAI,CAAC,CAACiE,MAAM,EAAE,CAACA,MAAM,EAAE,CAACT,IAAI,CAAC,mBAAmB,CAAC;QAC/D;QACAW,KAAK,CAAC9C,KAAK,EAAE,CAACsC,IAAI,CAAC3D,mCAAC,CAAC,GAAG,GAAGA,mCAAC,CAAC,IAAI,CAAC,CAACwD,IAAI,CAAC,WAAW,CAAC,CAACpB,IAAI,CAAC,MAAM,CAAC,CAAC,CAACuB,IAAI,EAAE,CAAC;MAC9E,CAAC,CAAC;IACN,CAAC,CAAC;IAEF3D,mCAAC,CAAC,iBAAiB,CAAC,CAACO,IAAI,CAAC,YAAY;MAClCP,mCAAC,CAAC,IAAI,CAAC,CAACgB,EAAE,CAAC,OAAO,EAAE,YAAY;QAC5BhB,mCAAC,CAAC,IAAI,CAAC,CAACiE,MAAM,EAAE,CAACG,MAAM,EAAE;MAC7B,CAAC,CAAC;IACN,CAAC,CAAC;IAEFpE,mCAAC,CAAC,mBAAmB,CAAC,CAACO,IAAI,CAAC,YAAY;MACpCP,mCAAC,CAAC,IAAI,CAAC,CAACgB,EAAE,CAAC,OAAO,EAAE,UAAUyC,KAAK,EAAEY,IAAI,EAAE;QACvC,IAAIA,IAAI,KAAK,IAAI,EAAE;UACf,IAAIC,SAAS,GAAGtE,mCAAC,CAAC,IAAI,CAAC,CAACoB,QAAQ,CAAC,eAAe,CAAC,CAACC,KAAK,EAAE;UACzDiD,SAAS,CAAC/C,IAAI,CAAC,SAAS,EAAE,CAAE+C,SAAS,CAAC/C,IAAI,CAAC,SAAS,CAAC,CAAC;QAC1D;QACA,IAAIwB,iBAAiB,GAAG/C,mCAAC,CAAC,uBAAuB,CAAC,CAAC2B,MAAM;QACzD,IAAIoB,iBAAiB,GAAG,CAAC,EAAE;UACvB/C,mCAAC,CAAC,IAAI,CAAC,CAACoB,QAAQ,CAAC,oBAAoB,CAAC,CAACC,KAAK,EAAE,CAACmC,IAAI,CAAC,mBAAmB,CAAC,CAACnC,KAAK,EAAE,CAACT,GAAG,CAAC,SAAS,EAAE,WAAW,CAAC;QAChH;MACJ,CAAC,CAAC;IACN,CAAC,CAAC;IAEFZ,mCAAC,CAAC,eAAe,CAAC,CAACO,IAAI,CAAC,YAAY;MAChCP,mCAAC,CAAC,IAAI,CAAC,CAACgB,EAAE,CAAC,QAAQ,EAAE,YAAY;QAC7B,IAAIuD,OAAO,GAAGvE,mCAAC,CAAC,IAAI,CAAC,CAACoB,QAAQ,CAAC,mBAAmB,CAAC,CAACC,KAAK,EAAE;QAC3D,IAAIrB,mCAAC,CAAC,IAAI,CAAC,CAACwE,EAAE,CAAC,UAAU,CAAC,IAAI,CAAED,OAAO,CAACE,QAAQ,CAAC,WAAW,CAAC,EAAE;UAC3D;UACA;UACA;QACJ;QACAF,OAAO,CAACX,OAAO,CAAC,OAAO,EAAE,CAAC,SAAS,CAAC,CAAC;MACzC,CAAC,CAAC;IACN,CAAC,CAAC;IAEF5D,mCAAC,CAAC,eAAe,CAAC,CAACO,IAAI,CAAC,YAAY;MAChCP,mCAAC,CAAC,IAAI,CAAC,CAACgB,EAAE,CAAC,QAAQ,EAAE,YAAY;QAC7B,IAAI0D,OAAO,GAAG1E,mCAAC,CAAC,IAAI,CAAC,CAACiE,MAAM,EAAE,CAACA,MAAM,EAAE,CAAC7C,QAAQ,CAAC,YAAY,CAAC,CAACC,KAAK,EAAE;QACtE,IAAIsD,QAAQ,GAAG3E,mCAAC,CAAC,IAAI,CAAC,CAACiE,MAAM,EAAE,CAACA,MAAM,EAAE,CAAC7C,QAAQ,CAAC,WAAW,CAAC,CAACC,KAAK,EAAE;QACtE,IAAIrB,mCAAC,CAAC,IAAI,CAAC,CAACsB,GAAG,EAAE,KAAK,MAAM,EAAE;UAC1BoD,OAAO,CAAC9D,GAAG,CAAC,SAAS,EAAE,MAAM,CAAC;UAC9B+D,QAAQ,CAAC/D,GAAG,CAAC,SAAS,EAAE,WAAW,CAAC;QACxC,CAAC,MAAM,IAAIZ,mCAAC,CAAC,IAAI,CAAC,CAACsB,GAAG,EAAE,KAAK,eAAe,EAAE;UAC1CqD,QAAQ,CAAC/D,GAAG,CAAC,SAAS,EAAE,MAAM,CAAC;UAC/B8D,OAAO,CAAC9D,GAAG,CAAC,SAAS,EAAE,WAAW,CAAC;QACvC,CAAC,MAAM;UACH+D,QAAQ,CAAC/D,GAAG,CAAC,SAAS,EAAE,MAAM,CAAC;UAC/B8D,OAAO,CAAC9D,GAAG,CAAC,SAAS,EAAE,MAAM,CAAC;QAClC;MACJ,CAAC,CAAC;IACN,CAAC,CAAC;EACN;AACJ,CAAC,CAAC","sources":["webpack://phpmyadmin/external var \"jQuery\"","webpack://phpmyadmin/./js/src/database/multi_table_query.js"],"sourcesContent":["module.exports = jQuery;","import $ from 'jquery';\nimport { AJAX } from '../modules/ajax.js';\nimport { Functions } from '../modules/functions.js';\nimport { CommonParams } from '../modules/common.js';\nimport { ajaxShowMessage } from '../modules/ajax-message.js';\nimport { escapeBacktick } from '../modules/functions/escape.js';\n\n/**\n * @fileoverview    function used in QBE for DB\n * @name            Database Operations\n *\n * @requires    jQueryUI\n * @requires    js/database/query_generator.js\n */\n\n/**\n * js file for handling AJAX and other events in /database/multi-table-query\n */\n\n/**\n * Unbind all event handlers before tearing down a page\n */\nAJAX.registerTeardown('database/multi_table_query.js', function () {\n    $('.tableNameSelect').each(function () {\n        $(this).off('change');\n    });\n    $('#update_query_button').off('click');\n    $('#add_column_button').off('click');\n});\n\nAJAX.registerOnload('database/multi_table_query.js', function () {\n    var editor = Functions.getSqlEditor($('#MultiSqlquery'), {}, 'both');\n    $('.CodeMirror-line').css('text-align', 'left');\n    editor.setSize(-1, 50);\n\n    var columnCount = 3;\n    addNewColumnCallbacks();\n\n    $('#update_query_button').on('click', function () {\n        var columns = [];\n        var tableAliases = {};\n        $('.tableNameSelect').each(function () {\n            var $show = $(this).siblings('.show_col').first();\n            if ($(this).val() !== '' && $show.prop('checked')) {\n                var tableAlias = $(this).siblings('.table_alias').first().val();\n                var columnAlias = $(this).siblings('.col_alias').first().val();\n\n                if (tableAlias !== '') {\n                    columns.push([tableAlias, $(this).siblings('.columnNameSelect').first().val()]);\n                } else {\n                    columns.push([$(this).val(), $(this).siblings('.columnNameSelect').first().val()]);\n                }\n\n                columns[columns.length - 1].push(columnAlias);\n\n                if ($(this).val() in tableAliases) {\n                    if (! (tableAliases[$(this).val()].includes(tableAlias))) {\n                        tableAliases[$(this).val()].push(tableAlias);\n                    }\n                } else {\n                    tableAliases[$(this).val()] = [tableAlias];\n                }\n            }\n        });\n        if (Object.keys(tableAliases).length === 0) {\n            ajaxShowMessage('Nothing selected', false, 'error');\n            return;\n        }\n\n        var foreignKeys;\n        $.ajax({\n            type: 'GET',\n            async: false,\n            url: 'index.php?route=/database/multi-table-query/tables',\n            data: {\n                'server': sessionStorage.server,\n                'db': $('#db_name').val(),\n                'tables': Object.keys(tableAliases),\n                'ajax_request': '1',\n                'token': CommonParams.get('token')\n            },\n            success: function (response) {\n                foreignKeys = response.foreignKeyConstrains;\n            }\n        });\n\n        var query = 'SELECT ' + '`' + escapeBacktick(columns[0][0]) + '`.';\n        if (columns[0][1] === '*') {\n            query += '*';\n        } else {\n            query += '`' + escapeBacktick(columns[0][1]) + '`';\n        }\n        if (columns[0][2] !== '') {\n            query += ' AS `' + escapeBacktick(columns[0][2]) + '`';\n        }\n        for (var i = 1; i < columns.length; i++) {\n            query += ', `' + escapeBacktick(columns[i][0]) + '`.';\n            if (columns[i][1] === '*') {\n                query += '*';\n            } else {\n                query += '`' + escapeBacktick(columns[i][1]) + '`';\n            }\n            if (columns[i][2] !== '') {\n                query += ' AS `' + escapeBacktick(columns[i][2]) + '`';\n            }\n        }\n        query += '\\nFROM ';\n\n        query += window.generateFromBlock(tableAliases, foreignKeys);\n\n        var $criteriaColCount = $('.criteria_col:checked').length;\n        if ($criteriaColCount > 0) {\n            query += '\\nWHERE ';\n            query += window.generateWhereBlock();\n        }\n\n        query += ';';\n        editor.getDoc().setValue(query);\n    });\n\n    $('#submit_query').on('click', function () {\n        var query = editor.getDoc().getValue();\n        // Verifying that the query is not empty\n        if (query === '') {\n            ajaxShowMessage(window.Messages.strEmptyQuery, false, 'error');\n            return;\n        }\n        var data = {\n            'db': $('#db_name').val(),\n            'sql_query': query,\n            'ajax_request': '1',\n            'server': CommonParams.get('server'),\n            'token': CommonParams.get('token')\n        };\n        $.ajax({\n            type: 'POST',\n            url: 'index.php?route=/database/multi-table-query/query',\n            data: data,\n            success: function (data) {\n                var $resultsDom = $(data.message);\n                $resultsDom.find('.ajax:not(.pageselector)').each(function () {\n                    $(this).on('click', function (event) {\n                        event.preventDefault();\n                    });\n                });\n                $resultsDom.find('.autosubmit, .pageselector, .showAllRows, .filter_rows').each(function () {\n                    $(this).on('change click select focus', function (event) {\n                        event.preventDefault();\n                    });\n                });\n                $('#sql_results').html($resultsDom);\n                $('#slide-handle').trigger('click');// Collapse search criteria area\n            }\n        });\n    });\n\n    $('#add_column_button').on('click', function () {\n        columnCount++;\n        var $newColumnDom = $($('#new_column_layout').html()).clone();\n        $newColumnDom.find('.jsCriteriaButton').first().attr('data-bs-target', '#criteriaOptionsExtra' + columnCount.toString());\n        $newColumnDom.find('.jsCriteriaButton').first().attr('aria-controls', 'criteriaOptionsExtra' + columnCount.toString());\n        $newColumnDom.find('.jsCriteriaOptions').first().attr('id', 'criteriaOptionsExtra' + columnCount.toString());\n        $('#add_column_button').parent().before($newColumnDom);\n        addNewColumnCallbacks();\n    });\n\n    function addNewColumnCallbacks () {\n        $('.tableNameSelect').each(function () {\n            $(this).on('change', function () {\n                var $sibs = $(this).siblings('.columnNameSelect');\n                if ($sibs.length === 0) {\n                    $sibs = $(this).parent().parent().find('.columnNameSelect');\n                }\n                $sibs.first().html($('#' + $(this).find(':selected').data('hash')).html());\n            });\n        });\n\n        $('.jsRemoveColumn').each(function () {\n            $(this).on('click', function () {\n                $(this).parent().remove();\n            });\n        });\n\n        $('.jsCriteriaButton').each(function () {\n            $(this).on('click', function (event, from) {\n                if (from === null) {\n                    var $checkbox = $(this).siblings('.criteria_col').first();\n                    $checkbox.prop('checked', ! $checkbox.prop('checked'));\n                }\n                var $criteriaColCount = $('.criteria_col:checked').length;\n                if ($criteriaColCount > 1) {\n                    $(this).siblings('.jsCriteriaOptions').first().find('.logical_operator').first().css('display', 'table-row');\n                }\n            });\n        });\n\n        $('.criteria_col').each(function () {\n            $(this).on('change', function () {\n                var $anchor = $(this).siblings('.jsCriteriaButton').first();\n                if ($(this).is(':checked') && ! $anchor.hasClass('collapsed')) {\n                    // Do not collapse on checkbox tick as it does not make sense\n                    // The user has it open and wants to tick the box\n                    return;\n                }\n                $anchor.trigger('click', ['Trigger']);\n            });\n        });\n\n        $('.criteria_rhs').each(function () {\n            $(this).on('change', function () {\n                var $rhsCol = $(this).parent().parent().siblings('.rhs_table').first();\n                var $rhsText = $(this).parent().parent().siblings('.rhs_text').first();\n                if ($(this).val() === 'text') {\n                    $rhsCol.css('display', 'none');\n                    $rhsText.css('display', 'table-row');\n                } else if ($(this).val() === 'anotherColumn') {\n                    $rhsText.css('display', 'none');\n                    $rhsCol.css('display', 'table-row');\n                } else {\n                    $rhsText.css('display', 'none');\n                    $rhsCol.css('display', 'none');\n                }\n            });\n        });\n    }\n});\n"],"names":["$","AJAX","Functions","CommonParams","ajaxShowMessage","escapeBacktick","registerTeardown","each","off","registerOnload","editor","getSqlEditor","css","setSize","columnCount","addNewColumnCallbacks","on","columns","tableAliases","$show","siblings","first","val","prop","tableAlias","columnAlias","push","length","includes","Object","keys","foreignKeys","ajax","type","async","url","data","sessionStorage","server","get","success","response","foreignKeyConstrains","query","i","window","generateFromBlock","$criteriaColCount","generateWhereBlock","getDoc","setValue","getValue","Messages","strEmptyQuery","$resultsDom","message","find","event","preventDefault","html","trigger","$newColumnDom","clone","attr","toString","parent","before","$sibs","remove","from","$checkbox","$anchor","is","hasClass","$rhsCol","$rhsText"],"sourceRoot":""}