{"version":3,"file":"database/multi_table_query.js","mappings":"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","sources":["webpack://phpmyadmin/external var \"jQuery\"","webpack://phpmyadmin/./js/src/database/multi_table_query.js"],"sourcesContent":["module.exports = jQuery;","import $ from 'jquery';\nimport { AJAX } from '../modules/ajax.js';\nimport { Functions } from '../modules/functions.js';\nimport { CommonParams } from '../modules/common.js';\nimport { ajaxShowMessage } from '../modules/ajax-message.js';\nimport { escapeBacktick } from '../modules/functions/escape.js';\n\n/**\n * @fileoverview    function used in QBE for DB\n * @name            Database Operations\n *\n * @requires    jQueryUI\n * @requires    js/database/query_generator.js\n */\n\n/**\n * js file for handling AJAX and other events in /database/multi-table-query\n */\n\n/**\n * Unbind all event handlers before tearing down a page\n */\nAJAX.registerTeardown('database/multi_table_query.js', function () {\n    $('.tableNameSelect').each(function () {\n        $(this).off('change');\n    });\n    $('#update_query_button').off('click');\n    $('#add_column_button').off('click');\n});\n\nAJAX.registerOnload('database/multi_table_query.js', function () {\n    var editor = Functions.getSqlEditor($('#MultiSqlquery'), {}, 'both');\n    $('.CodeMirror-line').css('text-align', 'left');\n    editor.setSize(-1, 50);\n\n    var columnCount = 3;\n    addNewColumnCallbacks();\n\n    $('#update_query_button').on('click', function () {\n        var columns = [];\n        var tableAliases = {};\n        $('.tableNameSelect').each(function () {\n            var $show = $(this).siblings('.show_col').first();\n            if ($(this).val() !== '' && $show.prop('checked')) {\n                var tableAlias = $(this).siblings('.table_alias').first().val();\n                var columnAlias = $(this).siblings('.col_alias').first().val();\n\n                if (tableAlias !== '') {\n                    columns.push([tableAlias, $(this).siblings('.columnNameSelect').first().val()]);\n                } else {\n                    columns.push([$(this).val(), $(this).siblings('.columnNameSelect').first().val()]);\n                }\n\n                columns[columns.length - 1].push(columnAlias);\n\n                if ($(this).val() in tableAliases) {\n                    if (! (tableAliases[$(this).val()].includes(tableAlias))) {\n                        tableAliases[$(this).val()].push(tableAlias);\n                    }\n                } else {\n                    tableAliases[$(this).val()] = [tableAlias];\n                }\n            }\n        });\n        if (Object.keys(tableAliases).length === 0) {\n            ajaxShowMessage('Nothing selected', false, 'error');\n            return;\n        }\n\n        var foreignKeys;\n        $.ajax({\n            type: 'GET',\n            async: false,\n            url: 'index.php?route=/database/multi-table-query/tables',\n            data: {\n                'server': sessionStorage.server,\n                'db': $('#db_name').val(),\n                'tables': Object.keys(tableAliases),\n                'ajax_request': '1',\n                'token': CommonParams.get('token')\n            },\n            success: function (response) {\n                foreignKeys = response.foreignKeyConstrains;\n            }\n        });\n\n        var query = 'SELECT ' + '`' + escapeBacktick(columns[0][0]) + '`.';\n        if (columns[0][1] === '*') {\n            query += '*';\n        } else {\n            query += '`' + escapeBacktick(columns[0][1]) + '`';\n        }\n        if (columns[0][2] !== '') {\n            query += ' AS `' + escapeBacktick(columns[0][2]) + '`';\n        }\n        for (var i = 1; i < columns.length; i++) {\n            query += ', `' + escapeBacktick(columns[i][0]) + '`.';\n            if (columns[i][1] === '*') {\n                query += '*';\n            } else {\n                query += '`' + escapeBacktick(columns[i][1]) + '`';\n            }\n            if (columns[i][2] !== '') {\n                query += ' AS `' + escapeBacktick(columns[i][2]) + '`';\n            }\n        }\n        query += '\\nFROM ';\n\n        query += window.generateFromBlock(tableAliases, foreignKeys);\n\n        var $criteriaColCount = $('.criteria_col:checked').length;\n        if ($criteriaColCount > 0) {\n            query += '\\nWHERE ';\n            query += window.generateWhereBlock();\n        }\n\n        query += ';';\n        editor.getDoc().setValue(query);\n    });\n\n    $('#submit_query').on('click', function () {\n        var query = editor.getDoc().getValue();\n        // Verifying that the query is not empty\n        if (query === '') {\n            ajaxShowMessage(window.Messages.strEmptyQuery, false, 'error');\n            return;\n        }\n        var data = {\n            'db': $('#db_name').val(),\n            'sql_query': query,\n            'ajax_request': '1',\n            'server': CommonParams.get('server'),\n            'token': CommonParams.get('token')\n        };\n        $.ajax({\n            type: 'POST',\n            url: 'index.php?route=/database/multi-table-query/query',\n            data: data,\n            success: function (data) {\n                var $resultsDom = $(data.message);\n                $resultsDom.find('.ajax:not(.pageselector)').each(function () {\n                    $(this).on('click', function (event) {\n                        event.preventDefault();\n                    });\n                });\n                $resultsDom.find('.autosubmit, .pageselector, .showAllRows, .filter_rows').each(function () {\n                    $(this).on('change click select focus', function (event) {\n                        event.preventDefault();\n                    });\n                });\n                $('#sql_results').html($resultsDom);\n                $('#slide-handle').trigger('click');// Collapse search criteria area\n            }\n        });\n    });\n\n    $('#add_column_button').on('click', function () {\n        columnCount++;\n        var $newColumnDom = $($('#new_column_layout').html()).clone();\n        $newColumnDom.find('.jsCriteriaButton').first().attr('data-bs-target', '#criteriaOptionsExtra' + columnCount.toString());\n        $newColumnDom.find('.jsCriteriaButton').first().attr('aria-controls', 'criteriaOptionsExtra' + columnCount.toString());\n        $newColumnDom.find('.jsCriteriaOptions').first().attr('id', 'criteriaOptionsExtra' + columnCount.toString());\n        $('#add_column_button').parent().before($newColumnDom);\n        addNewColumnCallbacks();\n    });\n\n    function addNewColumnCallbacks () {\n        $('.tableNameSelect').each(function () {\n            $(this).on('change', function () {\n                var $sibs = $(this).siblings('.columnNameSelect');\n                if ($sibs.length === 0) {\n                    $sibs = $(this).parent().parent().find('.columnNameSelect');\n                }\n                $sibs.first().html($('#' + $(this).find(':selected').data('hash')).html());\n            });\n        });\n\n        $('.jsRemoveColumn').each(function () {\n            $(this).on('click', function () {\n                $(this).parent().remove();\n            });\n        });\n\n        $('.jsCriteriaButton').each(function () {\n            $(this).on('click', function (event, from) {\n                if (from === null) {\n                    var $checkbox = $(this).siblings('.criteria_col').first();\n                    $checkbox.prop('checked', ! $checkbox.prop('checked'));\n                }\n                var $criteriaColCount = $('.criteria_col:checked').length;\n                if ($criteriaColCount > 1) {\n                    $(this).siblings('.jsCriteriaOptions').first().find('.logical_operator').first().css('display', 'table-row');\n                }\n            });\n        });\n\n        $('.criteria_col').each(function () {\n            $(this).on('change', function () {\n                var $anchor = $(this).siblings('.jsCriteriaButton').first();\n                if ($(this).is(':checked') && ! $anchor.hasClass('collapsed')) {\n                    // Do not collapse on checkbox tick as it does not make sense\n                    // The user has it open and wants to tick the box\n                    return;\n                }\n                $anchor.trigger('click', ['Trigger']);\n            });\n        });\n\n        $('.criteria_rhs').each(function () {\n            $(this).on('change', function () {\n                var $rhsCol = $(this).parent().parent().siblings('.rhs_table').first();\n                var $rhsText = $(this).parent().parent().siblings('.rhs_text').first();\n                if ($(this).val() === 'text') {\n                    $rhsCol.css('display', 'none');\n                    $rhsText.css('display', 'table-row');\n                } else if ($(this).val() === 'anotherColumn') {\n                    $rhsText.css('display', 'none');\n                    $rhsCol.css('display', 'table-row');\n                } else {\n                    $rhsText.css('display', 'none');\n                    $rhsCol.css('display', 'none');\n                }\n            });\n        });\n    }\n});\n"],"names":["$","AJAX","Functions","CommonParams","ajaxShowMessage","escapeBacktick","registerTeardown","each","off","registerOnload","editor","getSqlEditor","css","setSize","columnCount","addNewColumnCallbacks","on","columns","tableAliases","$show","siblings","first","val","prop","tableAlias","columnAlias","push","length","includes","Object","keys","foreignKeys","ajax","type","async","url","data","sessionStorage","server","get","success","response","foreignKeyConstrains","query","i","window","generateFromBlock","$criteriaColCount","generateWhereBlock","getDoc","setValue","getValue","Messages","strEmptyQuery","$resultsDom","message","find","event","preventDefault","html","trigger","$newColumnDom","clone","attr","toString","parent","before","$sibs","remove","from","$checkbox","$anchor","is","hasClass","$rhsCol","$rhsText"],"sourceRoot":""}