{"version":3,"file":"database/multi_table_query.js","mappings":"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","sources":["webpack://phpmyadmin/external var \"jQuery\"","webpack://phpmyadmin/./js/src/database/multi_table_query.js"],"sourcesContent":["module.exports = jQuery;","import $ from 'jquery';\nimport { AJAX } from '../modules/ajax.js';\nimport { Functions } from '../modules/functions.js';\nimport { CommonParams } from '../modules/common.js';\n\n/**\n * @fileoverview    function used in QBE for DB\n * @name            Database Operations\n *\n * @requires    jQueryUI\n * @requires    js/database/query_generator.js\n */\n\n/**\n * js file for handling AJAX and other events in /database/multi-table-query\n */\n\n/**\n * Unbind all event handlers before tearing down a page\n */\nAJAX.registerTeardown('database/multi_table_query.js', function () {\n    $('.tableNameSelect').each(function () {\n        $(this).off('change');\n    });\n    $('#update_query_button').off('click');\n    $('#add_column_button').off('click');\n});\n\nAJAX.registerOnload('database/multi_table_query.js', function () {\n    var editor = Functions.getSqlEditor($('#MultiSqlquery'), {}, 'both');\n    $('.CodeMirror-line').css('text-align', 'left');\n    editor.setSize(-1, 50);\n\n    var columnCount = 3;\n    addNewColumnCallbacks();\n\n    $('#update_query_button').on('click', function () {\n        var columns = [];\n        var tableAliases = {};\n        $('.tableNameSelect').each(function () {\n            var $show = $(this).siblings('.show_col').first();\n            if ($(this).val() !== '' && $show.prop('checked')) {\n                var tableAlias = $(this).siblings('.table_alias').first().val();\n                var columnAlias = $(this).siblings('.col_alias').first().val();\n\n                if (tableAlias !== '') {\n                    columns.push([tableAlias, $(this).siblings('.columnNameSelect').first().val()]);\n                } else {\n                    columns.push([$(this).val(), $(this).siblings('.columnNameSelect').first().val()]);\n                }\n\n                columns[columns.length - 1].push(columnAlias);\n\n                if ($(this).val() in tableAliases) {\n                    if (!(tableAliases[$(this).val()].includes(tableAlias))) {\n                        tableAliases[$(this).val()].push(tableAlias);\n                    }\n                } else {\n                    tableAliases[$(this).val()] = [tableAlias];\n                }\n            }\n        });\n        if (Object.keys(tableAliases).length === 0) {\n            Functions.ajaxShowMessage('Nothing selected', false, 'error');\n            return;\n        }\n\n        var foreignKeys;\n        $.ajax({\n            type: 'GET',\n            async: false,\n            url: 'index.php?route=/database/multi-table-query/tables',\n            data: {\n                'server': sessionStorage.server,\n                'db': $('#db_name').val(),\n                'tables': Object.keys(tableAliases),\n                'ajax_request': '1',\n                'token': CommonParams.get('token')\n            },\n            success: function (response) {\n                foreignKeys = response.foreignKeyConstrains;\n            }\n        });\n\n        var query = 'SELECT ' + '`' + Functions.escapeBacktick(columns[0][0]) + '`.';\n        if (columns[0][1] === '*') {\n            query += '*';\n        } else {\n            query += '`' + Functions.escapeBacktick(columns[0][1]) + '`';\n        }\n        if (columns[0][2] !== '') {\n            query += ' AS `' + Functions.escapeBacktick(columns[0][2]) + '`';\n        }\n        for (var i = 1; i < columns.length; i++) {\n            query += ', `' + Functions.escapeBacktick(columns[i][0]) + '`.';\n            if (columns[i][1] === '*') {\n                query += '*';\n            } else {\n                query += '`' + Functions.escapeBacktick(columns[i][1]) + '`';\n            }\n            if (columns[i][2] !== '') {\n                query += ' AS `' + Functions.escapeBacktick(columns[i][2]) + '`';\n            }\n        }\n        query += '\\nFROM ';\n\n        query += window.generateFromBlock(tableAliases, foreignKeys);\n\n        var $criteriaColCount = $('.criteria_col:checked').length;\n        if ($criteriaColCount > 0) {\n            query += '\\nWHERE ';\n            query += window.generateWhereBlock();\n        }\n\n        query += ';';\n        editor.getDoc().setValue(query);\n    });\n\n    $('#submit_query').on('click', function () {\n        var query = editor.getDoc().getValue();\n        // Verifying that the query is not empty\n        if (query === '') {\n            Functions.ajaxShowMessage(window.Messages.strEmptyQuery, false, 'error');\n            return;\n        }\n        var data = {\n            'db': $('#db_name').val(),\n            'sql_query': query,\n            'ajax_request': '1',\n            'server': CommonParams.get('server'),\n            'token': CommonParams.get('token')\n        };\n        $.ajax({\n            type: 'POST',\n            url: 'index.php?route=/database/multi-table-query/query',\n            data: data,\n            success: function (data) {\n                var $resultsDom = $(data.message);\n                $resultsDom.find('.ajax:not(.pageselector)').each(function () {\n                    $(this).on('click', function (event) {\n                        event.preventDefault();\n                    });\n                });\n                $resultsDom.find('.autosubmit, .pageselector, .showAllRows, .filter_rows').each(function () {\n                    $(this).on('change click select focus', function (event) {\n                        event.preventDefault();\n                    });\n                });\n                $('#sql_results').html($resultsDom);\n                $('#slide-handle').trigger('click');// Collapse search criteria area\n            }\n        });\n    });\n\n    $('#add_column_button').on('click', function () {\n        columnCount++;\n        var $newColumnDom = $($('#new_column_layout').html()).clone();\n        $newColumnDom.find('.jsCriteriaButton').first().attr('data-bs-target', '#criteriaOptionsExtra' + columnCount.toString());\n        $newColumnDom.find('.jsCriteriaButton').first().attr('aria-controls', 'criteriaOptionsExtra' + columnCount.toString());\n        $newColumnDom.find('.jsCriteriaOptions').first().attr('id', 'criteriaOptionsExtra' + columnCount.toString());\n        $('#add_column_button').parent().before($newColumnDom);\n        addNewColumnCallbacks();\n    });\n\n    function addNewColumnCallbacks () {\n        $('.tableNameSelect').each(function () {\n            $(this).on('change', function () {\n                var $sibs = $(this).siblings('.columnNameSelect');\n                if ($sibs.length === 0) {\n                    $sibs = $(this).parent().parent().find('.columnNameSelect');\n                }\n                $sibs.first().html($('#' + $(this).find(':selected').data('hash')).html());\n            });\n        });\n\n        $('.jsRemoveColumn').each(function () {\n            $(this).on('click', function () {\n                $(this).parent().remove();\n            });\n        });\n\n        $('.jsCriteriaButton').each(function () {\n            $(this).on('click', function (event, from) {\n                if (from === null) {\n                    var $checkbox = $(this).siblings('.criteria_col').first();\n                    $checkbox.prop('checked', !$checkbox.prop('checked'));\n                }\n                var $criteriaColCount = $('.criteria_col:checked').length;\n                if ($criteriaColCount > 1) {\n                    $(this).siblings('.jsCriteriaOptions').first().find('.logical_operator').first().css('display','table-row');\n                }\n            });\n        });\n\n        $('.criteria_col').each(function () {\n            $(this).on('change', function () {\n                var $anchor = $(this).siblings('.jsCriteriaButton').first();\n                if ($(this).is(':checked') && ! $anchor.hasClass('collapsed')) {\n                    // Do not collapse on checkbox tick as it does not make sense\n                    // The user has it open and wants to tick the box\n                    return;\n                }\n                $anchor.trigger('click', ['Trigger']);\n            });\n        });\n\n        $('.criteria_rhs').each(function () {\n            $(this).on('change', function () {\n                var $rhsCol = $(this).parent().parent().siblings('.rhs_table').first();\n                var $rhsText = $(this).parent().parent().siblings('.rhs_text').first();\n                if ($(this).val() === 'text') {\n                    $rhsCol.css('display', 'none');\n                    $rhsText.css('display', 'table-row');\n                } else if ($(this).val() === 'anotherColumn') {\n                    $rhsText.css('display', 'none');\n                    $rhsCol.css('display', 'table-row');\n                } else {\n                    $rhsText.css('display', 'none');\n                    $rhsCol.css('display', 'none');\n                }\n            });\n        });\n    }\n});\n"],"names":["$","AJAX","Functions","CommonParams","registerTeardown","each","off","registerOnload","editor","getSqlEditor","css","setSize","columnCount","addNewColumnCallbacks","on","columns","tableAliases","$show","siblings","first","val","prop","tableAlias","columnAlias","push","length","includes","Object","keys","ajaxShowMessage","foreignKeys","ajax","type","async","url","data","sessionStorage","server","get","success","response","foreignKeyConstrains","query","escapeBacktick","i","window","generateFromBlock","$criteriaColCount","generateWhereBlock","getDoc","setValue","getValue","Messages","strEmptyQuery","$resultsDom","message","find","event","preventDefault","html","trigger","$newColumnDom","clone","attr","toString","parent","before","$sibs","remove","from","$checkbox","$anchor","is","hasClass","$rhsCol","$rhsText"],"sourceRoot":""}