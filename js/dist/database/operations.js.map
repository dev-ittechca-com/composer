{"version":3,"file":"database/operations.js","mappings":"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","sources":["webpack://phpmyadmin/external var \"jQuery\"","webpack://phpmyadmin/./js/src/database/operations.js"],"sourcesContent":["module.exports = jQuery;","import $ from 'jquery';\n\n/* global Navigation */\n\n/**\n * @fileoverview    function used in server privilege pages\n * @name            Database Operations\n *\n * @requires    jQuery\n * @requires    jQueryUI\n * @requires    js/functions.js\n *\n */\n\n/**\n * Ajax event handlers here for /database/operations\n *\n * Actions Ajaxified here:\n * Rename Database\n * Copy Database\n * Change Charset\n * Drop Database\n */\n\n/**\n * Unbind all event handlers before tearing down a page\n */\nwindow.AJAX.registerTeardown('database/operations.js', function () {\n    $(document).off('submit', '#rename_db_form.ajax');\n    $(document).off('submit', '#copy_db_form.ajax');\n    $(document).off('submit', '#change_db_charset_form.ajax');\n    $(document).off('click', '#drop_db_anchor.ajax');\n});\n\nwindow.AJAX.registerOnload('database/operations.js', function () {\n    /**\n     * Ajax event handlers for 'Rename Database'\n     */\n    $(document).on('submit', '#rename_db_form.ajax', function (event) {\n        event.preventDefault();\n\n        if (Functions.emptyCheckTheField(this, 'newname')) {\n            Functions.ajaxShowMessage(window.Messages.strFormEmpty, false, 'error');\n            return false;\n        }\n\n        var oldDbName = window.CommonParams.get('db');\n        var newDbName = $('#new_db_name').val();\n\n        if (newDbName === oldDbName) {\n            Functions.ajaxShowMessage(window.Messages.strDatabaseRenameToSameName, false, 'error');\n            return false;\n        }\n\n        var $form = $(this);\n\n        var question = Functions.escapeHtml('CREATE DATABASE ' + newDbName + ' / DROP DATABASE ' + oldDbName);\n\n        Functions.prepareForAjaxRequest($form);\n\n        $form.confirm(question, $form.attr('action'), function (url) {\n            Functions.ajaxShowMessage(window.Messages.strRenamingDatabases, false);\n            $.post(url, $('#rename_db_form').serialize() + window.CommonParams.get('arg_separator') + 'is_js_confirmed=1', function (data) {\n                if (typeof data !== 'undefined' && data.success === true) {\n                    Functions.ajaxShowMessage(data.message);\n                    window.CommonParams.set('db', data.newname);\n\n                    Navigation.reload(function () {\n                        $('#pma_navigation_tree')\n                            .find('a:not(\\'.expander\\')')\n                            .each(function () {\n                                var $thisAnchor = $(this);\n                                if ($thisAnchor.text() === data.newname) {\n                                    // simulate a click on the new db name\n                                    // in navigation\n                                    $thisAnchor.trigger('click');\n                                }\n                            });\n                    });\n                } else {\n                    Functions.ajaxShowMessage(data.error, false);\n                }\n            }); // end $.post()\n        });\n    }); // end Rename Database\n\n    /**\n     * Ajax Event Handler for 'Copy Database'\n     */\n    $(document).on('submit', '#copy_db_form.ajax', function (event) {\n        event.preventDefault();\n\n        if (Functions.emptyCheckTheField(this, 'newname')) {\n            Functions.ajaxShowMessage(window.Messages.strFormEmpty, false, 'error');\n            return false;\n        }\n\n        Functions.ajaxShowMessage(window.Messages.strCopyingDatabase, false);\n        var $form = $(this);\n        Functions.prepareForAjaxRequest($form);\n        $.post($form.attr('action'), $form.serialize(), function (data) {\n            // use messages that stay on screen\n            $('.alert-success, .alert-danger').fadeOut();\n            if (typeof data !== 'undefined' && data.success === true) {\n                if ($('#checkbox_switch').is(':checked')) {\n                    window.CommonParams.set('db', data.newname);\n                    window.CommonActions.refreshMain(false, function () {\n                        Functions.ajaxShowMessage(data.message);\n                    });\n                } else {\n                    window.CommonParams.set('db', data.db);\n                    Functions.ajaxShowMessage(data.message);\n                }\n                Navigation.reload();\n            } else {\n                Functions.ajaxShowMessage(data.error, false);\n            }\n        }); // end $.post()\n    }); // end copy database\n\n    /**\n     * Change tables columns visible only if change tables is checked\n     */\n    $('#span_change_all_tables_columns_collations').hide();\n    $('#checkbox_change_all_tables_collations').on('click', function () {\n        $('#span_change_all_tables_columns_collations').toggle();\n    });\n\n    /**\n     * Ajax Event handler for 'Change Charset' of the database\n     */\n    $(document).on('submit', '#change_db_charset_form.ajax', function (event) {\n        event.preventDefault();\n        var $form = $(this);\n        Functions.prepareForAjaxRequest($form);\n        Functions.ajaxShowMessage(window.Messages.strChangingCharset);\n        $.post($form.attr('action'), $form.serialize(), function (data) {\n            if (typeof data !== 'undefined' && data.success === true) {\n                Functions.ajaxShowMessage(data.message);\n            } else {\n                Functions.ajaxShowMessage(data.error, false);\n            }\n        }); // end $.post()\n    }); // end change charset\n\n    /**\n     * Ajax event handlers for Drop Database\n     */\n    $(document).on('click', '#drop_db_anchor.ajax', function (event) {\n        event.preventDefault();\n        var $link = $(this);\n        /**\n         * @var {String} question String containing the question to be asked for confirmation\n         */\n        var question = window.Messages.strDropDatabaseStrongWarning + ' ';\n        question += Functions.sprintf(\n            window.Messages.strDoYouReally,\n            'DROP DATABASE `' + Functions.escapeHtml(window.CommonParams.get('db') + '`')\n        );\n        var params = Functions.getJsConfirmCommonParam(this, $link.getPostData());\n\n        $(this).confirm(question, $(this).attr('href'), function (url) {\n            Functions.ajaxShowMessage(window.Messages.strProcessingRequest);\n            $.post(url, params, function (data) {\n                if (typeof data !== 'undefined' && data.success) {\n                    // Database deleted successfully, refresh both the frames\n                    Navigation.reload();\n                    window.CommonParams.set('db', '');\n                    window.CommonActions.refreshMain(\n                        'index.php?route=/server/databases',\n                        function () {\n                            Functions.ajaxShowMessage(data.message);\n                        }\n                    );\n                } else {\n                    Functions.ajaxShowMessage(data.error, false);\n                }\n            });\n        });\n    });\n});\n"],"names":["$","window","AJAX","registerTeardown","document","off","registerOnload","on","event","preventDefault","Functions","emptyCheckTheField","ajaxShowMessage","Messages","strFormEmpty","oldDbName","CommonParams","get","newDbName","val","strDatabaseRenameToSameName","$form","question","escapeHtml","prepareForAjaxRequest","confirm","attr","url","strRenamingDatabases","post","serialize","data","success","message","set","newname","Navigation","reload","find","each","$thisAnchor","text","trigger","error","strCopyingDatabase","fadeOut","is","CommonActions","refreshMain","db","hide","toggle","strChangingCharset","$link","strDropDatabaseStrongWarning","sprintf","strDoYouReally","params","getJsConfirmCommonParam","getPostData","strProcessingRequest"],"sourceRoot":""}