{"version":3,"file":"database/operations.js","mappings":"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","sources":["webpack://phpmyadmin/./js/src/database/operations.js"],"sourcesContent":["/**\n * @fileoverview    function used in server privilege pages\n * @name            Database Operations\n *\n * @requires    jQuery\n * @requires    jQueryUI\n * @requires    js/functions.js\n *\n */\n\n/**\n * Ajax event handlers here for /database/operations\n *\n * Actions Ajaxified here:\n * Rename Database\n * Copy Database\n * Change Charset\n * Drop Database\n */\n\n/**\n * Unbind all event handlers before tearing down a page\n */\nwindow.AJAX.registerTeardown('database/operations.js', function () {\n    $(document).off('submit', '#rename_db_form.ajax');\n    $(document).off('submit', '#copy_db_form.ajax');\n    $(document).off('submit', '#change_db_charset_form.ajax');\n    $(document).off('click', '#drop_db_anchor.ajax');\n});\n\nwindow.AJAX.registerOnload('database/operations.js', function () {\n    /**\n     * Ajax event handlers for 'Rename Database'\n     */\n    $(document).on('submit', '#rename_db_form.ajax', function (event) {\n        event.preventDefault();\n\n        if (Functions.emptyCheckTheField(this, 'newname')) {\n            Functions.ajaxShowMessage(Messages.strFormEmpty, false, 'error');\n            return false;\n        }\n\n        var oldDbName = window.CommonParams.get('db');\n        var newDbName = $('#new_db_name').val();\n\n        if (newDbName === oldDbName) {\n            Functions.ajaxShowMessage(Messages.strDatabaseRenameToSameName, false, 'error');\n            return false;\n        }\n\n        var $form = $(this);\n\n        var question = Functions.escapeHtml('CREATE DATABASE ' + newDbName + ' / DROP DATABASE ' + oldDbName);\n\n        Functions.prepareForAjaxRequest($form);\n\n        $form.confirm(question, $form.attr('action'), function (url) {\n            Functions.ajaxShowMessage(Messages.strRenamingDatabases, false);\n            $.post(url, $('#rename_db_form').serialize() + window.CommonParams.get('arg_separator') + 'is_js_confirmed=1', function (data) {\n                if (typeof data !== 'undefined' && data.success === true) {\n                    Functions.ajaxShowMessage(data.message);\n                    window.CommonParams.set('db', data.newname);\n\n                    Navigation.reload(function () {\n                        $('#pma_navigation_tree')\n                            .find('a:not(\\'.expander\\')')\n                            .each(function () {\n                                var $thisAnchor = $(this);\n                                if ($thisAnchor.text() === data.newname) {\n                                    // simulate a click on the new db name\n                                    // in navigation\n                                    $thisAnchor.trigger('click');\n                                }\n                            });\n                    });\n                } else {\n                    Functions.ajaxShowMessage(data.error, false);\n                }\n            }); // end $.post()\n        });\n    }); // end Rename Database\n\n    /**\n     * Ajax Event Handler for 'Copy Database'\n     */\n    $(document).on('submit', '#copy_db_form.ajax', function (event) {\n        event.preventDefault();\n\n        if (Functions.emptyCheckTheField(this, 'newname')) {\n            Functions.ajaxShowMessage(Messages.strFormEmpty, false, 'error');\n            return false;\n        }\n\n        Functions.ajaxShowMessage(Messages.strCopyingDatabase, false);\n        var $form = $(this);\n        Functions.prepareForAjaxRequest($form);\n        $.post($form.attr('action'), $form.serialize(), function (data) {\n            // use messages that stay on screen\n            $('.alert-success, .alert-danger').fadeOut();\n            if (typeof data !== 'undefined' && data.success === true) {\n                if ($('#checkbox_switch').is(':checked')) {\n                    window.CommonParams.set('db', data.newname);\n                    window.CommonActions.refreshMain(false, function () {\n                        Functions.ajaxShowMessage(data.message);\n                    });\n                } else {\n                    window.CommonParams.set('db', data.db);\n                    Functions.ajaxShowMessage(data.message);\n                }\n                Navigation.reload();\n            } else {\n                Functions.ajaxShowMessage(data.error, false);\n            }\n        }); // end $.post()\n    }); // end copy database\n\n    /**\n     * Change tables columns visible only if change tables is checked\n     */\n    $('#span_change_all_tables_columns_collations').hide();\n    $('#checkbox_change_all_tables_collations').on('click', function () {\n        $('#span_change_all_tables_columns_collations').toggle();\n    });\n\n    /**\n     * Ajax Event handler for 'Change Charset' of the database\n     */\n    $(document).on('submit', '#change_db_charset_form.ajax', function (event) {\n        event.preventDefault();\n        var $form = $(this);\n        Functions.prepareForAjaxRequest($form);\n        Functions.ajaxShowMessage(Messages.strChangingCharset);\n        $.post($form.attr('action'), $form.serialize(), function (data) {\n            if (typeof data !== 'undefined' && data.success === true) {\n                Functions.ajaxShowMessage(data.message);\n            } else {\n                Functions.ajaxShowMessage(data.error, false);\n            }\n        }); // end $.post()\n    }); // end change charset\n\n    /**\n     * Ajax event handlers for Drop Database\n     */\n    $(document).on('click', '#drop_db_anchor.ajax', function (event) {\n        event.preventDefault();\n        var $link = $(this);\n        /**\n         * @var {String} question String containing the question to be asked for confirmation\n         */\n        var question = Messages.strDropDatabaseStrongWarning + ' ';\n        question += Functions.sprintf(\n            Messages.strDoYouReally,\n            'DROP DATABASE `' + Functions.escapeHtml(window.CommonParams.get('db') + '`')\n        );\n        var params = Functions.getJsConfirmCommonParam(this, $link.getPostData());\n\n        $(this).confirm(question, $(this).attr('href'), function (url) {\n            Functions.ajaxShowMessage(Messages.strProcessingRequest);\n            $.post(url, params, function (data) {\n                if (typeof data !== 'undefined' && data.success) {\n                    // Database deleted successfully, refresh both the frames\n                    Navigation.reload();\n                    window.CommonParams.set('db', '');\n                    window.CommonActions.refreshMain(\n                        'index.php?route=/server/databases',\n                        function () {\n                            Functions.ajaxShowMessage(data.message);\n                        }\n                    );\n                } else {\n                    Functions.ajaxShowMessage(data.error, false);\n                }\n            });\n        });\n    });\n});\n"],"names":["window","AJAX","registerTeardown","$","document","off","registerOnload","on","event","preventDefault","Functions","emptyCheckTheField","ajaxShowMessage","Messages","strFormEmpty","oldDbName","CommonParams","get","newDbName","val","strDatabaseRenameToSameName","$form","question","escapeHtml","prepareForAjaxRequest","confirm","attr","url","strRenamingDatabases","post","serialize","data","success","message","set","newname","Navigation","reload","find","each","$thisAnchor","text","trigger","error","strCopyingDatabase","fadeOut","is","CommonActions","refreshMain","db","hide","toggle","strChangingCharset","$link","strDropDatabaseStrongWarning","sprintf","strDoYouReally","params","getJsConfirmCommonParam","getPostData","strProcessingRequest"],"sourceRoot":""}