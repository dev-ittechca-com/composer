{"version":3,"file":"database/operations.js","mappings":"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","sources":["webpack://phpmyadmin/external var \"jQuery\"","webpack://phpmyadmin/./js/src/database/operations.js"],"sourcesContent":["module.exports = jQuery;","import $ from 'jquery';\nimport { AJAX } from '../modules/ajax.js';\nimport { Functions } from '../modules/functions.js';\nimport { Navigation } from '../modules/navigation.js';\nimport { CommonActions, CommonParams } from '../modules/common.js';\n\n/**\n * @fileoverview    function used in server privilege pages\n * @name            Database Operations\n *\n * @requires    jQueryUI\n */\n\n/**\n * Ajax event handlers here for /database/operations\n *\n * Actions Ajaxified here:\n * Rename Database\n * Copy Database\n * Change Charset\n * Drop Database\n */\n\n/**\n * Unbind all event handlers before tearing down a page\n */\nAJAX.registerTeardown('database/operations.js', function () {\n    $(document).off('submit', '#rename_db_form.ajax');\n    $(document).off('submit', '#copy_db_form.ajax');\n    $(document).off('submit', '#change_db_charset_form.ajax');\n    $(document).off('click', '#drop_db_anchor.ajax');\n});\n\nAJAX.registerOnload('database/operations.js', function () {\n    /**\n     * Ajax event handlers for 'Rename Database'\n     */\n    $(document).on('submit', '#rename_db_form.ajax', function (event) {\n        event.preventDefault();\n\n        if (Functions.emptyCheckTheField(this, 'newname')) {\n            Functions.ajaxShowMessage(window.Messages.strFormEmpty, false, 'error');\n            return false;\n        }\n\n        var oldDbName = CommonParams.get('db');\n        var newDbName = $('#new_db_name').val();\n\n        if (newDbName === oldDbName) {\n            Functions.ajaxShowMessage(window.Messages.strDatabaseRenameToSameName, false, 'error');\n            return false;\n        }\n\n        var $form = $(this);\n\n        var question = Functions.escapeHtml('CREATE DATABASE ' + newDbName + ' / DROP DATABASE ' + oldDbName);\n\n        Functions.prepareForAjaxRequest($form);\n\n        $form.confirm(question, $form.attr('action'), function (url) {\n            Functions.ajaxShowMessage(window.Messages.strRenamingDatabases, false);\n            $.post(url, $('#rename_db_form').serialize() + CommonParams.get('arg_separator') + 'is_js_confirmed=1', function (data) {\n                if (typeof data !== 'undefined' && data.success === true) {\n                    Functions.ajaxShowMessage(data.message);\n                    CommonParams.set('db', data.newname);\n\n                    Navigation.reload(function () {\n                        $('#pma_navigation_tree')\n                            .find('a:not(\\'.expander\\')')\n                            .each(function () {\n                                var $thisAnchor = $(this);\n                                if ($thisAnchor.text() === data.newname) {\n                                    // simulate a click on the new db name\n                                    // in navigation\n                                    $thisAnchor.trigger('click');\n                                }\n                            });\n                    });\n                } else {\n                    Functions.ajaxShowMessage(data.error, false);\n                }\n            }); // end $.post()\n        });\n    }); // end Rename Database\n\n    /**\n     * Ajax Event Handler for 'Copy Database'\n     */\n    $(document).on('submit', '#copy_db_form.ajax', function (event) {\n        event.preventDefault();\n\n        if (Functions.emptyCheckTheField(this, 'newname')) {\n            Functions.ajaxShowMessage(window.Messages.strFormEmpty, false, 'error');\n            return false;\n        }\n\n        Functions.ajaxShowMessage(window.Messages.strCopyingDatabase, false);\n        var $form = $(this);\n        Functions.prepareForAjaxRequest($form);\n        $.post($form.attr('action'), $form.serialize(), function (data) {\n            // use messages that stay on screen\n            $('.alert-success, .alert-danger').fadeOut();\n            if (typeof data !== 'undefined' && data.success === true) {\n                if ($('#checkbox_switch').is(':checked')) {\n                    CommonParams.set('db', data.newname);\n                    CommonActions.refreshMain(false, function () {\n                        Functions.ajaxShowMessage(data.message);\n                    });\n                } else {\n                    CommonParams.set('db', data.db);\n                    Functions.ajaxShowMessage(data.message);\n                }\n                Navigation.reload();\n            } else {\n                Functions.ajaxShowMessage(data.error, false);\n            }\n        }); // end $.post()\n    }); // end copy database\n\n    /**\n     * Change tables columns visible only if change tables is checked\n     */\n    $('#span_change_all_tables_columns_collations').hide();\n    $('#checkbox_change_all_tables_collations').on('click', function () {\n        $('#span_change_all_tables_columns_collations').toggle();\n    });\n\n    /**\n     * Ajax Event handler for 'Change Charset' of the database\n     */\n    $(document).on('submit', '#change_db_charset_form.ajax', function (event) {\n        event.preventDefault();\n        var $form = $(this);\n        Functions.prepareForAjaxRequest($form);\n        Functions.ajaxShowMessage(window.Messages.strChangingCharset);\n        $.post($form.attr('action'), $form.serialize(), function (data) {\n            if (typeof data !== 'undefined' && data.success === true) {\n                Functions.ajaxShowMessage(data.message);\n            } else {\n                Functions.ajaxShowMessage(data.error, false);\n            }\n        }); // end $.post()\n    }); // end change charset\n\n    /**\n     * Ajax event handlers for Drop Database\n     */\n    $(document).on('click', '#drop_db_anchor.ajax', function (event) {\n        event.preventDefault();\n        var $link = $(this);\n        /**\n         * @var {String} question String containing the question to be asked for confirmation\n         */\n        var question = window.Messages.strDropDatabaseStrongWarning + ' ';\n        question += window.sprintf(\n            window.Messages.strDoYouReally,\n            'DROP DATABASE `' + Functions.escapeHtml(CommonParams.get('db') + '`')\n        );\n        var params = Functions.getJsConfirmCommonParam(this, $link.getPostData());\n\n        $(this).confirm(question, $(this).attr('href'), function (url) {\n            Functions.ajaxShowMessage(window.Messages.strProcessingRequest);\n            $.post(url, params, function (data) {\n                if (typeof data !== 'undefined' && data.success) {\n                    // Database deleted successfully, refresh both the frames\n                    Navigation.reload();\n                    CommonParams.set('db', '');\n                    CommonActions.refreshMain(\n                        'index.php?route=/server/databases',\n                        function () {\n                            Functions.ajaxShowMessage(data.message);\n                        }\n                    );\n                } else {\n                    Functions.ajaxShowMessage(data.error, false);\n                }\n            });\n        });\n    });\n});\n"],"names":["$","AJAX","Functions","Navigation","CommonActions","CommonParams","registerTeardown","document","off","registerOnload","on","event","preventDefault","emptyCheckTheField","ajaxShowMessage","window","Messages","strFormEmpty","oldDbName","get","newDbName","val","strDatabaseRenameToSameName","$form","question","escapeHtml","prepareForAjaxRequest","confirm","attr","url","strRenamingDatabases","post","serialize","data","success","message","set","newname","reload","find","each","$thisAnchor","text","trigger","error","strCopyingDatabase","fadeOut","is","refreshMain","db","hide","toggle","strChangingCharset","$link","strDropDatabaseStrongWarning","sprintf","strDoYouReally","params","getJsConfirmCommonParam","getPostData","strProcessingRequest"],"sourceRoot":""}