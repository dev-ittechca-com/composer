{"version":3,"file":"database/operations.js","mappings":"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","sources":["webpack://phpmyadmin/external var \"jQuery\"","webpack://phpmyadmin/./js/src/database/operations.js"],"sourcesContent":["module.exports = jQuery;","import $ from 'jquery';\nimport { AJAX } from '../modules/ajax.js';\nimport { Functions } from '../modules/functions.js';\nimport { Navigation } from '../modules/navigation.js';\nimport { CommonParams } from '../modules/common.js';\nimport { ajaxShowMessage } from '../modules/ajax-message.js';\nimport getJsConfirmCommonParam from '../modules/functions/getJsConfirmCommonParam.js';\nimport { escapeHtml } from '../modules/functions/escape.js';\nimport refreshMainContent from '../modules/functions/refreshMainContent.js';\n\n/**\n * @fileoverview    function used in server privilege pages\n * @name            Database Operations\n *\n * @requires    jQueryUI\n */\n\n/**\n * Ajax event handlers here for /database/operations\n *\n * Actions Ajaxified here:\n * Rename Database\n * Copy Database\n * Change Charset\n * Drop Database\n */\n\n/**\n * Unbind all event handlers before tearing down a page\n */\nAJAX.registerTeardown('database/operations.js', function () {\n    $(document).off('submit', '#rename_db_form.ajax');\n    $(document).off('submit', '#copy_db_form.ajax');\n    $(document).off('submit', '#change_db_charset_form.ajax');\n    $(document).off('click', '#drop_db_anchor.ajax');\n});\n\nAJAX.registerOnload('database/operations.js', function () {\n    /**\n     * Ajax event handlers for 'Rename Database'\n     */\n    $(document).on('submit', '#rename_db_form.ajax', function (event) {\n        event.preventDefault();\n\n        if (Functions.emptyCheckTheField(this, 'newname')) {\n            ajaxShowMessage(window.Messages.strFormEmpty, false, 'error');\n            return false;\n        }\n\n        var oldDbName = CommonParams.get('db');\n        var newDbName = $('#new_db_name').val();\n\n        if (newDbName === oldDbName) {\n            ajaxShowMessage(window.Messages.strDatabaseRenameToSameName, false, 'error');\n            return false;\n        }\n\n        var $form = $(this);\n\n        var question = escapeHtml('CREATE DATABASE ' + newDbName + ' / DROP DATABASE ' + oldDbName);\n\n        Functions.prepareForAjaxRequest($form);\n\n        $form.confirm(question, $form.attr('action'), function (url) {\n            ajaxShowMessage(window.Messages.strRenamingDatabases, false);\n            $.post(url, $('#rename_db_form').serialize() + CommonParams.get('arg_separator') + 'is_js_confirmed=1', function (data) {\n                if (typeof data !== 'undefined' && data.success === true) {\n                    ajaxShowMessage(data.message);\n                    Navigation.update(CommonParams.set('db', data.newname));\n                    Navigation.reload(function () {\n                        $('#pma_navigation_tree')\n                            .find('a:not(\\'.expander\\')')\n                            .each(function () {\n                                var $thisAnchor = $(this);\n                                if ($thisAnchor.text() === data.newname) {\n                                    // simulate a click on the new db name\n                                    // in navigation\n                                    $thisAnchor.trigger('click');\n                                }\n                            });\n                    });\n                } else {\n                    ajaxShowMessage(data.error, false);\n                }\n            }); // end $.post()\n        });\n    }); // end Rename Database\n\n    /**\n     * Ajax Event Handler for 'Copy Database'\n     */\n    $(document).on('submit', '#copy_db_form.ajax', function (event) {\n        event.preventDefault();\n\n        if (Functions.emptyCheckTheField(this, 'newname')) {\n            ajaxShowMessage(window.Messages.strFormEmpty, false, 'error');\n            return false;\n        }\n\n        ajaxShowMessage(window.Messages.strCopyingDatabase, false);\n        var $form = $(this);\n        Functions.prepareForAjaxRequest($form);\n        $.post($form.attr('action'), $form.serialize(), function (data) {\n            // use messages that stay on screen\n            $('.alert-success, .alert-danger').fadeOut();\n            if (typeof data !== 'undefined' && data.success === true) {\n                if ($('#checkbox_switch').is(':checked')) {\n                    Navigation.update(CommonParams.set('db', data.newname));\n                    refreshMainContent(false);\n                    AJAX.callback = () => {\n                        ajaxShowMessage(data.message);\n                    };\n                } else {\n                    Navigation.update(CommonParams.set('db', data.db));\n                    ajaxShowMessage(data.message);\n                }\n                Navigation.reload();\n            } else {\n                ajaxShowMessage(data.error, false);\n            }\n        }); // end $.post()\n    }); // end copy database\n\n    /**\n     * Change tables columns visible only if change tables is checked\n     */\n    $('#span_change_all_tables_columns_collations').hide();\n    $('#checkbox_change_all_tables_collations').on('click', function () {\n        $('#span_change_all_tables_columns_collations').toggle();\n    });\n\n    /**\n     * Ajax Event handler for 'Change Charset' of the database\n     */\n    $(document).on('submit', '#change_db_charset_form.ajax', function (event) {\n        event.preventDefault();\n        var $form = $(this);\n        Functions.prepareForAjaxRequest($form);\n        ajaxShowMessage(window.Messages.strChangingCharset);\n        $.post($form.attr('action'), $form.serialize(), function (data) {\n            if (typeof data !== 'undefined' && data.success === true) {\n                ajaxShowMessage(data.message);\n            } else {\n                ajaxShowMessage(data.error, false);\n            }\n        }); // end $.post()\n    }); // end change charset\n\n    /**\n     * Ajax event handlers for Drop Database\n     */\n    $(document).on('click', '#drop_db_anchor.ajax', function (event) {\n        event.preventDefault();\n        var $link = $(this);\n        /**\n         * @var {String} question String containing the question to be asked for confirmation\n         */\n        var question = window.Messages.strDropDatabaseStrongWarning + ' ';\n        question += window.sprintf(\n            window.Messages.strDoYouReally,\n            'DROP DATABASE `' + escapeHtml(CommonParams.get('db') + '`')\n        );\n        var params = getJsConfirmCommonParam(this, $link.getPostData());\n\n        $(this).confirm(question, $(this).attr('href'), function (url) {\n            ajaxShowMessage(window.Messages.strProcessingRequest);\n            $.post(url, params, function (data) {\n                if (typeof data !== 'undefined' && data.success) {\n                    // Database deleted successfully, refresh both the frames\n                    Navigation.reload();\n                    Navigation.update(CommonParams.set('db', ''));\n                    refreshMainContent('index.php?route=/server/databases');\n                    AJAX.callback = () => {\n                        ajaxShowMessage(data.message);\n                    };\n                } else {\n                    ajaxShowMessage(data.error, false);\n                }\n            });\n        });\n    });\n});\n"],"names":["$","AJAX","Functions","Navigation","CommonParams","ajaxShowMessage","getJsConfirmCommonParam","escapeHtml","refreshMainContent","registerTeardown","document","off","registerOnload","on","event","preventDefault","emptyCheckTheField","window","Messages","strFormEmpty","oldDbName","get","newDbName","val","strDatabaseRenameToSameName","$form","question","prepareForAjaxRequest","confirm","attr","url","strRenamingDatabases","post","serialize","data","success","message","update","set","newname","reload","find","each","$thisAnchor","text","trigger","error","strCopyingDatabase","fadeOut","is","callback","db","hide","toggle","strChangingCharset","$link","strDropDatabaseStrongWarning","sprintf","strDoYouReally","params","getPostData","strProcessingRequest"],"sourceRoot":""}