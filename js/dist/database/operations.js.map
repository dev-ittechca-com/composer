{"version":3,"file":"database/operations.js","mappings":"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","sources":["webpack://phpmyadmin/external var \"jQuery\"","webpack://phpmyadmin/./js/src/database/operations.js"],"sourcesContent":["module.exports = jQuery;","import $ from 'jquery';\nimport { AJAX } from '../modules/ajax.js';\nimport { Functions } from '../modules/functions.js';\nimport { Navigation } from '../modules/navigation.js';\nimport { CommonParams } from '../modules/common.js';\nimport { ajaxShowMessage } from '../modules/ajax-message.js';\nimport getJsConfirmCommonParam from '../modules/functions/getJsConfirmCommonParam.js';\nimport { escapeHtml } from '../modules/functions/escape.js';\nimport refreshMainContent from '../modules/functions/refreshMainContent.js';\n\n/**\n * @fileoverview    function used in server privilege pages\n * @name            Database Operations\n *\n * @requires    jQueryUI\n */\n\n/**\n * Ajax event handlers here for /database/operations\n *\n * Actions Ajaxified here:\n * Rename Database\n * Copy Database\n * Change Charset\n * Drop Database\n */\n\n/**\n * Unbind all event handlers before tearing down a page\n */\nAJAX.registerTeardown('database/operations.js', function () {\n    $(document).off('submit', '#rename_db_form.ajax');\n    $(document).off('submit', '#copy_db_form.ajax');\n    $(document).off('submit', '#change_db_charset_form.ajax');\n    $(document).off('click', '#drop_db_anchor.ajax');\n});\n\nAJAX.registerOnload('database/operations.js', function () {\n    /**\n     * Ajax event handlers for 'Rename Database'\n     */\n    $(document).on('submit', '#rename_db_form.ajax', function (event) {\n        event.preventDefault();\n\n        if (Functions.emptyCheckTheField(this, 'newname')) {\n            ajaxShowMessage(window.Messages.strFormEmpty, false, 'error');\n            return false;\n        }\n\n        var oldDbName = CommonParams.get('db');\n        var newDbName = $('#new_db_name').val();\n\n        if (newDbName === oldDbName) {\n            ajaxShowMessage(window.Messages.strDatabaseRenameToSameName, false, 'error');\n            return false;\n        }\n\n        var $form = $(this);\n\n        var question = escapeHtml('CREATE DATABASE ' + newDbName + ' / DROP DATABASE ' + oldDbName);\n\n        Functions.prepareForAjaxRequest($form);\n\n        $form.confirm(question, $form.attr('action'), function (url) {\n            ajaxShowMessage(window.Messages.strRenamingDatabases, false);\n            $.post(url, $('#rename_db_form').serialize() + CommonParams.get('arg_separator') + 'is_js_confirmed=1', function (data) {\n                if (typeof data !== 'undefined' && data.success === true) {\n                    ajaxShowMessage(data.message);\n                    Navigation.update(CommonParams.set('db', data.newname));\n                    Navigation.reload(function () {\n                        $('#pma_navigation_tree')\n                            .find('a:not(\\'.expander\\')')\n                            .each(function () {\n                                var $thisAnchor = $(this);\n                                if ($thisAnchor.text() === data.newname) {\n                                    // simulate a click on the new db name\n                                    // in navigation\n                                    $thisAnchor.trigger('click');\n                                }\n                            });\n                    });\n                } else {\n                    ajaxShowMessage(data.error, false);\n                }\n            }); // end $.post()\n        });\n    }); // end Rename Database\n\n    /**\n     * Ajax Event Handler for 'Copy Database'\n     */\n    $(document).on('submit', '#copy_db_form.ajax', function (event) {\n        event.preventDefault();\n\n        if (Functions.emptyCheckTheField(this, 'newname')) {\n            ajaxShowMessage(window.Messages.strFormEmpty, false, 'error');\n            return false;\n        }\n\n        ajaxShowMessage(window.Messages.strCopyingDatabase, false);\n        var $form = $(this);\n        Functions.prepareForAjaxRequest($form);\n        $.post($form.attr('action'), $form.serialize(), function (data) {\n            // use messages that stay on screen\n            $('.alert-success, .alert-danger').fadeOut();\n            if (typeof data !== 'undefined' && data.success === true) {\n                if ($('#checkbox_switch').is(':checked')) {\n                    Navigation.update(CommonParams.set('db', data.newname));\n                    refreshMainContent(false);\n                    AJAX.callback = () => {\n                        ajaxShowMessage(data.message);\n                    };\n                } else {\n                    Navigation.update(CommonParams.set('db', data.db));\n                    ajaxShowMessage(data.message);\n                }\n                Navigation.reload();\n            } else {\n                ajaxShowMessage(data.error, false);\n            }\n        }); // end $.post()\n    }); // end copy database\n\n    /**\n     * Change tables columns visible only if change tables is checked\n     */\n    $('#span_change_all_tables_columns_collations').hide();\n    $('#checkbox_change_all_tables_collations').on('click', function () {\n        $('#span_change_all_tables_columns_collations').toggle();\n    });\n\n    /**\n     * Ajax Event handler for 'Change Charset' of the database\n     */\n    $(document).on('submit', '#change_db_charset_form.ajax', function (event) {\n        event.preventDefault();\n        var $form = $(this);\n        Functions.prepareForAjaxRequest($form);\n        ajaxShowMessage(window.Messages.strChangingCharset);\n        $.post($form.attr('action'), $form.serialize(), function (data) {\n            if (typeof data !== 'undefined' && data.success === true) {\n                ajaxShowMessage(data.message);\n            } else {\n                ajaxShowMessage(data.error, false);\n            }\n        }); // end $.post()\n    }); // end change charset\n\n    /**\n     * Ajax event handlers for Drop Database\n     */\n    $(document).on('click', '#drop_db_anchor.ajax', function (event) {\n        event.preventDefault();\n        var $link = $(this);\n        /**\n         * @var {String} question String containing the question to be asked for confirmation\n         */\n        var question = window.Messages.strDropDatabaseStrongWarning + ' ';\n        question += window.sprintf(\n            window.Messages.strDoYouReally,\n            'DROP DATABASE `' + escapeHtml(CommonParams.get('db') + '`')\n        );\n        var params = getJsConfirmCommonParam(this, $link.getPostData());\n\n        $(this).confirm(question, $(this).attr('href'), function (url) {\n            ajaxShowMessage(window.Messages.strProcessingRequest);\n            $.post(url, params, function (data) {\n                if (typeof data !== 'undefined' && data.success) {\n                    // Database deleted successfully, refresh both the frames\n                    Navigation.reload();\n                    Navigation.update(CommonParams.set('db', ''));\n                    refreshMainContent('index.php?route=/server/databases');\n                    AJAX.callback = () => {\n                        ajaxShowMessage(data.message);\n                    };\n                } else {\n                    ajaxShowMessage(data.error, false);\n                }\n            });\n        });\n    });\n});\n"],"names":["$","AJAX","Functions","Navigation","CommonParams","ajaxShowMessage","getJsConfirmCommonParam","escapeHtml","refreshMainContent","registerTeardown","document","off","registerOnload","on","event","preventDefault","emptyCheckTheField","window","Messages","strFormEmpty","oldDbName","get","newDbName","val","strDatabaseRenameToSameName","$form","question","prepareForAjaxRequest","confirm","attr","url","strRenamingDatabases","post","serialize","data","success","message","update","set","newname","reload","find","each","$thisAnchor","text","trigger","error","strCopyingDatabase","fadeOut","is","callback","db","hide","toggle","strChangingCharset","$link","strDropDatabaseStrongWarning","sprintf","strDoYouReally","params","getPostData","strProcessingRequest"],"sourceRoot":""}