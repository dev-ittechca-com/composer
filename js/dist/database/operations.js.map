{"version":3,"file":"database/operations.js","mappings":"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","sources":["webpack://phpmyadmin/./js/src/database/operations.js"],"sourcesContent":["/**\n * @fileoverview    function used in server privilege pages\n * @name            Database Operations\n *\n * @requires    jQuery\n * @requires    jQueryUI\n * @requires    js/functions.js\n *\n */\n\n/**\n * Ajax event handlers here for /database/operations\n *\n * Actions Ajaxified here:\n * Rename Database\n * Copy Database\n * Change Charset\n * Drop Database\n */\n\n/**\n * Unbind all event handlers before tearing down a page\n */\nAJAX.registerTeardown('database/operations.js', function () {\n    $(document).off('submit', '#rename_db_form.ajax');\n    $(document).off('submit', '#copy_db_form.ajax');\n    $(document).off('submit', '#change_db_charset_form.ajax');\n    $(document).off('click', '#drop_db_anchor.ajax');\n});\n\nAJAX.registerOnload('database/operations.js', function () {\n    /**\n     * Ajax event handlers for 'Rename Database'\n     */\n    $(document).on('submit', '#rename_db_form.ajax', function (event) {\n        event.preventDefault();\n\n        if (Functions.emptyCheckTheField(this, 'newname')) {\n            Functions.ajaxShowMessage(Messages.strFormEmpty, false, 'error');\n            return false;\n        }\n\n        var oldDbName = CommonParams.get('db');\n        var newDbName = $('#new_db_name').val();\n\n        if (newDbName === oldDbName) {\n            Functions.ajaxShowMessage(Messages.strDatabaseRenameToSameName, false, 'error');\n            return false;\n        }\n\n        var $form = $(this);\n\n        var question = Functions.escapeHtml('CREATE DATABASE ' + newDbName + ' / DROP DATABASE ' + oldDbName);\n\n        Functions.prepareForAjaxRequest($form);\n\n        $form.confirm(question, $form.attr('action'), function (url) {\n            Functions.ajaxShowMessage(Messages.strRenamingDatabases, false);\n            $.post(url, $('#rename_db_form').serialize() + CommonParams.get('arg_separator') + 'is_js_confirmed=1', function (data) {\n                if (typeof data !== 'undefined' && data.success === true) {\n                    Functions.ajaxShowMessage(data.message);\n                    CommonParams.set('db', data.newname);\n\n                    Navigation.reload(function () {\n                        $('#pma_navigation_tree')\n                            .find('a:not(\\'.expander\\')')\n                            .each(function () {\n                                var $thisAnchor = $(this);\n                                if ($thisAnchor.text() === data.newname) {\n                                    // simulate a click on the new db name\n                                    // in navigation\n                                    $thisAnchor.trigger('click');\n                                }\n                            });\n                    });\n                } else {\n                    Functions.ajaxShowMessage(data.error, false);\n                }\n            }); // end $.post()\n        });\n    }); // end Rename Database\n\n    /**\n     * Ajax Event Handler for 'Copy Database'\n     */\n    $(document).on('submit', '#copy_db_form.ajax', function (event) {\n        event.preventDefault();\n\n        if (Functions.emptyCheckTheField(this, 'newname')) {\n            Functions.ajaxShowMessage(Messages.strFormEmpty, false, 'error');\n            return false;\n        }\n\n        Functions.ajaxShowMessage(Messages.strCopyingDatabase, false);\n        var $form = $(this);\n        Functions.prepareForAjaxRequest($form);\n        $.post($form.attr('action'), $form.serialize(), function (data) {\n            // use messages that stay on screen\n            $('.alert-success, .alert-danger').fadeOut();\n            if (typeof data !== 'undefined' && data.success === true) {\n                if ($('#checkbox_switch').is(':checked')) {\n                    CommonParams.set('db', data.newname);\n                    CommonActions.refreshMain(false, function () {\n                        Functions.ajaxShowMessage(data.message);\n                    });\n                } else {\n                    CommonParams.set('db', data.db);\n                    Functions.ajaxShowMessage(data.message);\n                }\n                Navigation.reload();\n            } else {\n                Functions.ajaxShowMessage(data.error, false);\n            }\n        }); // end $.post()\n    }); // end copy database\n\n    /**\n     * Change tables columns visible only if change tables is checked\n     */\n    $('#span_change_all_tables_columns_collations').hide();\n    $('#checkbox_change_all_tables_collations').on('click', function () {\n        $('#span_change_all_tables_columns_collations').toggle();\n    });\n\n    /**\n     * Ajax Event handler for 'Change Charset' of the database\n     */\n    $(document).on('submit', '#change_db_charset_form.ajax', function (event) {\n        event.preventDefault();\n        var $form = $(this);\n        Functions.prepareForAjaxRequest($form);\n        Functions.ajaxShowMessage(Messages.strChangingCharset);\n        $.post($form.attr('action'), $form.serialize(), function (data) {\n            if (typeof data !== 'undefined' && data.success === true) {\n                Functions.ajaxShowMessage(data.message);\n            } else {\n                Functions.ajaxShowMessage(data.error, false);\n            }\n        }); // end $.post()\n    }); // end change charset\n\n    /**\n     * Ajax event handlers for Drop Database\n     */\n    $(document).on('click', '#drop_db_anchor.ajax', function (event) {\n        event.preventDefault();\n        var $link = $(this);\n        /**\n         * @var {String} question String containing the question to be asked for confirmation\n         */\n        var question = Messages.strDropDatabaseStrongWarning + ' ';\n        question += Functions.sprintf(\n            Messages.strDoYouReally,\n            'DROP DATABASE `' + Functions.escapeHtml(CommonParams.get('db') + '`')\n        );\n        var params = Functions.getJsConfirmCommonParam(this, $link.getPostData());\n\n        $(this).confirm(question, $(this).attr('href'), function (url) {\n            Functions.ajaxShowMessage(Messages.strProcessingRequest);\n            $.post(url, params, function (data) {\n                if (typeof data !== 'undefined' && data.success) {\n                    // Database deleted successfully, refresh both the frames\n                    Navigation.reload();\n                    CommonParams.set('db', '');\n                    CommonActions.refreshMain(\n                        'index.php?route=/server/databases',\n                        function () {\n                            Functions.ajaxShowMessage(data.message);\n                        }\n                    );\n                } else {\n                    Functions.ajaxShowMessage(data.error, false);\n                }\n            });\n        });\n    });\n});\n"],"names":["AJAX","registerTeardown","$","document","off","registerOnload","on","event","preventDefault","Functions","emptyCheckTheField","ajaxShowMessage","Messages","strFormEmpty","oldDbName","CommonParams","get","newDbName","val","strDatabaseRenameToSameName","$form","question","escapeHtml","prepareForAjaxRequest","confirm","attr","url","strRenamingDatabases","post","serialize","data","success","message","set","newname","Navigation","reload","find","each","$thisAnchor","text","trigger","error","strCopyingDatabase","fadeOut","is","CommonActions","refreshMain","db","hide","toggle","strChangingCharset","$link","strDropDatabaseStrongWarning","sprintf","strDoYouReally","params","getJsConfirmCommonParam","getPostData","strProcessingRequest"],"sourceRoot":""}