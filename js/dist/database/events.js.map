{"version":3,"file":"database/events.js","mappings":"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","sources":["webpack://phpmyadmin/external var \"jQuery\"","webpack://phpmyadmin/./js/src/database/events.js"],"sourcesContent":["module.exports = jQuery;","import $ from 'jquery';\nimport { AJAX } from '../modules/ajax.js';\nimport { Functions } from '../modules/functions.js';\nimport { Navigation } from '../modules/navigation.js';\nimport { ajaxRemoveMessage, ajaxShowMessage } from '../modules/ajax-message.js';\nimport getJsConfirmCommonParam from '../modules/functions/getJsConfirmCommonParam.js';\n\nAJAX.registerTeardown('database/events.js', function () {\n    $(document).off('click', 'a.ajax.add_anchor, a.ajax.edit_anchor');\n    $(document).off('click', 'a.ajax.export_anchor');\n    $(document).off('click', '#bulkActionExportButton');\n    $(document).off('click', 'a.ajax.drop_anchor');\n    $(document).off('click', '#bulkActionDropButton');\n    $(document).off('change', 'select[name=item_type]');\n});\n\nconst DatabaseEvents = {\n    /**\n     * @var $ajaxDialog Query object containing the reference to the\n     *                  dialog that contains the editor\n     */\n    $ajaxDialog: null,\n    /**\n     * @var syntaxHiglighter Reference to the codemirror editor\n     */\n    syntaxHiglighter: null,\n    /**\n     * Validate editor form fields.\n     *\n     * @return {bool}\n     */\n    validate: function () {\n        /**\n         * @var $elm a jQuery object containing the reference\n         *           to an element that is being validated\n         */\n        var $elm = null;\n        // Common validation. At the very least the name\n        // and the definition must be provided for an item\n        $elm = $('table.rte_table').last().find('input[name=item_name]');\n        if ($elm.val() === '') {\n            $elm.trigger('focus');\n            alert(window.Messages.strFormEmpty);\n            return false;\n        }\n        $elm = $('table.rte_table').find('textarea[name=item_definition]');\n        if ($elm.val() === '') {\n            if (this.syntaxHiglighter !== null) {\n                this.syntaxHiglighter.focus();\n            } else {\n                $('textarea[name=item_definition]').last().trigger('focus');\n            }\n            alert(window.Messages.strFormEmpty);\n            return false;\n        }\n        // The validation has so far passed, so now\n        // we can validate item-specific fields.\n        return this.validateCustom();\n    },\n\n    exportDialog: function ($this) {\n        var $msg = ajaxShowMessage();\n        if ($this.attr('id') === 'bulkActionExportButton') {\n            var combined = {\n                success: true,\n                title: window.Messages.strExport,\n                message: '',\n                error: ''\n            };\n            // export anchors of all selected rows\n            var exportAnchors = $('input.checkall:checked').parents('tr').find('.export_anchor');\n            var count = exportAnchors.length;\n            var returnCount = 0;\n            var p = $.when();\n            exportAnchors.each(function () {\n                var h = $(this).attr('href');\n                p = p.then(function () {\n                    return $.get(h, { 'ajax_request': true }, function (data) {\n                        returnCount++;\n                        if (data.success === true) {\n                            combined.message += '\\n' + data.message + '\\n';\n                            if (returnCount === count) {\n                                showExport(combined);\n                            }\n                        } else {\n                            // complain even if one export is failing\n                            combined.success = false;\n                            combined.error += '\\n' + data.error + '\\n';\n                            if (returnCount === count) {\n                                showExport(combined);\n                            }\n                        }\n                    });\n                });\n            });\n        } else {\n            $.get($this.attr('href'), { 'ajax_request': true }, showExport);\n        }\n        ajaxRemoveMessage($msg);\n\n        function showExport (data) {\n            if (data.success === true) {\n                ajaxRemoveMessage($msg);\n                /**\n                 * @var buttonOptions Object containing options\n                 *                     for jQueryUI dialog buttons\n                 */\n                var buttonOptions = {\n                    [window.Messages.strClose]: {\n                        text: window.Messages.strClose,\n                        class: 'btn btn-primary',\n                        click: function () {\n                            $(this).dialog('close').remove();\n                        },\n                    },\n                };\n                /**\n                 * Display the dialog to the user\n                 */\n                data.message = '<textarea cols=\"40\" rows=\"15\" class=\"w-100\">' + data.message + '</textarea>';\n                var $ajaxDialog = $('<div>' + data.message + '</div>').dialog({\n                    classes: {\n                        'ui-dialog-titlebar-close': 'btn-close'\n                    },\n                    width: 500,\n                    buttons: buttonOptions,\n                    title: data.title\n                });\n                // Attach syntax highlighted editor to export dialog\n                /**\n                 * @var $elm jQuery object containing the reference\n                 *           to the Export textarea.\n                 */\n                var $elm = $ajaxDialog.find('textarea');\n                Functions.getSqlEditor($elm);\n            } else {\n                ajaxShowMessage(data.error, false);\n            }\n        } // end showExport()\n    },  // end exportDialog()\n    editorDialog: function (isNew, $this) {\n        var that = this;\n        /**\n         * @var $edit_row jQuery object containing the reference to\n         *                the row of the the item being edited\n         *                from the list of items\n         */\n        var $editRow = null;\n        if ($this.hasClass('edit_anchor')) {\n            // Remember the row of the item being edited for later,\n            // so that if the edit is successful, we can replace the\n            // row with info about the modified item.\n            $editRow = $this.parents('tr');\n        }\n        /**\n         * @var $msg jQuery object containing the reference to\n         *           the AJAX message shown to the user\n         */\n        var $msg = ajaxShowMessage();\n        $.get($this.attr('href'), { 'ajax_request': true }, function (data) {\n            if (data.success === true) {\n                // We have successfully fetched the editor form\n                ajaxRemoveMessage($msg);\n                /**\n                 * @var buttonOptions Object containing options\n                 *                     for jQueryUI dialog buttons\n                 */\n                var buttonOptions = {\n                    [window.Messages.strGo]: {\n                        text: window.Messages.strGo,\n                        class: 'btn btn-primary',\n                    },\n                    [window.Messages.strClose]: {\n                        text: window.Messages.strClose,\n                        class: 'btn btn-secondary',\n                    },\n                };\n                // Now define the function that is called when\n                // the user presses the \"Go\" button\n                buttonOptions[window.Messages.strGo].click = function () {\n                    // Move the data from the codemirror editor back to the\n                    // textarea, where it can be used in the form submission.\n                    if (typeof window.CodeMirror !== 'undefined') {\n                        that.syntaxHiglighter.save();\n                    }\n                    // Validate editor and submit request, if passed.\n                    if (that.validate()) {\n                        /**\n                         * @var data Form data to be sent in the AJAX request\n                         */\n                        var data = $('form.rte_form').last().serialize();\n                        $msg = ajaxShowMessage(\n                            window.Messages.strProcessingRequest\n                        );\n                        var url = $('form.rte_form').last().attr('action');\n                        $.post(url, data, function (data) {\n                            if (data.success === true) {\n                                // Item created successfully\n                                ajaxRemoveMessage($msg);\n                                Functions.slidingMessage(data.message);\n                                that.$ajaxDialog.dialog('close');\n                                // If we are in 'edit' mode, we must\n                                // remove the reference to the old row.\n                                if (mode === 'edit' && $editRow !== null) {\n                                    $editRow.remove();\n                                }\n                                // Sometimes, like when moving a trigger from\n                                // a table to another one, the new row should\n                                // not be inserted into the list. In this case\n                                // \"data.insert\" will be set to false.\n                                if (data.insert) {\n                                    // Insert the new row at the correct\n                                    // location in the list of items\n                                    /**\n                                     * @var text Contains the name of an item from\n                                     *           the list that is used in comparisons\n                                     *           to find the correct location where\n                                     *           to insert a new row.\n                                     */\n                                    var text = '';\n                                    /**\n                                     * @var inserted Whether a new item has been\n                                     *               inserted in the list or not\n                                     */\n                                    var inserted = false;\n                                    $('table.data').find('tr').each(function () {\n                                        text = $(this)\n                                            .children('td')\n                                            .eq(0)\n                                            .find('strong')\n                                            .text()\n                                            .toUpperCase()\n                                            .trim();\n                                        if (text !== '' && text > data.name) {\n                                            $(this).before(data.new_row);\n                                            inserted = true;\n                                            return false;\n                                        }\n                                    });\n                                    if (! inserted) {\n                                        // If we didn't manage to insert the row yet,\n                                        // it must belong at the end of the list,\n                                        // so we insert it there.\n                                        $('table.data').append(data.new_row);\n                                    }\n                                    // Fade-in the new row\n                                    $('tr.ajaxInsert')\n                                        .show('slow')\n                                        .removeClass('ajaxInsert');\n                                } else if ($('table.data').find('tr').has('td').length === 0) {\n                                    // If we are not supposed to insert the new row,\n                                    // we will now check if the table is empty and\n                                    // needs to be hidden. This will be the case if\n                                    // we were editing the only item in the list,\n                                    // which we removed and will not be inserting\n                                    // something else in its place.\n                                    $('table.data').hide('slow', function () {\n                                        $('#nothing2display').show('slow');\n                                    });\n                                }\n                                // Now we have inserted the row at the correct\n                                // position, but surely at least some row classes\n                                // are wrong now. So we will iterate through\n                                // all rows and assign correct classes to them\n                                /**\n                                 * @var ct Count of processed rows\n                                 */\n                                var ct = 0;\n                                /**\n                                 * @var rowclass Class to be attached to the row\n                                 *               that is being processed\n                                 */\n                                var rowclass = '';\n                                $('table.data').find('tr').has('td').each(function () {\n                                    rowclass = (ct % 2 === 0) ? 'odd' : 'even';\n                                    $(this).removeClass().addClass(rowclass);\n                                    ct++;\n                                });\n                                // If this is the first item being added, remove\n                                // the \"No items\" message and show the list.\n                                if ($('table.data').find('tr').has('td').length > 0 &&\n                                    $('#nothing2display').is(':visible')\n                                ) {\n                                    $('#nothing2display').hide('slow', function () {\n                                        $('table.data').show('slow');\n                                    });\n                                }\n                                Navigation.reload();\n                            } else {\n                                ajaxShowMessage(data.error, false);\n                            }\n                        }); // end $.post()\n                    } // end \"if (that.validate())\"\n                }; // end of function that handles the submission of the Editor\n                buttonOptions[window.Messages.strClose].click = function () {\n                    $(this).dialog('close');\n                };\n                /**\n                 * Display the dialog to the user\n                 */\n                that.$ajaxDialog = $('<div id=\"rteDialog\">' + data.message + '</div>').dialog({\n                    classes: {\n                        'ui-dialog-titlebar-close': 'btn-close'\n                    },\n                    width: 700,\n                    minWidth: 500,\n                    buttons: buttonOptions,\n                    // Issue #15810 - use button titles for modals (eg: new procedure)\n                    // Respect the order: title on href tag, href content, title sent in response\n                    title: $this.attr('title') || $this.text() || $(data.title).text(),\n                    modal: true,\n                    open: function () {\n                        $('#rteDialog').dialog('option', 'max-height', $(window).height());\n                        if ($('#rteDialog').parents('.ui-dialog').height() > $(window).height()) {\n                            $('#rteDialog').dialog('option', 'height', $(window).height());\n                        }\n                        $(this).find('input[name=item_name]').trigger('focus');\n                        $(this).find('input.datefield').each(function () {\n                            Functions.addDatepicker($(this).css('width', '95%'), 'date');\n                        });\n                        $(this).find('input.datetimefield').each(function () {\n                            Functions.addDatepicker($(this).css('width', '95%'), 'datetime');\n                        });\n                        $.datepicker.initialized = false;\n                    },\n                    close: function () {\n                        $(this).remove();\n                    }\n                });\n                /**\n                 * @var mode Used to remember whether the editor is in\n                 *           \"Edit\" or \"Add\" mode\n                 */\n                var mode = 'add';\n                if ($('input[name=editor_process_edit]').length > 0) {\n                    mode = 'edit';\n                }\n                // Attach syntax highlighted editor to the definition\n                /**\n                 * @var elm jQuery object containing the reference to\n                 *                 the Definition textarea.\n                 */\n                var $elm = $('textarea[name=item_definition]').last();\n                var linterOptions = {};\n                linterOptions.eventEditor = true;\n                that.syntaxHiglighter = Functions.getSqlEditor($elm, {}, 'both', linterOptions);\n            } else {\n                ajaxShowMessage(data.error, false);\n            }\n        }); // end $.get()\n    },\n\n    dropDialog: function ($this) {\n        /**\n         * @var $curr_row Object containing reference to the current row\n         */\n        var $currRow = $this.parents('tr');\n        /**\n         * @var question String containing the question to be asked for confirmation\n         */\n        var question = $('<div></div>').text(\n            $currRow.children('td').children('.drop_sql').html()\n        );\n        // We ask for confirmation first here, before submitting the ajax request\n        $this.confirm(question, $this.attr('href'), function (url) {\n            /**\n             * @var msg jQuery object containing the reference to\n             *          the AJAX message shown to the user\n             */\n            var $msg = ajaxShowMessage(window.Messages.strProcessingRequest);\n            var params = getJsConfirmCommonParam(this, $this.getPostData());\n            $.post(url, params, function (data) {\n                if (data.success === true) {\n                    /**\n                     * @var $table Object containing reference\n                     *             to the main list of elements\n                     */\n                    var $table = $currRow.parent();\n                    // Check how many rows will be left after we remove\n                    // the one that the user has requested us to remove\n                    if ($table.find('tr').length === 3) {\n                        // If there are two rows left, it means that they are\n                        // the header of the table and the rows that we are\n                        // about to remove, so after the removal there will be\n                        // nothing to show in the table, so we hide it.\n                        $table.hide('slow', function () {\n                            $(this).find('tr.even, tr.odd').remove();\n                            $('.withSelected').remove();\n                            $('#nothing2display').show('slow');\n                        });\n                    } else {\n                        $currRow.hide('slow', function () {\n                            $(this).remove();\n                            // Now we have removed the row from the list, but maybe\n                            // some row classes are wrong now. So we will iterate\n                            // through all rows and assign correct classes to them.\n                            /**\n                             * @var ct Count of processed rows\n                             */\n                            var ct = 0;\n                            /**\n                             * @var rowclass Class to be attached to the row\n                             *               that is being processed\n                             */\n                            var rowclass = '';\n                            $table.find('tr').has('td').each(function () {\n                                rowclass = (ct % 2 === 1) ? 'odd' : 'even';\n                                $(this).removeClass().addClass(rowclass);\n                                ct++;\n                            });\n                        });\n                    }\n                    // Get rid of the \"Loading\" message\n                    ajaxRemoveMessage($msg);\n                    // Show the query that we just executed\n                    Functions.slidingMessage(data.sql_query);\n                    Navigation.reload();\n                } else {\n                    ajaxShowMessage(data.error, false);\n                }\n            }); // end $.post()\n        });\n    },\n\n    dropMultipleDialog: function ($this) {\n        // We ask for confirmation here\n        $this.confirm(window.Messages.strDropRTEitems, '', function () {\n            /**\n             * @var msg jQuery object containing the reference to\n             *          the AJAX message shown to the user\n             */\n            var $msg = ajaxShowMessage(window.Messages.strProcessingRequest);\n\n            // drop anchors of all selected rows\n            var dropAnchors = $('input.checkall:checked').parents('tr').find('.drop_anchor');\n            var success = true;\n            var count = dropAnchors.length;\n            var returnCount = 0;\n\n            dropAnchors.each(function () {\n                var $anchor = $(this);\n                /**\n                 * @var $curr_row Object containing reference to the current row\n                 */\n                var $currRow = $anchor.parents('tr');\n                var params = getJsConfirmCommonParam(this, $anchor.getPostData());\n                $.post($anchor.attr('href'), params, function (data) {\n                    returnCount++;\n                    if (data.success === true) {\n                        /**\n                         * @var $table Object containing reference\n                         *             to the main list of elements\n                         */\n                        var $table = $currRow.parent();\n                        // Check how many rows will be left after we remove\n                        // the one that the user has requested us to remove\n                        if ($table.find('tr').length === 3) {\n                            // If there are two rows left, it means that they are\n                            // the header of the table and the rows that we are\n                            // about to remove, so after the removal there will be\n                            // nothing to show in the table, so we hide it.\n                            $table.hide('slow', function () {\n                                $(this).find('tr.even, tr.odd').remove();\n                                $('.withSelected').remove();\n                                $('#nothing2display').show('slow');\n                            });\n                        } else {\n                            $currRow.hide('fast', function () {\n                                // we will iterate\n                                // through all rows and assign correct classes to them.\n                                /**\n                                 * @var ct Count of processed rows\n                                 */\n                                var ct = 0;\n                                /**\n                                 * @var rowclass Class to be attached to the row\n                                 *               that is being processed\n                                 */\n                                var rowclass = '';\n                                $table.find('tr').has('td').each(function () {\n                                    rowclass = (ct % 2 === 1) ? 'odd' : 'even';\n                                    $(this).removeClass().addClass(rowclass);\n                                    ct++;\n                                });\n                            });\n                            $currRow.remove();\n                        }\n                        if (returnCount === count) {\n                            if (success) {\n                                // Get rid of the \"Loading\" message\n                                ajaxRemoveMessage($msg);\n                                $('#rteListForm_checkall').prop({ checked: false, indeterminate: false });\n                            }\n                            Navigation.reload();\n                        }\n                    } else {\n                        ajaxShowMessage(data.error, false);\n                        success = false;\n                        if (returnCount === count) {\n                            Navigation.reload();\n                        }\n                    }\n                }); // end $.post()\n            }); // end drop_anchors.each()\n        });\n    },\n    /**\n     * Validate custom editor form fields.\n     *\n     * @return {bool}\n     */\n    validateCustom: function () {\n        /**\n         * @var elm a jQuery object containing the reference\n         *          to an element that is being validated\n         */\n        var $elm = null;\n        if (this.$ajaxDialog.find('select[name=item_type]').find(':selected').val() === 'RECURRING') {\n            // The interval field must not be empty for recurring events\n            $elm = this.$ajaxDialog.find('input[name=item_interval_value]');\n            if ($elm.val() === '') {\n                $elm.trigger('focus');\n                alert(window.Messages.strFormEmpty);\n                return false;\n            }\n        } else {\n            // The execute_at field must not be empty for \"once off\" events\n            $elm = this.$ajaxDialog.find('input[name=item_execute_at]');\n            if ($elm.val() === '') {\n                $elm.trigger('focus');\n                alert(window.Messages.strFormEmpty);\n                return false;\n            }\n        }\n        return true;\n    }\n};\n\nAJAX.registerOnload('database/events.js', function () {\n    /**\n     * Attach Ajax event handlers for the Add/Edit functionality.\n     */\n    $(document).on('click', 'a.ajax.add_anchor, a.ajax.edit_anchor', function (event) {\n        event.preventDefault();\n\n        if ($(this).hasClass('add_anchor')) {\n            $.datepicker.initialized = false;\n        }\n\n        DatabaseEvents.editorDialog($(this).hasClass('add_anchor'), $(this));\n    });\n\n    /**\n     * Attach Ajax event handlers for Export\n     */\n    $(document).on('click', 'a.ajax.export_anchor', function (event) {\n        event.preventDefault();\n        DatabaseEvents.exportDialog($(this));\n    }); // end $(document).on()\n\n    $(document).on('click', '#bulkActionExportButton', function (event) {\n        event.preventDefault();\n        DatabaseEvents.exportDialog($(this));\n    }); // end $(document).on()\n\n    /**\n     * Attach Ajax event handlers for Drop functionality\n     */\n    $(document).on('click', 'a.ajax.drop_anchor', function (event) {\n        event.preventDefault();\n        DatabaseEvents.dropDialog($(this));\n    }); // end $(document).on()\n\n    $(document).on('click', '#bulkActionDropButton', function (event) {\n        event.preventDefault();\n        DatabaseEvents.dropMultipleDialog($(this));\n    }); // end $(document).on()\n\n    /**\n     * Attach Ajax event handlers for the \"Change event type\" functionality, so that the correct\n     * rows are shown in the editor when changing the event type\n     */\n    $(document).on('change', 'select[name=item_type]', function () {\n        $(this).closest('table').find('tr.recurring_event_row, tr.onetime_event_row').toggle();\n    });\n});\n"],"names":["$","AJAX","Functions","Navigation","ajaxRemoveMessage","ajaxShowMessage","getJsConfirmCommonParam","registerTeardown","document","off","DatabaseEvents","$ajaxDialog","syntaxHiglighter","validate","$elm","last","find","val","trigger","alert","window","Messages","strFormEmpty","focus","validateCustom","exportDialog","$this","$msg","attr","combined","success","title","strExport","message","error","exportAnchors","parents","count","length","returnCount","p","when","each","h","then","get","data","showExport","buttonOptions","strClose","text","class","click","dialog","remove","classes","width","buttons","getSqlEditor","editorDialog","isNew","that","$editRow","hasClass","strGo","CodeMirror","save","serialize","strProcessingRequest","url","post","slidingMessage","mode","insert","inserted","children","eq","toUpperCase","trim","name","before","new_row","append","show","removeClass","has","hide","ct","rowclass","addClass","is","reload","minWidth","modal","open","height","addDatepicker","css","datepicker","initialized","close","linterOptions","eventEditor","dropDialog","$currRow","question","html","confirm","params","getPostData","$table","parent","sql_query","dropMultipleDialog","strDropRTEitems","dropAnchors","$anchor","prop","checked","indeterminate","registerOnload","on","event","preventDefault","closest","toggle"],"sourceRoot":""}