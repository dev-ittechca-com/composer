{"version":3,"file":"designer/page.js","mappings":"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","sources":["webpack://phpmyadmin/external var \"jQuery\"","webpack://phpmyadmin/./js/src/designer/page.js"],"sourcesContent":["module.exports = jQuery;","import $ from 'jquery';\nimport { ajaxShowMessage } from '../modules/ajax-message.js';\nimport { escapeHtml } from '../modules/functions/escape.js';\n\n/* global DesignerOfflineDB */ // js/designer/database.js\n/* global DesignerMove */ // js/designer/move.js\n/* global DesignerObjects */ // js/designer/objects.js\n\nvar DesignerPage = {};\nwindow.DesignerPage = DesignerPage;\n\nDesignerPage.showTablesInLandingPage = function (db) {\n    DesignerPage.loadFirstPage(db, function (page) {\n        if (page) {\n            DesignerPage.loadHtmlForPage(page.pgNr);\n            window.selectedPage = page.pgNr;\n        } else {\n            DesignerPage.showNewPageTables(true);\n        }\n    });\n};\n\nDesignerPage.saveToNewPage = function (db, pageName, tablePositions, callback) {\n    DesignerPage.createNewPage(db, pageName, function (page) {\n        if (page) {\n            var tblCords = [];\n            var saveCallback = function (id) {\n                tblCords.push(id);\n                if (tablePositions.length === tblCords.length) {\n                    page.tblCords = tblCords;\n                    DesignerOfflineDB.addObject('pdf_pages', page);\n                }\n            };\n            for (var pos = 0; pos < tablePositions.length; pos++) {\n                tablePositions[pos].pdfPgNr = page.pgNr;\n                DesignerPage.saveTablePositions(tablePositions[pos], saveCallback);\n            }\n            if (typeof callback !== 'undefined') {\n                callback(page);\n            }\n        }\n    });\n};\n\nDesignerPage.saveToSelectedPage = function (db, pageId, pageName, tablePositions, callback) {\n    DesignerPage.deletePage(pageId);\n    DesignerPage.saveToNewPage(db, pageName, tablePositions, function (page) {\n        if (typeof callback !== 'undefined') {\n            callback(page);\n        }\n        window.selectedPage = page.pgNr;\n    });\n};\n\nDesignerPage.createNewPage = function (db, pageName, callback) {\n    var newPage = new DesignerObjects.PdfPage(db, pageName, []);\n    DesignerOfflineDB.addObject('pdf_pages', newPage, function (pgNr) {\n        newPage.pgNr = pgNr;\n        if (typeof callback !== 'undefined') {\n            callback(newPage);\n        }\n    });\n};\n\nDesignerPage.saveTablePositions = function (positions, callback) {\n    DesignerOfflineDB.addObject('table_coords', positions, callback);\n};\n\nDesignerPage.createPageList = function (db, callback) {\n    DesignerOfflineDB.loadAllObjects('pdf_pages', function (pages) {\n        var html = '';\n        for (var p = 0; p < pages.length; p++) {\n            var page = pages[p];\n            if (page.dbName === db) {\n                html += '<option value=\"' + page.pgNr + '\">';\n                html += escapeHtml(page.pageDescr) + '</option>';\n            }\n        }\n        if (typeof callback !== 'undefined') {\n            callback(html);\n        }\n    });\n};\n\nDesignerPage.deletePage = function (pageId, callback) {\n    DesignerOfflineDB.loadObject('pdf_pages', pageId, function (page) {\n        if (page) {\n            for (var i = 0; i < page.tblCords.length; i++) {\n                DesignerOfflineDB.deleteObject('table_coords', page.tblCords[i]);\n            }\n            DesignerOfflineDB.deleteObject('pdf_pages', pageId, callback);\n        }\n    });\n};\n\nDesignerPage.loadFirstPage = function (db, callback) {\n    DesignerOfflineDB.loadAllObjects('pdf_pages', function (pages) {\n        var firstPage = null;\n        for (var i = 0; i < pages.length; i++) {\n            var page = pages[i];\n            if (page.dbName === db) {\n                // give preference to a page having same name as the db\n                if (page.pageDescr === db) {\n                    callback(page);\n                    return;\n                }\n                if (firstPage === null) {\n                    firstPage = page;\n                }\n            }\n        }\n        callback(firstPage);\n    });\n};\n\nDesignerPage.showNewPageTables = function (check) {\n    var allTables = $('#id_scroll_tab').find('td input:checkbox');\n    allTables.prop('checked', check);\n    for (var tab = 0; tab < allTables.length; tab++) {\n        var input = allTables[tab];\n        if (input.value) {\n            var element = document.getElementById(input.value);\n            element.style.top = DesignerPage.getRandom(550, 20) + 'px';\n            element.style.left = DesignerPage.getRandom(700, 20) + 'px';\n            DesignerMove.visibleTab(input, input.value);\n        }\n    }\n    window.selectedPage = -1;\n    $('#page_name').text(window.Messages.strUntitled);\n    DesignerMove.markUnsaved();\n};\n\nDesignerPage.loadHtmlForPage = function (pageId) {\n    DesignerPage.showNewPageTables(true);\n    DesignerPage.loadPageObjects(pageId, function (page, tblCords) {\n        $('#name-panel').find('#page_name').text(page.pageDescr);\n        var tableMissing = false;\n        for (var t = 0; t < tblCords.length; t++) {\n            var tbId = window.db + '.' + tblCords[t].tableName;\n            var table = document.getElementById(tbId);\n            if (table === null) {\n                tableMissing = true;\n                continue;\n            }\n            table.style.top = tblCords[t].y + 'px';\n            table.style.left = tblCords[t].x + 'px';\n\n            var checkbox = document.getElementById('check_vis_' + tbId);\n            checkbox.checked = true;\n            DesignerMove.visibleTab(checkbox, checkbox.value);\n        }\n        DesignerMove.markSaved();\n        if (tableMissing === true) {\n            DesignerMove.markUnsaved();\n            ajaxShowMessage(window.Messages.strSavedPageTableMissing);\n        }\n        window.selectedPage = page.pgNr;\n    });\n};\n\nDesignerPage.loadPageObjects = function (pageId, callback) {\n    DesignerOfflineDB.loadObject('pdf_pages', pageId, function (page) {\n        var tblCords = [];\n        var count = page.tblCords.length;\n        for (var i = 0; i < count; i++) {\n            DesignerOfflineDB.loadObject('table_coords', page.tblCords[i], function (tblCord) {\n                tblCords.push(tblCord);\n                if (tblCords.length === count) {\n                    if (typeof callback !== 'undefined') {\n                        callback(page, tblCords);\n                    }\n                }\n            });\n        }\n    });\n};\n\nDesignerPage.getRandom = function (max, min) {\n    var val = Math.random() * (max - min) + min;\n    return Math.floor(val);\n};\n"],"names":["$","ajaxShowMessage","escapeHtml","DesignerPage","window","showTablesInLandingPage","db","loadFirstPage","page","loadHtmlForPage","pgNr","selectedPage","showNewPageTables","saveToNewPage","pageName","tablePositions","callback","createNewPage","tblCords","saveCallback","id","push","length","DesignerOfflineDB","addObject","pos","pdfPgNr","saveTablePositions","saveToSelectedPage","pageId","deletePage","newPage","DesignerObjects","PdfPage","positions","createPageList","loadAllObjects","pages","html","p","dbName","pageDescr","loadObject","i","deleteObject","firstPage","check","allTables","find","prop","tab","input","value","element","document","getElementById","style","top","getRandom","left","DesignerMove","visibleTab","text","Messages","strUntitled","markUnsaved","loadPageObjects","tableMissing","t","tbId","tableName","table","y","x","checkbox","checked","markSaved","strSavedPageTableMissing","count","tblCord","max","min","val","Math","random","floor"],"sourceRoot":""}