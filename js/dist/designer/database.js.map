{"version":3,"file":"designer/database.js","mappings":"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","sources":["webpack://phpmyadmin/./js/src/designer/database.js"],"sourcesContent":["var designerTables = [\n    {\n        name: 'pdf_pages',\n        key: 'pgNr',\n        autoIncrement: true\n    },\n    {\n        name: 'table_coords',\n        key: 'id',\n        autoIncrement: true\n    }\n];\n\n// eslint-disable-next-line no-unused-vars\nvar DesignerOfflineDB = (function () {\n    var designerDB = {};\n\n    /**\n     * @type {IDBDatabase|null}\n     */\n    var datastore = null;\n\n    /**\n     * @param {String} table\n     * @return {IDBTransaction}\n     */\n    designerDB.getTransaction = function (table) {\n        return datastore.transaction([table], 'readwrite');\n    };\n\n    /**\n     * @param {String} table\n     * @return {IDBObjectStore}\n     */\n    designerDB.getObjectStore = function (table) {\n        var transaction = designerDB.getTransaction(table);\n        var objStore = transaction.objectStore(table);\n        return objStore;\n    };\n\n    /**\n     * @param {IDBTransaction} transaction\n     * @param {String} table\n     * @return {IDBObjectStore}\n     */\n    designerDB.getCursorRequest = function (transaction, table) {\n        var objStore = transaction.objectStore(table);\n        var keyRange = IDBKeyRange.lowerBound(0);\n        var cursorRequest = objStore.openCursor(keyRange);\n        return cursorRequest;\n    };\n\n    /**\n     * @param {Function} callback\n     * @return {void}\n     */\n    designerDB.open = function (callback) {\n        var version = 1;\n        var request = window.indexedDB.open('pma_designer', version);\n\n        request.onupgradeneeded = function (e) {\n            var db = e.target.result;\n            e.target.transaction.onerror = designerDB.onerror;\n\n            var t;\n            for (t in designerTables) {\n                if (db.objectStoreNames.contains(designerTables[t].name)) {\n                    db.deleteObjectStore(designerTables[t].name);\n                }\n            }\n\n            for (t in designerTables) {\n                db.createObjectStore(designerTables[t].name, {\n                    keyPath: designerTables[t].key,\n                    autoIncrement: designerTables[t].autoIncrement\n                });\n            }\n        };\n\n        request.onsuccess = function (e) {\n            datastore = e.target.result;\n            if (typeof callback === 'function') {\n                callback(true);\n            }\n        };\n\n        request.onerror = function () {\n            Functions.ajaxShowMessage(Messages.strIndexedDBNotWorking, null, 'error');\n        };\n    };\n\n    /**\n     * @param {String} table\n     * @param {String} id\n     * @param {Function} callback\n     * @return {void}\n     */\n    designerDB.loadObject = function (table, id, callback) {\n        if (datastore === null) {\n            Functions.ajaxShowMessage(Messages.strIndexedDBNotWorking, null, 'error');\n            return;\n        }\n\n        var objStore = designerDB.getObjectStore(table);\n        var cursorRequest = objStore.get(parseInt(id));\n\n        cursorRequest.onsuccess = function (e) {\n            callback(e.target.result);\n        };\n\n        cursorRequest.onerror = designerDB.onerror;\n    };\n\n    /**\n     * @param {String} table\n     * @param {Function} callback\n     * @return {void}\n     */\n    designerDB.loadAllObjects = function (table, callback) {\n        if (datastore === null) {\n            Functions.ajaxShowMessage(Messages.strIndexedDBNotWorking, null, 'error');\n            return;\n        }\n\n        var transaction = designerDB.getTransaction(table);\n        var cursorRequest = designerDB.getCursorRequest(transaction, table);\n        var results = [];\n\n        transaction.oncomplete = function () {\n            callback(results);\n        };\n\n        cursorRequest.onsuccess = function (e) {\n            var result = e.target.result;\n            if (Boolean(result) === false) {\n                return;\n            }\n            results.push(result.value);\n            result.continue();\n        };\n\n        cursorRequest.onerror = designerDB.onerror;\n    };\n\n    /**\n     * @param {String} table\n     * @param {Function} callback\n     * @return {void}\n     */\n    designerDB.loadFirstObject = function (table, callback) {\n        if (datastore === null) {\n            Functions.ajaxShowMessage(Messages.strIndexedDBNotWorking, null, 'error');\n            return;\n        }\n\n        var transaction = designerDB.getTransaction(table);\n        var cursorRequest = designerDB.getCursorRequest(transaction, table);\n        var firstResult = null;\n\n        transaction.oncomplete = function () {\n            callback(firstResult);\n        };\n\n        cursorRequest.onsuccess = function (e) {\n            var result = e.target.result;\n            if (Boolean(result) === false) {\n                return;\n            }\n            firstResult = result.value;\n        };\n\n        cursorRequest.onerror = designerDB.onerror;\n    };\n\n    /**\n     * @param {String} table\n     * @param {Object} obj\n     * @param {Function} callback\n     * @return {void}\n     */\n    designerDB.addObject = function (table, obj, callback) {\n        if (datastore === null) {\n            Functions.ajaxShowMessage(Messages.strIndexedDBNotWorking, null, 'error');\n            return;\n        }\n\n        var objStore = designerDB.getObjectStore(table);\n        var request = objStore.put(obj);\n\n        request.onsuccess = function (e) {\n            if (typeof callback === 'function') {\n                callback(e.currentTarget.result);\n            }\n        };\n\n        request.onerror = designerDB.onerror;\n    };\n\n    /**\n     * @param {String} table\n     * @param {String} id\n     * @param {Function} callback\n     * @return {void}\n     */\n    designerDB.deleteObject = function (table, id, callback) {\n        if (datastore === null) {\n            Functions.ajaxShowMessage(Messages.strIndexedDBNotWorking, null, 'error');\n            return;\n        }\n\n        var objStore = designerDB.getObjectStore(table);\n        var request = objStore.delete(parseInt(id));\n\n        request.onsuccess = function () {\n            if (typeof callback === 'function') {\n                callback(true);\n            }\n        };\n\n        request.onerror = designerDB.onerror;\n    };\n\n    /**\n     * @param {Error} e\n     * @return {void}\n     */\n    designerDB.onerror = function (e) {\n        // eslint-disable-next-line no-console\n        console.log(e);\n    };\n\n    // Export the designerDB object.\n    return designerDB;\n}());\n"],"names":["designerTables","name","key","autoIncrement","DesignerOfflineDB","designerDB","datastore","getTransaction","table","transaction","getObjectStore","objStore","objectStore","getCursorRequest","keyRange","IDBKeyRange","lowerBound","cursorRequest","openCursor","open","callback","version","request","window","indexedDB","onupgradeneeded","e","db","target","result","onerror","t","objectStoreNames","contains","deleteObjectStore","createObjectStore","keyPath","onsuccess","Functions","ajaxShowMessage","Messages","strIndexedDBNotWorking","loadObject","id","get","parseInt","loadAllObjects","results","oncomplete","Boolean","push","value","continue","loadFirstObject","firstResult","addObject","obj","put","currentTarget","deleteObject","delete","console","log"],"sourceRoot":""}