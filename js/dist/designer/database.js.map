{"version":3,"file":"designer/database.js","mappings":"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","sources":["webpack://phpmyadmin/./js/src/designer/database.js"],"sourcesContent":["var designerTables = [\n    {\n        name: 'pdf_pages',\n        key: 'pgNr',\n        autoIncrement: true\n    },\n    {\n        name: 'table_coords',\n        key: 'id',\n        autoIncrement: true\n    }\n];\n\n// eslint-disable-next-line no-unused-vars\nvar DesignerOfflineDB = (function () {\n    var designerDB = {};\n\n    /**\n     * @type {IDBDatabase|null}\n     */\n    var datastore = null;\n\n    /**\n     * @param {String} table\n     * @return {IDBTransaction}\n     */\n    designerDB.getTransaction = function (table) {\n        return datastore.transaction([table], 'readwrite');\n    };\n\n    /**\n     * @param {String} table\n     * @return {IDBObjectStore}\n     */\n    designerDB.getObjectStore = function (table) {\n        var transaction = designerDB.getTransaction(table);\n        var objStore = transaction.objectStore(table);\n        return objStore;\n    };\n\n    /**\n     * @param {IDBTransaction} transaction\n     * @param {String} table\n     * @return {IDBObjectStore}\n     */\n    designerDB.getCursorRequest = function (transaction, table) {\n        var objStore = transaction.objectStore(table);\n        var keyRange = IDBKeyRange.lowerBound(0);\n        var cursorRequest = objStore.openCursor(keyRange);\n        return cursorRequest;\n    };\n\n    /**\n     * @param {Function} callback\n     * @return {void}\n     */\n    designerDB.open = function (callback) {\n        var version = 1;\n        var request = window.indexedDB.open('pma_designer', version);\n\n        request.onupgradeneeded = function (e) {\n            var db = e.target.result;\n            e.target.transaction.onerror = designerDB.onerror;\n\n            var t;\n            for (t in designerTables) {\n                if (db.objectStoreNames.contains(designerTables[t].name)) {\n                    db.deleteObjectStore(designerTables[t].name);\n                }\n            }\n\n            for (t in designerTables) {\n                db.createObjectStore(designerTables[t].name, {\n                    keyPath: designerTables[t].key,\n                    autoIncrement: designerTables[t].autoIncrement\n                });\n            }\n        };\n\n        request.onsuccess = function (e) {\n            datastore = e.target.result;\n            if (typeof callback === 'function') {\n                callback(true);\n            }\n        };\n\n        request.onerror = designerDB.onerror;\n    };\n\n    /**\n     * @param {String} table\n     * @param {String} id\n     * @param {Function} callback\n     * @return {void}\n     */\n    designerDB.loadObject = function (table, id, callback) {\n        var objStore = designerDB.getObjectStore(table);\n        var cursorRequest = objStore.get(parseInt(id));\n\n        cursorRequest.onsuccess = function (e) {\n            callback(e.target.result);\n        };\n\n        cursorRequest.onerror = designerDB.onerror;\n    };\n\n    /**\n     * @param {String} table\n     * @param {Function} callback\n     * @return {void}\n     */\n    designerDB.loadAllObjects = function (table, callback) {\n        var transaction = designerDB.getTransaction(table);\n        var cursorRequest = designerDB.getCursorRequest(transaction, table);\n        var results = [];\n\n        transaction.oncomplete = function () {\n            callback(results);\n        };\n\n        cursorRequest.onsuccess = function (e) {\n            var result = e.target.result;\n            if (Boolean(result) === false) {\n                return;\n            }\n            results.push(result.value);\n            result.continue();\n        };\n\n        cursorRequest.onerror = designerDB.onerror;\n    };\n\n    /**\n     * @param {String} table\n     * @param {Function} callback\n     * @return {void}\n     */\n    designerDB.loadFirstObject = function (table, callback) {\n        var transaction = designerDB.getTransaction(table);\n        var cursorRequest = designerDB.getCursorRequest(transaction, table);\n        var firstResult = null;\n\n        transaction.oncomplete = function () {\n            callback(firstResult);\n        };\n\n        cursorRequest.onsuccess = function (e) {\n            var result = e.target.result;\n            if (Boolean(result) === false) {\n                return;\n            }\n            firstResult = result.value;\n        };\n\n        cursorRequest.onerror = designerDB.onerror;\n    };\n\n    /**\n     * @param {String} table\n     * @param {Object} obj\n     * @param {Function} callback\n     * @return {void}\n     */\n    designerDB.addObject = function (table, obj, callback) {\n        var objStore = designerDB.getObjectStore(table);\n        var request = objStore.put(obj);\n\n        request.onsuccess = function (e) {\n            if (typeof callback === 'function') {\n                callback(e.currentTarget.result);\n            }\n        };\n\n        request.onerror = designerDB.onerror;\n    };\n\n    /**\n     * @param {String} table\n     * @param {String} id\n     * @param {Function} callback\n     * @return {void}\n     */\n    designerDB.deleteObject = function (table, id, callback) {\n        var objStore = designerDB.getObjectStore(table);\n        var request = objStore.delete(parseInt(id));\n\n        request.onsuccess = function () {\n            if (typeof callback === 'function') {\n                callback(true);\n            }\n        };\n\n        request.onerror = designerDB.onerror;\n    };\n\n    /**\n     * @param {Error} e\n     * @return {void}\n     */\n    designerDB.onerror = function (e) {\n        // eslint-disable-next-line no-console\n        console.log(e);\n    };\n\n    // Export the designerDB object.\n    return designerDB;\n}());\n"],"names":["designerTables","name","key","autoIncrement","DesignerOfflineDB","designerDB","datastore","getTransaction","table","transaction","getObjectStore","objStore","objectStore","getCursorRequest","keyRange","IDBKeyRange","lowerBound","cursorRequest","openCursor","open","callback","version","request","window","indexedDB","onupgradeneeded","e","db","target","result","onerror","t","objectStoreNames","contains","deleteObjectStore","createObjectStore","keyPath","onsuccess","loadObject","id","get","parseInt","loadAllObjects","results","oncomplete","Boolean","push","value","continue","loadFirstObject","firstResult","addObject","obj","put","currentTarget","deleteObject","delete","console","log"],"sourceRoot":""}