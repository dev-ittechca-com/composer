{"version":3,"file":"server/status/processes.js","mappings":"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","sources":["webpack://phpmyadmin/./js/src/server/status/processes.js"],"sourcesContent":["/**\n * Server Status Processes\n *\n * @package PhpMyAdmin\n */\n\n// object to store process list state information\nvar processList = {\n\n    // denotes whether auto refresh is on or off\n    autoRefresh: false,\n    // stores the GET request which refresh process list\n    refreshRequest: null,\n    // stores the timeout id returned by setTimeout\n    refreshTimeout: null,\n    // the refresh interval in seconds\n    refreshInterval: null,\n    // the refresh URL (required to save last used option)\n    // i.e. full or sorting url\n    refreshUrl: null,\n\n    /**\n     * Handles killing of a process\n     *\n     * @return {void}\n     */\n    init: function () {\n        processList.setRefreshLabel();\n        if (processList.refreshUrl === null) {\n            processList.refreshUrl = 'index.php?route=/server/status/processes/refresh';\n        }\n        if (processList.refreshInterval === null) {\n            processList.refreshInterval = $('#id_refreshRate').val();\n        } else {\n            $('#id_refreshRate').val(processList.refreshInterval);\n        }\n    },\n\n    /**\n     * Handles killing of a process\n     *\n     * @param {object} event the event object\n     *\n     * @return {void}\n     */\n    killProcessHandler: function (event) {\n        event.preventDefault();\n        var argSep = CommonParams.get('arg_separator');\n        var params = $(this).getPostData();\n        params += argSep + 'ajax_request=1' + argSep + 'server=' + CommonParams.get('server');\n        // Get row element of the process to be killed.\n        var $tr = $(this).closest('tr');\n        $.post($(this).attr('href'), params, function (data) {\n            // Check if process was killed or not.\n            if (data.hasOwnProperty('success') && data.success) {\n                // remove the row of killed process.\n                $tr.remove();\n                // As we just removed a row, reapply odd-even classes\n                // to keep table stripes consistent\n                var $tableProcessListTr = $('#tableprocesslist').find('> tbody > tr');\n                $tableProcessListTr.each(function (index) {\n                    if (index >= 0 && index % 2 === 0) {\n                        $(this).removeClass('odd').addClass('even');\n                    } else if (index >= 0 && index % 2 !== 0) {\n                        $(this).removeClass('even').addClass('odd');\n                    }\n                });\n                // Show process killed message\n                Functions.ajaxShowMessage(data.message, false);\n            } else {\n                // Show process error message\n                Functions.ajaxShowMessage(data.error, false);\n            }\n        }, 'json');\n    },\n\n    /**\n     * Handles Auto Refreshing\n     * @return {void}\n     */\n    refresh: function () {\n        // abort any previous pending requests\n        // this is necessary, it may go into\n        // multiple loops causing unnecessary\n        // requests even after leaving the page.\n        processList.abortRefresh();\n        // if auto refresh is enabled\n        if (processList.autoRefresh) {\n            // Only fetch the table contents\n            processList.refreshUrl = 'index.php?route=/server/status/processes/refresh';\n            var interval = parseInt(processList.refreshInterval, 10) * 1000;\n            var urlParams = processList.getUrlParams();\n            processList.refreshRequest = $.post(processList.refreshUrl,\n                urlParams,\n                function (data) {\n                    if (data.hasOwnProperty('success') && data.success) {\n                        var $newTable = $(data.message);\n                        $('#tableprocesslist').html($newTable.html());\n                        Functions.highlightSql($('#tableprocesslist'));\n                    }\n                    processList.refreshTimeout = setTimeout(\n                        processList.refresh,\n                        interval\n                    );\n                });\n        }\n    },\n\n    /**\n     * Stop current request and clears timeout\n     *\n     * @return {void}\n     */\n    abortRefresh: function () {\n        if (processList.refreshRequest !== null) {\n            processList.refreshRequest.abort();\n            processList.refreshRequest = null;\n        }\n        clearTimeout(processList.refreshTimeout);\n    },\n\n    /**\n     * Set label of refresh button\n     * change between play & pause\n     *\n     * @return {void}\n     */\n    setRefreshLabel: function () {\n        var img = 'play';\n        var label = Messages.strStartRefresh;\n        if (processList.autoRefresh) {\n            img = 'pause';\n            label = Messages.strStopRefresh;\n            processList.refresh();\n        }\n        $('a#toggleRefresh').html(Functions.getImage(img) + Functions.escapeHtml(label));\n    },\n\n    /**\n     * Return the Url Parameters\n     * for autorefresh request,\n     * includes showExecuting if the filter is checked\n     *\n     * @return {object} urlParams - url parameters with autoRefresh request\n     */\n    getUrlParams: function () {\n        var urlParams = {\n            'server': CommonParams.get('server'),\n            'ajax_request': true,\n            'refresh': true,\n            'full': $('input[name=\"full\"]').val(),\n            'order_by_field': $('input[name=\"order_by_field\"]').val(),\n            'column_name': $('input[name=\"column_name\"]').val(),\n            'sort_order': $('input[name=\"sort_order\"]').val()\n        };\n        if ($('#showExecuting').is(':checked')) {\n            urlParams.showExecuting = true;\n            return urlParams;\n        }\n        return urlParams;\n    }\n};\n\nAJAX.registerOnload('server/status/processes.js', function () {\n    processList.init();\n    // Bind event handler for kill_process\n    $('#tableprocesslist').on(\n        'click',\n        'a.kill_process',\n        processList.killProcessHandler\n    );\n    // Bind event handler for toggling refresh of process list\n    $('a#toggleRefresh').on('click', function (event) {\n        event.preventDefault();\n        processList.autoRefresh = !processList.autoRefresh;\n        processList.setRefreshLabel();\n    });\n    // Bind event handler for change in refresh rate\n    $('#id_refreshRate').on('change', function () {\n        processList.refreshInterval = $(this).val();\n        processList.refresh();\n    });\n    // Bind event handler for table header links\n    $('#tableprocesslist').on('click', 'thead a', function () {\n        processList.refreshUrl = $(this).attr('href');\n    });\n});\n\n/**\n * Unbind all event handlers before tearing down a page\n */\nAJAX.registerTeardown('server/status/processes.js', function () {\n    $('#tableprocesslist').off('click', 'a.kill_process');\n    $('a#toggleRefresh').off('click');\n    $('#id_refreshRate').off('change');\n    $('#tableprocesslist').off('click', 'thead a');\n    // stop refreshing further\n    processList.abortRefresh();\n});\n"],"names":["processList","autoRefresh","refreshRequest","refreshTimeout","refreshInterval","refreshUrl","init","setRefreshLabel","$","val","killProcessHandler","event","preventDefault","argSep","CommonParams","get","params","getPostData","$tr","closest","post","attr","data","hasOwnProperty","success","remove","$tableProcessListTr","find","each","index","removeClass","addClass","Functions","ajaxShowMessage","message","error","refresh","abortRefresh","interval","parseInt","urlParams","getUrlParams","$newTable","html","highlightSql","setTimeout","abort","clearTimeout","img","label","Messages","strStartRefresh","strStopRefresh","getImage","escapeHtml","is","showExecuting","AJAX","registerOnload","on","registerTeardown","off"],"sourceRoot":""}