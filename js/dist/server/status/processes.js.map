{"version":3,"file":"server/status/processes.js","mappings":"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","sources":["webpack://phpmyadmin/./js/src/server/status/processes.js"],"sourcesContent":["/**\n * Server Status Processes\n *\n * @package PhpMyAdmin\n */\n\n// object to store process list state information\nvar processList = {\n\n    // denotes whether auto refresh is on or off\n    autoRefresh: false,\n    // stores the GET request which refresh process list\n    refreshRequest: null,\n    // stores the timeout id returned by setTimeout\n    refreshTimeout: null,\n    // the refresh interval in seconds\n    refreshInterval: null,\n    // the refresh URL (required to save last used option)\n    // i.e. full or sorting url\n    refreshUrl: null,\n\n    /**\n     * Handles killing of a process\n     *\n     * @return {void}\n     */\n    init: function () {\n        processList.setRefreshLabel();\n        if (processList.refreshUrl === null) {\n            processList.refreshUrl = 'index.php?route=/server/status/processes/refresh';\n        }\n        if (processList.refreshInterval === null) {\n            processList.refreshInterval = $('#id_refreshRate').val();\n        } else {\n            $('#id_refreshRate').val(processList.refreshInterval);\n        }\n    },\n\n    /**\n     * Handles killing of a process\n     *\n     * @param {object} event the event object\n     *\n     * @return {void}\n     */\n    killProcessHandler: function (event) {\n        event.preventDefault();\n        var argSep = CommonParams.get('arg_separator');\n        var params = $(this).getPostData();\n        params += argSep + 'ajax_request=1' + argSep + 'server=' + CommonParams.get('server');\n        // Get row element of the process to be killed.\n        var $tr = $(this).closest('tr');\n        $.post($(this).attr('href'), params, function (data) {\n            // Check if process was killed or not.\n            if (data.hasOwnProperty('success') && data.success) {\n                // remove the row of killed process.\n                $tr.remove();\n                // As we just removed a row, reapply odd-even classes\n                // to keep table stripes consistent\n                var $tableProcessListTr = $('#tableprocesslist').find('> tbody > tr');\n                $tableProcessListTr.each(function (index) {\n                    if (index >= 0 && index % 2 === 0) {\n                        $(this).removeClass('odd').addClass('even');\n                    } else if (index >= 0 && index % 2 !== 0) {\n                        $(this).removeClass('even').addClass('odd');\n                    }\n                });\n                // Show process killed message\n                Functions.ajaxShowMessage(data.message, false);\n            } else {\n                // Show process error message\n                Functions.ajaxShowMessage(data.error, false);\n            }\n        }, 'json');\n    },\n\n    /**\n     * Handles Auto Refreshing\n     * @return {void}\n     */\n    refresh: function () {\n        // abort any previous pending requests\n        // this is necessary, it may go into\n        // multiple loops causing unnecessary\n        // requests even after leaving the page.\n        processList.abortRefresh();\n        // if auto refresh is enabled\n        if (processList.autoRefresh) {\n            // Only fetch the table contents\n            processList.refreshUrl = 'index.php?route=/server/status/processes/refresh';\n            var interval = parseInt(processList.refreshInterval, 10) * 1000;\n            var urlParams = processList.getUrlParams();\n            processList.refreshRequest = $.post(processList.refreshUrl,\n                urlParams,\n                function (data) {\n                    if (data.hasOwnProperty('success') && data.success) {\n                        var $newTable = $(data.message);\n                        $('#tableprocesslist').html($newTable.html());\n                        Functions.highlightSql($('#tableprocesslist'));\n                    }\n                    processList.refreshTimeout = setTimeout(\n                        processList.refresh,\n                        interval\n                    );\n                });\n        }\n    },\n\n    /**\n     * Stop current request and clears timeout\n     *\n     * @return {void}\n     */\n    abortRefresh: function () {\n        if (processList.refreshRequest !== null) {\n            processList.refreshRequest.abort();\n            processList.refreshRequest = null;\n        }\n        clearTimeout(processList.refreshTimeout);\n    },\n\n    /**\n     * Set label of refresh button\n     * change between play & pause\n     *\n     * @return {void}\n     */\n    setRefreshLabel: function () {\n        var img = 'play';\n        var label = Messages.strStartRefresh;\n        if (processList.autoRefresh) {\n            img = 'pause';\n            label = Messages.strStopRefresh;\n            processList.refresh();\n        }\n        $('a#toggleRefresh').html(Functions.getImage(img) + Functions.escapeHtml(label));\n    },\n\n    /**\n     * Return the Url Parameters\n     * for autorefresh request,\n     * includes showExecuting if the filter is checked\n     *\n     * @return {object} urlParams - url parameters with autoRefresh request\n     */\n    getUrlParams: function () {\n        var urlParams = {\n            'server': CommonParams.get('server'),\n            'ajax_request': true,\n            'refresh': true,\n            'full': $('input[name=\"full\"]').val(),\n            'order_by_field': $('input[name=\"order_by_field\"]').val(),\n            'column_name': $('input[name=\"column_name\"]').val(),\n            'sort_order': $('input[name=\"sort_order\"]').val()\n        };\n        if ($('#showExecuting').is(':checked')) {\n            urlParams.showExecuting = true;\n            return urlParams;\n        }\n        return urlParams;\n    }\n};\n\nAJAX.registerOnload('server/status/processes.js', function () {\n    processList.init();\n    // Bind event handler for kill_process\n    $('#tableprocesslist').on(\n        'click',\n        'a.kill_process',\n        processList.killProcessHandler\n    );\n    // Bind event handler for toggling refresh of process list\n    $('a#toggleRefresh').on('click', function (event) {\n        event.preventDefault();\n        processList.autoRefresh = !processList.autoRefresh;\n        processList.setRefreshLabel();\n    });\n    // Bind event handler for change in refresh rate\n    $('#id_refreshRate').on('change', function () {\n        processList.refreshInterval = $(this).val();\n        processList.refresh();\n    });\n    // Bind event handler for table header links\n    $('#tableprocesslist').on('click', 'thead a', function () {\n        processList.refreshUrl = $(this).attr('href');\n    });\n});\n\n/**\n * Unbind all event handlers before tearing down a page\n */\nAJAX.registerTeardown('server/status/processes.js', function () {\n    $('#tableprocesslist').off('click', 'a.kill_process');\n    $('a#toggleRefresh').off('click');\n    $('#id_refreshRate').off('change');\n    $('#tableprocesslist').off('click', 'thead a');\n    // stop refreshing further\n    processList.abortRefresh();\n});\n"],"names":["processList","autoRefresh","refreshRequest","refreshTimeout","refreshInterval","refreshUrl","init","setRefreshLabel","$","val","killProcessHandler","event","preventDefault","argSep","CommonParams","get","params","getPostData","$tr","closest","post","attr","data","hasOwnProperty","success","remove","$tableProcessListTr","find","each","index","removeClass","addClass","Functions","ajaxShowMessage","message","error","refresh","abortRefresh","interval","parseInt","urlParams","getUrlParams","$newTable","html","highlightSql","setTimeout","abort","clearTimeout","img","label","Messages","strStartRefresh","strStopRefresh","getImage","escapeHtml","is","showExecuting","AJAX","registerOnload","on","registerTeardown","off"],"sourceRoot":""}