{"version":3,"file":"menu_resizer.js","mappings":";;;;;;AAAA;;;;;;;;;;ACAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACC,WAAUA,CAAV,EAAa;EACV,SAASE,WAAT,CAAsBC,UAAtB,EAAkCC,eAAlC,EAAmD;IAC/C,IAAIC,IAAI,GAAG,IAAX;IACAA,IAAI,CAACF,UAAL,GAAkBA,UAAlB;IACAE,IAAI,CAACD,eAAL,GAAuBA,eAAvB;IACA,IAAIE,WAAW,GAAGN,CAAC,CAACO,MAAD,CAAD,CAAUC,KAAV,EAAlB;;IAEA,IAAIF,WAAW,GAAG,GAAlB,EAAuB;MACnBN,CAAC,CAAC,yBAAD,CAAD,CAA6BS,GAA7B,CAAiC;QAAE,SAAS;MAAX,CAAjC;IACH,CAR8C,CAU/C;;;IACA,IAAIC,IAAI,GAAGV,CAAC,CAAC,SAAD,EAAY;MACpB,QAAQ,GADY;MAEpB,SAAS,0BAFW;MAGpB,MAAM,gBAHc;MAIpB,QAAQ,QAJY;MAKpB,kBAAkB,UALE;MAMpB,iBAAiB,MANG;MAOpB,iBAAiB;IAPG,CAAZ,CAAD,CAQRW,IARQ,CAQHJ,MAAM,CAACK,QAAP,CAAgBC,OARb,CAAX;IAUA,IAAIC,GAAG,GAAGX,UAAU,CAACY,IAAX,CAAgB,QAAhB,CAAV;;IACA,IAAID,GAAG,CAACE,MAAR,EAAgB;MACZhB,CAAC,CAACC,qEAAA,CAAmB,QAAnB,EAA6BiB,QAA7B,EAAD,CAAD,CAA2CC,SAA3C,CAAqDT,IAArD;IACH;;IACD,IAAIU,QAAQ,GAAGpB,CAAC,CAAC,WAAD,EAAc;MAAE,SAAS;IAAX,CAAd,CAAD,CACVqB,MADU,CACHX,IADG,EAEVW,MAFU,CAEHrB,CAAC,CAAC,WAAD,EAAc;MACnB,SAAS,iCADU;MAEnB,mBAAmB;IAFA,CAAd,CAFE,CAAf;IAMAG,UAAU,CAACkB,MAAX,CAAkBD,QAAlB;IACAE,UAAU,CAAC,YAAY;MACnBjB,IAAI,CAACkB,MAAL;IACH,CAFS,EAEP,CAFO,CAAV;EAGH;;EACDrB,WAAW,CAACsB,SAAZ,CAAsBD,MAAtB,GAA+B,YAAY;IACvC,IAAIE,IAAI,GAAG,KAAKrB,eAAL,CAAqBsB,IAArB,CAA0B,KAAKvB,UAA/B,CAAX;IACA,IAAIG,WAAW,GAAGN,CAAC,CAACO,MAAD,CAAD,CAAUC,KAAV,EAAlB;IACA,IAAIY,QAAQ,GAAG,KAAKjB,UAAL,CAAgBY,IAAhB,CAAqB,oBAArB,EAA2CY,IAA3C,EAAf;IACA,IAAIC,QAAQ,GAAGR,QAAQ,CAACS,UAAT,CAAoB,IAApB,CAAf;IACA,IAAIC,UAAU,GAAGV,QAAQ,CAACL,IAAT,CAAc,gBAAd,CAAjB;IACA,IAAIgB,GAAG,GAAG,KAAK5B,UAAL,CAAgBY,IAAhB,CAAqB,MAArB,CAAV;IACA,IAAIiB,IAAI,GAAGF,UAAU,CAACf,IAAX,CAAgB,gBAAhB,CAAX;IACA,IAAIkB,SAAS,GAAGD,IAAI,CAAChB,MAAL,GAAc,CAA9B,CARuC,CASvC;;IACA,IAAIkB,QAAQ,GAAGD,SAAS,GAAGL,QAAH,GAAc,CAAtC;IACA,IAAIO,CAAC,GAAGJ,GAAG,CAACf,MAAJ,GAAa,CAArB;IACA,IAAIoB,CAAJ;;IACA,KAAKA,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGD,CAAhB,EAAmBC,CAAC,EAApB,EAAwB;MACpBF,QAAQ,IAAIlC,CAAC,CAAC+B,GAAG,CAACK,CAAD,CAAJ,CAAD,CAAUP,UAAV,CAAqB,IAArB,CAAZ;IACH,CAfsC,CAiBvC;;;IACA,IAAIQ,UAAU,GAAGC,QAAQ,CAACC,IAAT,CAAcC,YAAd,GAA6BF,QAAQ,CAACC,IAAT,CAAcE,YAA5D;;IACA,IAAIJ,UAAJ,EAAgB;MACZ/B,WAAW,IAAI,EAAf;IACH;;IACD,IAAIA,WAAW,GAAG,GAAlB,EAAuB;MACnBmB,IAAI,GAAG,IAAP;IACH,CAxBsC,CA0BvC;;;IACA,IAAIiB,MAAM,GAAG,KAAb,CA3BuC,CA2BnB;;IACpB,OAAOR,QAAQ,IAAIT,IAAZ,IAAoB,EAAEU,CAAF,IAAO,CAAlC,EAAqC;MAAE;MACnCO,MAAM,GAAG,IAAT;MACA,IAAIC,EAAE,GAAG3C,CAAC,CAAC+B,GAAG,CAACI,CAAD,CAAJ,CAAV;MACAQ,EAAE,CAACC,WAAH,CAAe,UAAf,EAA2BC,QAA3B,CAAoC,eAApC;MACA,IAAIC,OAAO,GAAGH,EAAE,CAACd,UAAH,CAAc,IAAd,CAAd;MACAc,EAAE,CAACI,IAAH,CAAQ,OAAR,EAAiBD,OAAjB;;MACA,IAAI,CAAEb,SAAN,EAAiB;QACbC,QAAQ,IAAIY,OAAZ;QACAH,EAAE,CAACxB,SAAH,CAAaW,UAAb;QACAI,QAAQ,IAAIN,QAAZ;QACAK,SAAS,GAAG,IAAZ;MACH,CALD,MAKO;QACHC,QAAQ,IAAIY,OAAZ;QACAH,EAAE,CAACxB,SAAH,CAAaW,UAAb;MACH;IACJ,CA3CsC,CA4CvC;;;IACA,IAAI,CAAEY,MAAN,EAAc;MACV;MACA,KAAKN,CAAC,GAAG,CAAJ,EAAOD,CAAC,GAAGH,IAAI,CAAChB,MAArB,EAA6BoB,CAAC,GAAGD,CAAjC,EAAoCC,CAAC,EAArC,EAAyC;QACrCF,QAAQ,IAAIlC,CAAC,CAACgC,IAAI,CAACI,CAAD,CAAL,CAAD,CAAWW,IAAX,CAAgB,OAAhB,CAAZ,CADqC,CAErC;QACA;;QACA,IAAIb,QAAQ,GAAGT,IAAX,IACCW,CAAC,KAAKJ,IAAI,CAAChB,MAAL,GAAc,CAApB,IAAyBkB,QAAQ,GAAGN,QAAX,GAAsBH,IADpD,EAEE;UACEzB,CAAC,CAACgC,IAAI,CAACI,CAAD,CAAL,CAAD,CAAWQ,WAAX,CAAuB,eAAvB,EAAwCC,QAAxC,CAAiD,UAAjD;UACA7C,CAAC,CAACgC,IAAI,CAACI,CAAD,CAAL,CAAD,CAAWY,YAAX,CAAwB5B,QAAxB;QACH,CALD,MAKO;UACH;QACH;MACJ;IACJ,CA5DsC,CA6DvC;;;IACA,IAAId,WAAW,GAAG,GAAlB,EAAuB;MACnBN,CAAC,CAAC,kBAAD,CAAD,CAAsBS,GAAtB,CAA0B;QAAE,SAASH,WAAW,GAAG,EAAd,GAAmBN,CAAC,CAAC,iBAAD,CAAD,CAAqBQ,KAArB;MAA9B,CAA1B;MACAY,QAAQ,CAACyB,QAAT,CAAkB,QAAlB;MACA7C,CAAC,CAAC,kBAAD,CAAD,CAAsBS,GAAtB,CAA0B;QAAE,YAAY;MAAd,CAA1B;IACH,CAJD,MAIO;MACHT,CAAC,CAAC,kBAAD,CAAD,CAAsBS,GAAtB,CAA0B;QAAE,SAAS;MAAX,CAA1B;MACAT,CAAC,CAAC,kBAAD,CAAD,CAAsBS,GAAtB,CAA0B;QAAE,YAAY;MAAd,CAA1B;;MACA,IAAIqB,UAAU,CAACf,IAAX,CAAgB,IAAhB,EAAsBC,MAAtB,GAA+B,CAAnC,EAAsC;QAClCI,QAAQ,CAACwB,WAAT,CAAqB,QAArB;MACH,CAFD,MAEO;QACHxB,QAAQ,CAACyB,QAAT,CAAkB,QAAlB;MACH;IACJ;EACJ,CA3ED;;EA4EA3C,WAAW,CAACsB,SAAZ,CAAsByB,OAAtB,GAAgC,YAAY;IACxC,IAAI7B,QAAQ,GAAG,KAAKjB,UAAL,CAAgBY,IAAhB,CAAqB,oBAArB,EAA2CmC,UAA3C,EAAf;IACA9B,QAAQ,CAACL,IAAT,CAAc,IAAd,EAAoBoC,QAApB,CAA6B,KAAKhD,UAAlC;IACAiB,QAAQ,CAACgC,MAAT;EACH,CAJD;EAMA;;;EACA,IAAIC,OAAO,GAAG;IACVC,IAAI,EAAE,UAAUlD,eAAV,EAA2B;MAC7B,OAAO,KAAKmD,IAAL,CAAU,YAAY;QACzB,IAAIC,KAAK,GAAGxD,CAAC,CAAC,IAAD,CAAb;;QACA,IAAI,CAAEwD,KAAK,CAACT,IAAN,CAAW,aAAX,CAAN,EAAiC;UAC7BS,KAAK,CAACT,IAAN,CACI,aADJ,EAEI,IAAI7C,WAAJ,CAAgBsD,KAAhB,EAAuBpD,eAAvB,CAFJ;QAIH;MACJ,CARM,CAAP;IASH,CAXS;IAYVmB,MAAM,EAAE,YAAY;MAChB,OAAO,KAAKgC,IAAL,CAAU,YAAY;QACzB,IAAIlD,IAAI,GAAGL,CAAC,CAAC,IAAD,CAAD,CAAQ+C,IAAR,CAAa,aAAb,CAAX;;QACA,IAAI1C,IAAJ,EAAU;UACNA,IAAI,CAACkB,MAAL;QACH;MACJ,CALM,CAAP;IAMH,CAnBS;IAoBV0B,OAAO,EAAE,YAAY;MACjB,OAAO,KAAKM,IAAL,CAAU,YAAY;QACzB,IAAIlD,IAAI,GAAGL,CAAC,CAAC,IAAD,CAAD,CAAQ+C,IAAR,CAAa,aAAb,CAAX;;QACA,IAAI1C,IAAJ,EAAU;UACNA,IAAI,CAAC4C,OAAL;QACH;MACJ,CALM,CAAP;IAMH;EA3BS,CAAd;EA8BA;AACJ;AACA;AACA;AACA;AACA;AACA;;EACIjD,CAAC,CAACyD,EAAF,CAAKC,WAAL,GAAmB,UAAUC,MAAV,EAAkB;IACjC,IAAIN,OAAO,CAACM,MAAD,CAAX,EAAqB;MACjB,OAAON,OAAO,CAACM,MAAD,CAAP,CAAgBjC,IAAhB,CAAqB,IAArB,CAAP;IACH,CAFD,MAEO,IAAI,OAAOiC,MAAP,KAAkB,UAAtB,EAAkC;MACrC,OAAON,OAAO,CAACC,IAAR,CAAaM,KAAb,CAAmB,IAAnB,EAAyB,CAACD,MAAD,CAAzB,CAAP;IACH,CAFM,MAEA;MACH3D,CAAC,CAAC6D,KAAF,CAAQ,YAAaF,MAAb,GAAsB,uCAA9B;IACH;EACJ,CARD;AASH,CAtKA,EAsKC3D,mCAtKD,CAAD","sources":["webpack://phpmyadmin/external var \"jQuery\"","webpack://phpmyadmin/./js/src/menu_resizer.js"],"sourcesContent":["module.exports = jQuery;","import $ from 'jquery';\nimport { Functions } from './modules/functions.js';\n\n/**\n * Handles the resizing of a menu according to the available screen width\n *\n * Uses themes/original/css/resizable-menu.css.php\n *\n * To initialize:\n * $('#myMenu').menuResizer(function () {\n *     // This function will be called to find out how much\n *     // available horizontal space there is for the menu\n *     return $('body').width() - 5; // Some extra margin for good measure\n * });\n *\n * To trigger a resize operation:\n * $('#myMenu').menuResizer('resize'); // Bind this to $(window).resize()\n *\n * To restore the menu to a state like before it was initialized:\n * $('#myMenu').menuResizer('destroy');\n *\n * @package PhpMyAdmin\n */\n(function ($) {\n    function MenuResizer ($container, widthCalculator) {\n        var self = this;\n        self.$container = $container;\n        self.widthCalculator = widthCalculator;\n        var windowWidth = $(window).width();\n\n        if (windowWidth < 768) {\n            $('#pma_navigation_resizer').css({ 'width': '0px' });\n        }\n\n        // create submenu container\n        var link = $('<a></a>', {\n            'href': '#',\n            'class': 'nav-link dropdown-toggle',\n            'id': 'navbarDropdown',\n            'role': 'button',\n            'data-bs-toggle': 'dropdown',\n            'aria-haspopup': 'true',\n            'aria-expanded': 'false'\n        }).text(window.Messages.strMore);\n\n        var img = $container.find('li img');\n        if (img.length) {\n            $(Functions.getImage('b_more').toString()).prependTo(link);\n        }\n        var $submenu = $('<li></li>', { 'class': 'nav-item dropdown d-none' })\n            .append(link)\n            .append($('<ul></ul>', {\n                'class': 'dropdown-menu dropdown-menu-end',\n                'aria-labelledby': 'navbarDropdown'\n            }));\n        $container.append($submenu);\n        setTimeout(function () {\n            self.resize();\n        }, 4);\n    }\n    MenuResizer.prototype.resize = function () {\n        var wmax = this.widthCalculator.call(this.$container);\n        var windowWidth = $(window).width();\n        var $submenu = this.$container.find('.nav-item.dropdown').last();\n        var submenuW = $submenu.outerWidth(true);\n        var $submenuUl = $submenu.find('.dropdown-menu');\n        var $li = this.$container.find('> li');\n        var $li2 = $submenuUl.find('.dropdown-item');\n        var moreShown = $li2.length > 0;\n        // Calculate the total width used by all the shown tabs\n        var totalLen = moreShown ? submenuW : 0;\n        var l = $li.length - 1;\n        var i;\n        for (i = 0; i < l; i++) {\n            totalLen += $($li[i]).outerWidth(true);\n        }\n\n        // eslint-disable-next-line compat/compat\n        var hasVScroll = document.body.scrollHeight > document.body.clientHeight;\n        if (hasVScroll) {\n            windowWidth += 15;\n        }\n        if (windowWidth < 768) {\n            wmax = 2000;\n        }\n\n        // Now hide menu elements that don't fit into the menubar\n        var hidden = false; // Whether we have hidden any tabs\n        while (totalLen >= wmax && --l >= 0) { // Process the tabs backwards\n            hidden = true;\n            var el = $($li[l]);\n            el.removeClass('nav-item').addClass('dropdown-item');\n            var elWidth = el.outerWidth(true);\n            el.data('width', elWidth);\n            if (! moreShown) {\n                totalLen -= elWidth;\n                el.prependTo($submenuUl);\n                totalLen += submenuW;\n                moreShown = true;\n            } else {\n                totalLen -= elWidth;\n                el.prependTo($submenuUl);\n            }\n        }\n        // If we didn't hide any tabs, then there might be some space to show some\n        if (! hidden) {\n            // Show menu elements that do fit into the menubar\n            for (i = 0, l = $li2.length; i < l; i++) {\n                totalLen += $($li2[i]).data('width');\n                // item fits or (it is the last item\n                // and it would fit if More got removed)\n                if (totalLen < wmax ||\n                    (i === $li2.length - 1 && totalLen - submenuW < wmax)\n                ) {\n                    $($li2[i]).removeClass('dropdown-item').addClass('nav-item');\n                    $($li2[i]).insertBefore($submenu);\n                } else {\n                    break;\n                }\n            }\n        }\n        // Show/hide the \"More\" tab as needed\n        if (windowWidth < 768) {\n            $('.navbar-collapse').css({ 'width': windowWidth - 80 - $('#pma_navigation').width() });\n            $submenu.addClass('d-none');\n            $('.navbar-collapse').css({ 'overflow': 'hidden' });\n        } else {\n            $('.navbar-collapse').css({ 'width': 'auto' });\n            $('.navbar-collapse').css({ 'overflow': 'visible' });\n            if ($submenuUl.find('li').length > 0) {\n                $submenu.removeClass('d-none');\n            } else {\n                $submenu.addClass('d-none');\n            }\n        }\n    };\n    MenuResizer.prototype.destroy = function () {\n        var $submenu = this.$container.find('.nav-item.dropdown').removeData();\n        $submenu.find('li').appendTo(this.$container);\n        $submenu.remove();\n    };\n\n    /** Public API */\n    var methods = {\n        init: function (widthCalculator) {\n            return this.each(function () {\n                var $this = $(this);\n                if (! $this.data('menuResizer')) {\n                    $this.data(\n                        'menuResizer',\n                        new MenuResizer($this, widthCalculator)\n                    );\n                }\n            });\n        },\n        resize: function () {\n            return this.each(function () {\n                var self = $(this).data('menuResizer');\n                if (self) {\n                    self.resize();\n                }\n            });\n        },\n        destroy: function () {\n            return this.each(function () {\n                var self = $(this).data('menuResizer');\n                if (self) {\n                    self.destroy();\n                }\n            });\n        }\n    };\n\n    /**\n     * Extend jQuery\n     *\n     * @param {string} method\n     *\n     * @return {any}\n     */\n    $.fn.menuResizer = function (method) {\n        if (methods[method]) {\n            return methods[method].call(this);\n        } else if (typeof method === 'function') {\n            return methods.init.apply(this, [method]);\n        } else {\n            $.error('Method ' +  method + ' does not exist on jQuery.menuResizer');\n        }\n    };\n}($));\n"],"names":["$","Functions","MenuResizer","$container","widthCalculator","self","windowWidth","window","width","css","link","text","Messages","strMore","img","find","length","getImage","toString","prependTo","$submenu","append","setTimeout","resize","prototype","wmax","call","last","submenuW","outerWidth","$submenuUl","$li","$li2","moreShown","totalLen","l","i","hasVScroll","document","body","scrollHeight","clientHeight","hidden","el","removeClass","addClass","elWidth","data","insertBefore","destroy","removeData","appendTo","remove","methods","init","each","$this","fn","menuResizer","method","apply","error"],"sourceRoot":""}