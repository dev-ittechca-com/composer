{"version":3,"file":"menu_resizer.js","mappings":"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","sources":["webpack://phpmyadmin/external var \"jQuery\"","webpack://phpmyadmin/./js/src/menu_resizer.js"],"sourcesContent":["module.exports = jQuery;","import $ from 'jquery';\nimport getImageTag from './modules/functions/getImageTag.js';\n\n/**\n * Handles the resizing of a menu according to the available screen width\n *\n * Uses themes/original/css/resizable-menu.css.php\n *\n * To initialize:\n * $('#myMenu').menuResizer(function () {\n *     // This function will be called to find out how much\n *     // available horizontal space there is for the menu\n *     return $('body').width() - 5; // Some extra margin for good measure\n * });\n *\n * To trigger a resize operation:\n * $('#myMenu').menuResizer('resize'); // Bind this to $(window).resize()\n *\n * To restore the menu to a state like before it was initialized:\n * $('#myMenu').menuResizer('destroy');\n *\n * @package PhpMyAdmin\n */\n(function ($) {\n    function MenuResizer ($container, widthCalculator) {\n        var self = this;\n        self.$container = $container;\n        self.widthCalculator = widthCalculator;\n        var windowWidth = $(window).width();\n\n        if (windowWidth < 768) {\n            $('#pma_navigation_resizer').css({ 'width': '0px' });\n        }\n\n        // create submenu container\n        var link = $('<a></a>', {\n            'href': '#',\n            'class': 'nav-link dropdown-toggle',\n            'id': 'navbarDropdown',\n            'role': 'button',\n            'data-bs-toggle': 'dropdown',\n            'aria-haspopup': 'true',\n            'aria-expanded': 'false'\n        }).text(window.Messages.strMore);\n\n        var img = $container.find('li img');\n        if (img.length) {\n            $(getImageTag('b_more').toString()).prependTo(link);\n        }\n        var $submenu = $('<li></li>', { 'class': 'nav-item dropdown d-none' })\n            .append(link)\n            .append($('<ul></ul>', {\n                'class': 'dropdown-menu dropdown-menu-end',\n                'aria-labelledby': 'navbarDropdown'\n            }));\n        $container.append($submenu);\n        setTimeout(function () {\n            self.resize();\n        }, 4);\n    }\n\n    MenuResizer.prototype.resize = function () {\n        var wmax = this.widthCalculator.call(this.$container);\n        var windowWidth = $(window).width();\n        var $submenu = this.$container.find('.nav-item.dropdown').last();\n        var submenuW = $submenu.outerWidth(true);\n        var $submenuUl = $submenu.find('.dropdown-menu');\n        var $li = this.$container.find('> li');\n        var $li2 = $submenuUl.find('.dropdown-item');\n        var moreShown = $li2.length > 0;\n        // Calculate the total width used by all the shown tabs\n        var totalLen = moreShown ? submenuW : 0;\n        var l = $li.length - 1;\n        var i;\n        for (i = 0; i < l; i++) {\n            totalLen += $($li[i]).outerWidth(true);\n        }\n\n        // eslint-disable-next-line compat/compat\n        var hasVScroll = document.body.scrollHeight > document.body.clientHeight;\n        if (hasVScroll) {\n            windowWidth += 15;\n        }\n        if (windowWidth < 768) {\n            wmax = 2000;\n        }\n\n        // Now hide menu elements that don't fit into the menubar\n        var hidden = false; // Whether we have hidden any tabs\n        while (totalLen >= wmax && --l >= 0) { // Process the tabs backwards\n            hidden = true;\n            var el = $($li[l]);\n            el.removeClass('nav-item').addClass('dropdown-item');\n            var elWidth = el.outerWidth(true);\n            el.data('width', elWidth);\n            if (! moreShown) {\n                totalLen -= elWidth;\n                el.prependTo($submenuUl);\n                totalLen += submenuW;\n                moreShown = true;\n            } else {\n                totalLen -= elWidth;\n                el.prependTo($submenuUl);\n            }\n        }\n        // If we didn't hide any tabs, then there might be some space to show some\n        if (! hidden) {\n            // Show menu elements that do fit into the menubar\n            for (i = 0, l = $li2.length; i < l; i++) {\n                totalLen += $($li2[i]).data('width');\n                // item fits or (it is the last item\n                // and it would fit if More got removed)\n                if (totalLen < wmax ||\n                    (i === $li2.length - 1 && totalLen - submenuW < wmax)\n                ) {\n                    $($li2[i]).removeClass('dropdown-item').addClass('nav-item');\n                    $($li2[i]).insertBefore($submenu);\n                } else {\n                    break;\n                }\n            }\n        }\n        // Show/hide the \"More\" tab as needed\n        if (windowWidth < 768) {\n            $('.navbar-collapse').css({ 'width': windowWidth - 80 - $('#pma_navigation').width() });\n            $submenu.addClass('d-none');\n            $('.navbar-collapse').css({ 'overflow': 'hidden' });\n        } else {\n            $('.navbar-collapse').css({ 'width': 'auto' });\n            $('.navbar-collapse').css({ 'overflow': 'visible' });\n            if ($submenuUl.find('li').length > 0) {\n                $submenu.removeClass('d-none');\n            } else {\n                $submenu.addClass('d-none');\n            }\n        }\n    };\n    MenuResizer.prototype.destroy = function () {\n        var $submenu = this.$container.find('.nav-item.dropdown').removeData();\n        $submenu.find('li').appendTo(this.$container);\n        $submenu.remove();\n    };\n\n    /** Public API */\n    var methods = {\n        init: function (widthCalculator) {\n            return this.each(function () {\n                var $this = $(this);\n                if (! $this.data('menuResizer')) {\n                    $this.data(\n                        'menuResizer',\n                        new MenuResizer($this, widthCalculator)\n                    );\n                }\n            });\n        },\n        resize: function () {\n            return this.each(function () {\n                var self = $(this).data('menuResizer');\n                if (self) {\n                    self.resize();\n                }\n            });\n        },\n        destroy: function () {\n            return this.each(function () {\n                var self = $(this).data('menuResizer');\n                if (self) {\n                    self.destroy();\n                }\n            });\n        }\n    };\n\n    /**\n     * Extend jQuery\n     *\n     * @param {string|Function} method\n     *\n     * @return {any}\n     */\n    $.fn.menuResizer = function (method) {\n        if (methods[method]) {\n            return methods[method].call(this);\n        } else if (typeof method === 'function') {\n            return methods.init.apply(this, [method]);\n        } else {\n            $.error('Method ' + method + ' does not exist on jQuery.menuResizer');\n        }\n    };\n}($));\n"],"names":["$","getImageTag","MenuResizer","$container","widthCalculator","self","windowWidth","window","width","css","link","text","Messages","strMore","img","find","length","toString","prependTo","$submenu","append","setTimeout","resize","prototype","wmax","call","last","submenuW","outerWidth","$submenuUl","$li","$li2","moreShown","totalLen","l","i","hasVScroll","document","body","scrollHeight","clientHeight","hidden","el","removeClass","addClass","elWidth","data","insertBefore","destroy","removeData","appendTo","remove","methods","init","each","$this","fn","menuResizer","method","apply","error"],"sourceRoot":""}